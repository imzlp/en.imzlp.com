<!DOCTYPE html>
<html lang="en,default">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon-32x32-tilt-brush.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-tilt-brush.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-tilt-brush.png">
  <link rel="mask-icon" href="/images/favicon-32x32-tilt-brush.png" color="#222">
  <meta name="google-site-verification" content="ttIkhAIFZQM9Huj8roB0l95ePN2Tv2zv2wRFksi09WA">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Noto Serif SC:300,300italic,400,400italic,700,700italic|Pacifico:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Roboto Mono:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="//lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/font-awesome/5.15.2/css/all.min.css">
  <link rel="stylesheet" href="//lf9-cdn-tos.bytecdntp.com/cdn/expire-1-M/fancybox/3.5.7/jquery.fancybox.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"en.imzlp.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false,"width":280},"copycode":{"enable":true,"show_result":true,"style":"flat"},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"manual"},"fancybox":true,"mediumzoom":false,"lazyload":true,"pangu":true,"comments":{"style":"tabs","active":"valine","storage":true,"lazyload":false,"nav":null,"activeClass":"valine"},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"code_unfold":{"enable":true,"CODE_MAX_HEIGHT":600},"path":"search.xml"};
  </script>

  <meta name="description" content="Previously, it has been mentioned several times that C and C++ are not the same language. Even the part inherited from C in C++ has significant differences from ISO C. I will gradually compile some of">
<meta property="og:type" content="article">
<meta property="og:title" content="Incompatibilities between C and C++">
<meta property="og:url" content="https://en.imzlp.com/posts/14446/index.html">
<meta property="og:site_name" content="Z&#39;s Blog">
<meta property="og:description" content="Previously, it has been mentioned several times that C and C++ are not the same language. Even the part inherited from C in C++ has significant differences from ISO C. I will gradually compile some of">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://img.imzlp.com/imgs/zlp/blog/posts/14446/variable-function-arguments-c-and-cpp-defference.webp">
<meta property="article:published_time" content="2017-02-27T15:25:56.000Z">
<meta property="article:modified_time" content="2017-05-23T10:46:52.000Z">
<meta property="article:author" content="LIPENGZHA">
<meta property="article:tag" content="C++">
<meta property="article:tag" content="C语言">
<meta property="article:tag" content="标准解读">
<meta property="article:tag" content="C语言标准">
<meta property="article:tag" content="C++标准">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://img.imzlp.com/imgs/zlp/blog/posts/14446/variable-function-arguments-c-and-cpp-defference.webp">

<link rel="canonical" href="https://en.imzlp.com/posts/14446/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>Incompatibilities between C and C++ | Z's Blog</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-FDCJ41EFP5"></script>
    <script>
      if (CONFIG.hostname === location.hostname) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-FDCJ41EFP5');
      }
    </script>






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.staticfile.org/lxgw-wenkai-screen-webfont/1.7.0/style.min.css" /><!-- hexo injector head_end end --><link rel="alternate" href="/atom.xml" title="Z's Blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Z's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        
            
  <li class="menu-item menu-item-notes">

    <a href="/notes/" rel="section"><i class="fa fa-edit fa-fw"></i>Notes</a>

  </li>


      
        
            
  <li class="menu-item menu-item-essay">

    <a href="/essay/" rel="section"><i class="fas fa-feather-alt fa-fw"></i>Essay</a>

  </li>


      
        
            
  <li class="menu-item menu-item-resources">

    <a href="/resources/" rel="section"><i class="fa fa-inbox fa-fw"></i>Resources</a>

  </li>


      
        <li class="menu-item menu-item-friends">

    <a href="/friends/" rel="section"><i class="fas fa-link fa-fw"></i>Friends</a>

  </li>
        
            
  <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About Me</a>

  </li>


      
        <li class="menu-item menu-item-showcase">

    <a href="/showcase/" rel="section"><i class="fa fa-solid fa-trophy fa-fw"></i>ShowCase</a>

  </li>
        <li class="menu-item menu-item-changelog">

    <a href="/changelog/" rel="section"><i class="fa fa-history fa-fw"></i>Site Log</a>

  </li>
        <li class="menu-item menu-item-opensource">

    <a href="/opensource/" rel="section"><i class="fas fa-code-branch fa-fw"></i>Open Source</a>

  </li>
        <li class="menu-item menu-item-uewiki">

    <a href="https://ue5wiki.com/" rel="noopener" target="_blank"><i class="fab fa-wikipedia-w fa-fw"></i>Unreal Wiki</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>



<script type="text/javascript">
  let domain='en.imzlp.com';
  let domain_str = atob(domain);
  let pathname = location.pathname;
  if (domain_str!= location.host.toLowerCase()){
        console.log(`this host is not safe,jump to https://${domain_str}${pathname}`);
        location.href=`https://${domain_str}${pathname}`;
  }
</script>

</div>
    </header>

    
  <div class="reading-progress-bar"></div>
  <div class="l10n-header-widget">
    <script>
      // 获取当前页面的 URL
      const currentUrl = window.location.href;
      // 替换 URL 中的部分内容
      const jumpToL10nLink = currentUrl.replace('en.imzlp.com', 'imzlp.com');
      // 将 jumpToL10nLink 绑定到一个全局变量
      window.jumpToL10nLink = jumpToL10nLink;
    </script>

    <a href="#" class="post-l10n-link" title="切换至中文版本" style="float: left;border-bottom: none;" rel="noopener" target="_blank" onclick="window.open(window.jumpToL10nLink, '_blank'); return false;">
      <i class="fa fa-solid fa-language"></i>
    </a>
  </div>



    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en"
  >
    <link itemprop="mainEntityOfPage" href="https://en.imzlp.com/posts/14446/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://img.imzlp.com/imgs/zlp/picgo/2023/202304152112902.webp">
      <meta itemprop="name" content="LIPENGZHA">
      <meta itemprop="description" content=""I think, therefore I am"">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Z's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Incompatibilities between C and C++<a href="https://github.com/imzlp/blog-md/blob/en/_posts/2017-02-27-14446.md" class="post-edit-link" title="Edit this post" style="float: right;border-bottom: 0px;" rel="noopener" target="_blank"><i class="fa fa-pen-nib"></i></a><a href="https://imzlp.com/posts/14446/" class="post-l10n-link" title="切换至中文版本" style="float: left;border-bottom: 0px;" rel="noopener" target="_blank"><i class="fa fa-solid fa-language"></i></a>
        </h1>

        
          <div class="post-subtitle" style="text-align: center;line-height: 1;">
            <sub text-align="center" style="font-size: 15px;align-content: center;font-style: italic;bottom: 0em;">C和C++之间的不兼容</sub>
          </div>
        

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-02-27 15:25 15:25:56:25" itemprop="dateCreated datePublished" datetime="2017-02-27T15:25:56+00:00">2017-02-27 15:25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2017-05-23 10:46 10:46:52:46" itemprop="dateModified" datetime="2017-05-23T10:46:52+00:00">2017-05-23 10:46</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%A0%87%E5%87%86%E8%A7%A3%E8%AF%BB/" itemprop="url" rel="index"><span itemprop="name">标准解读</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%A0%87%E5%87%86%E8%A7%A3%E8%AF%BB/C-%E6%A0%87%E5%87%86/" itemprop="url" rel="index"><span itemprop="name">C++标准</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%A0%87%E5%87%86%E8%A7%A3%E8%AF%BB/C-%E6%A0%87%E5%87%86/C%E8%AF%AD%E8%A8%80%E6%A0%87%E5%87%86/" itemprop="url" rel="index"><span itemprop="name">C语言标准</span></a>
                </span>
            </span>

          
            <span id="/posts/14446/" class="post-meta-item leancloud_visitors" data-flag-title="Incompatibilities between C and C++" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <br>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">Symbols count in article: </span>
              <span>8.4k</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">Reading time &asymp;</span>
              <span>21 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>Previously, it has been mentioned several times that C and C++ are not the same language. Even the part inherited from C in C++ has significant differences from ISO C. I will gradually compile some of their incompatible features here.</p>
<span id="more"></span>

<h3 id="Function-Declaration-Definition"><a href="#Function-Declaration-Definition" class="headerlink" title="Function Declaration/Definition"></a>Function Declaration/Definition</h3><p>In C language, if the function declaration (including definition) is:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Represents receiving variable arguments</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">func</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;func()\n&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">  <span class="built_in">func</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>);<span class="comment">// call func();</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>It is equivalent to the following in C++:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">func</span><span class="params">(...)</span></span>&#123;</span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;func&quot;</span>&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line">  <span class="built_in">func</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>);<span class="comment">// call func();</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>In C language, if a specified function does not receive any parameters, the parameter list must be explicitly specified as void:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">func</span><span class="params">(<span class="type">void</span>)</span></span>;</span><br><span class="line"><span class="comment">// Not equivalent</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">func</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>

<p>In C++, an empty parameter list and void both represent not receiving any parameters.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">func</span><span class="params">()</span></span>;</span><br><span class="line"><span class="comment">// Equivalent</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">func</span><span class="params">(<span class="type">void</span>)</span></span>;</span><br></pre></td></tr></table></figure>
<p><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/14446/variable-function-arguments-c-and-cpp-defference.webp"></p>
<h3 id="sizeof-Operation"><a href="#sizeof-Operation" class="headerlink" title="sizeof Operation"></a>sizeof Operation</h3><p>In C language, due to the existence of VLA (variable length array), <code>sizeof</code> is not a completely compile-time behavior:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">func</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> n)</span>&#123;</span><br><span class="line">  <span class="type">int</span> iarr[n];</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%llu\n&quot;</span>,<span class="keyword">sizeof</span>(iarr));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>This feature does not exist in C++, but some compiler extensions support it, such as <a target="_blank" rel="noopener" href="https://gcc.gnu.org/onlinedocs/gcc/Variable-Length.html">Using the GNU Compiler Collection(GCC)</a>.<br>If your C++ compiler compiles it successfully, you are a victim of compiler extensions (escape).</p>
<h3 id="enum"><a href="#enum" class="headerlink" title="enum"></a>enum</h3><p>In C language, enum is equivalent to int type, but in C++, enum is a type different from its base type.</p>
<blockquote>
<p>[ISO/IEC 9899:1999]The identifiers in an enumerator list are declared as constants that have type int and may appear wherever such are permitted.</p>
</blockquote>
<p>In C language, you can use integer constants to initialize enums, but this is an error in C++:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">color</span> &#123;</span> red, blue, green &#125;;</span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">color</span> <span class="title">c</span> =</span> <span class="number">1</span>; <span class="comment">// // valid C, invalid C++</span></span><br><span class="line"><span class="comment">// error: cannot initialize a variable of type &#x27;enum color&#x27; with an rvalue of type &#x27;int&#x27;</span></span><br></pre></td></tr></table></figure>

<p>Additionally, in C++, because enum objects and the base type of the enum are different types, the sizeof results for both may not be equal.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">e</span> &#123; A &#125;;</span><br><span class="line"><span class="built_in">sizeof</span>(A) == <span class="built_in">sizeof</span>(<span class="type">int</span>) <span class="comment">// in C</span></span><br><span class="line"><span class="built_in">sizeof</span>(A) == <span class="built_in">sizeof</span>(e) <span class="comment">// in C ++</span></span><br><span class="line"><span class="comment">/* and sizeof(int) is not necessarily equal to sizeof(e) */</span></span><br></pre></td></tr></table></figure>

<h3 id="void-Cannot-Be-Implicitly-Converted-to-Other-Pointer-Types"><a href="#void-Cannot-Be-Implicitly-Converted-to-Other-Pointer-Types" class="headerlink" title="void* Cannot Be Implicitly Converted to Other Pointer Types"></a>void* Cannot Be Implicitly Converted to Other Pointer Types</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> *x=<span class="built_in">malloc</span>(<span class="number">4</span>); <span class="comment">// valid C, invalid C++</span></span><br><span class="line"><span class="built_in">free</span>(x);</span><br></pre></td></tr></table></figure>

<p>In C++, void* cannot be implicitly converted to other pointer types, while it can be in C.</p>
<blockquote>
<p>ISO C will accept this usage of pointer to void being assigned to a pointer to object type. C ++ will not.</p>
</blockquote>
<h3 id="Type-Definition-in-Parameter-Return-Types"><a href="#Type-Definition-in-Parameter-Return-Types" class="headerlink" title="Type Definition in Parameter/Return Types"></a>Type Definition in Parameter/Return Types</h3><p>In C++, you cannot define a type in the return type or parameter type of a function, but it is allowed in C.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">f</span><span class="params">( <span class="keyword">struct</span> S &#123; <span class="type">int</span> a; &#125; arg )</span> </span>&#123;&#125; <span class="comment">// valid C, invalid C ++</span></span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">E</span> &#123; A, B, C &#125; <span class="built_in">f</span>() &#123;&#125; <span class="comment">// valid C, invalid C ++</span></span><br></pre></td></tr></table></figure>

<h3 id="Character-Array-Initialization"><a href="#Character-Array-Initialization" class="headerlink" title="Character Array Initialization"></a>Character Array Initialization</h3><p>In C++, using an initialization of a char array with a “” must be able to hold all characters of that string literal (including the terminating \0). If a character array cannot accommodate all elements of the initialized string literal, it is an error:</p>
<blockquote>
<p>In C++, when initializing an array of characters with a string, the number of characters in the string (including the terminating ’\0’) must not exceed the number of elements in the array.</p>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> x[<span class="number">4</span>]=<span class="string">&quot;abcd&quot;</span>; <span class="comment">// valid C, invalid C++</span></span><br><span class="line"><span class="comment">// [clang++ 3.9]error: initializer-string for char array is too long</span></span><br></pre></td></tr></table></figure>

<p>But in C, it will only initialize the portion that can fit.</p>
<blockquote>
<p>In C, an array can be initialized with a string even if the array is not large enough to contain the string-terminating ’\0’.</p>
</blockquote>
<h3 id="Character-Literal-Base-Type"><a href="#Character-Literal-Base-Type" class="headerlink" title="Character Literal Base Type"></a>Character Literal Base Type</h3><p>In C language, character literals are of type int, but in C++, they are of type char.</p>
<blockquote>
<p>**[ISO/IEC 14882:2014]**An ordinary character literal that contains a single c-char representable in the execution character set has type char, with value equal to the numerical value of the encoding of the c-char in the execution character set.</p>
</blockquote>
<blockquote>
<p>**[ISO/IEC 9899:1999]**An integer character constant has type int. The value of an integer character constant containing a single character that maps to a single-byte execution character is the numerical value of the representation of the mapped character interpreted as an integer.</p>
</blockquote>
<p>Thus, the following code behaves differently in C and C++ (using a C compiler will yield no, while a C++ compiler will yield yes):</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="built_in">sizeof</span>(<span class="string">&#x27;a&#x27;</span>)==<span class="built_in">sizeof</span>(<span class="type">char</span>))&#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;yes\n&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;no\n&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>That is:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// valid in C, invalid in C++</span></span><br><span class="line"><span class="built_in">sizeof</span>(<span class="string">&#x27;a&#x27;</span>) == <span class="built_in">sizeof</span>(<span class="type">int</span>)</span><br></pre></td></tr></table></figure>
<p>Why?<br>Imagine if in C++ int and char were the same type, what would this print?</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">std::cout&lt;&lt;<span class="string">&#x27;x&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>In function overloading, it would not be possible to distinguish between integer and character types, so this is also the reason C++ treats int and char as two different types.</p>
<h3 id="String-Literal-Type"><a href="#String-Literal-Type" class="headerlink" title="String Literal Type"></a>String Literal Type</h3><p>In C language, string literals are of type char*, that is:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> *p = <span class="string">&quot;abc&quot;</span>;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>**[ISO/IEC 9899:1999]**defines p with type “pointer to char” and initializes it to point to an object with type “array of char” with length 4 whose elements are initialized with a character string literal. If an attempt is made to use p to modify the contents of the array, the behavior is undefined.</p>
</blockquote>
<p>In C++, string literals are of type const char*:</p>
<blockquote>
<p>A narrow string literal has type “array of n const char”, where n is the size of the string as defined below, and has static storage duration.</p>
</blockquote>
<p>The above rules also apply to <code>char16_t string literal</code>/<code>char32_t string literal</code>.</p>
<p>The difference in the type of string literals in C/C++ causes the following code to have two behaviors:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// valid in C, invalid in C++</span></span><br><span class="line"><span class="type">char</span> *str=<span class="string">&quot;hello&quot;</span>;</span><br></pre></td></tr></table></figure>
<p>If your C++ compiler compiles it successfully, it indicates you are a victim of compiler extensions (non-standard) (escape).</p>
<!--

### Result of Conditional Expression
In C language, the result of the `conditional expression` cannot be an lvalue:
>**[ISO/IEC 9899:1999]**The first operand is evaluated; there is a sequence point after its evaluation. The second operand is evaluated only if the first compares unequal to 0; the third operand is evaluated only if the first compares equal to 0; the result is the value of the second or third operand (whichever is evaluated), converted to the type described below (**A conditional expression does not yield an lvalue**). If an attempt is made to modify the result of a conditional operator or to access it after the next sequence point, the behavior is undefined.

However, in C++, it can be an lvalue:
>**[ISO/IEC 14882:2014]**

That is, in the following code, C and C++ exhibit two behaviors:

-->

<h3 id="C-Struct-and-C-Class-Member-Requirements"><a href="#C-Struct-and-C-Class-Member-Requirements" class="headerlink" title="C Struct and C++ Class Member Requirements"></a>C Struct and C++ Class Member Requirements</h3><p>In C language, a <code>struct</code> can contain an <code>incomplete type</code> (but not contain them arbitrarily):</p>
<blockquote>
<p>**[ISO/IEC 9899:1999]**A structure or union shall not contain a member with incomplete or function type (hence, a structure shall not contain an instance of itself, but may contain a pointer to an instance of itself), except that the last member of a structure with more than one named member may have incomplete array type; such a structure (and any union containing, possibly recursively, a member that is such a structure) shall not be a member of a structure or an element of an array.</p>
</blockquote>
<p>This means: The last member of a structure with multiple members can be an incomplete array.</p>
<p>Using this feature, you can use an <code>Array of length zero</code> to dynamically enlarge a <code>struct</code>:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">A</span>&#123;</span><br><span class="line">  <span class="type">char</span> tag;</span><br><span class="line">  <span class="type">char</span> alz[];</span><br><span class="line">&#125;Astruct;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  Astruct *x=(<span class="keyword">struct</span> A*)<span class="built_in">malloc</span>(<span class="built_in">sizeof</span>(Astruct)+<span class="built_in">sizeof</span>(<span class="type">char</span>)*<span class="number">10</span>);</span><br><span class="line">  <span class="built_in">free</span>(x);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Although you can also use a pointer:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">A</span>&#123;</span><br><span class="line">  <span class="type">char</span> tag;</span><br><span class="line">  <span class="type">char</span> *cp;</span><br><span class="line">&#125;Astruct;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  Astruct *x=(Astruct*)<span class="built_in">malloc</span>(<span class="built_in">sizeof</span>(Astruct));</span><br><span class="line">  x-&gt;cp=(<span class="type">char</span>*)<span class="built_in">malloc</span>(<span class="built_in">sizeof</span>(<span class="type">char</span>*)*<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">free</span>(x-&gt;cp);</span><br><span class="line">  <span class="built_in">free</span>(x);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>However, using <code>Array of length zero</code> can save <code>sizeof(char*)</code> overhead, and the first method creates contiguous allocated memory, which can alleviate memory fragmentation issues.</p>
<p>However, note the last sentence of the cited reference, which implies that this feature cannot exist in C++ (because C++ has inheritance), where the derived class contains members of the base class. However, the C++ standard does not specify how the memory layout of a class should be, so there is no guarantee that the last member of the inherited base class is also the last member of the derived class. Similarly, in C++, there is also no guarantee that the last member of a class is located at the end of the instance in memory layout (the location of the virtual function table is not determinable, depending on implementation).</p>
<p>That is, in C++, members (non-static) of a class are complete types:</p>
<blockquote>
<p>**[ISO/IEC 14882:2014]**Non-static (9.4) data members shall not have incomplete types. In particular, a class C shall not contain a non-static member of class C, but it can contain a pointer or reference to an object of class C.</p>
</blockquote>
<p>Thus, you cannot use the trick of <code>Array of length zero</code> as in C (this still depends on implementation), but this is undefined behavior (undefined behavior).</p>
<p>Although C++ can also use <code>&#123;&#125;</code> to initialize an array of unknown size, you cannot use an empty initialization list to initialize an array of unknown size.</p>
<blockquote>
<p>**[ISO/IEC 14882:2014]**An array of unknown size initialized with a brace-enclosed initializer-list containing n initializer-clauses, where n shall be greater than zero, is defined as having n elements (8.3.4).</p>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> x[] = &#123; <span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span> &#125;;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>declares and initializes x as a one-dimensional array that has three elements since no size was specified and there are three initializers. — end example ] An empty initializer list {} shall not be used as the initializer-clause for an array of unknown bound.</p>
</blockquote>
<blockquote>
<p><strong>The syntax provides for empty initializer-lists, but nonetheless C++ does not have zero length arrays.</strong></p>
</blockquote>
<p>Therefore, in C++, such code is UB behavior:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> x[]=&#123;&#125;;</span><br><span class="line">x[<span class="number">0</span>]=<span class="number">123</span>; <span class="comment">// no compile error</span></span><br></pre></td></tr></table></figure>

<p>The above code compiles successfully in <code>MinGW-W64 G++ 6.2.0</code> and <code>Clang++ 3.9 x86_64-w64-windows-gnu</code>, but fails to compile in <code>VS2015</code>:</p>
<blockquote>
<p>error C2466: cannot allocate an array of constant size 0</p>
</blockquote>
<h3 id="Recursive-Main-Function"><a href="#Recursive-Main-Function" class="headerlink" title="Recursive Main Function"></a>Recursive Main Function</h3><p>C language allows recursive main function (it is not prohibited):</p>
<blockquote>
<p>Recursive function calls shall be permitted, both directly and indirectly through any chain of other functions.</p>
</blockquote>
<p>However, C++ clearly states that recursive main functions are not allowed:</p>
<blockquote>
<p>Recursive calls are permitted, except to the function named main (3.6.1).</p>
</blockquote>
<p>If your C++ compiler successfully compiles the following code, then you are also a victim of compiler extensions…</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="type">int</span> index=<span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,index);</span><br><span class="line">  <span class="keyword">if</span>(index==<span class="number">10</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> index;</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    ++index;</span><br><span class="line">    <span class="built_in">main</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="const-Object-File-Scope-Linkage"><a href="#const-Object-File-Scope-Linkage" class="headerlink" title="const Object File Scope Linkage"></a>const Object File Scope Linkage</h3><p>In both C and C++, the linkage of <code>const</code> objects at the <strong>file scope</strong> is different.<br>First, let’s look at the definition of <strong>file scope</strong>:</p>
<blockquote>
<p><strong>[ISO/IEC 9899:1999]**If the declarator or type specifier that declares the identifier appears outside of any block or list of parameters, the identifier has **file scope</strong>, which terminates at the end of the translation unit.</p>
</blockquote>
<p>Well, suppose we have the following object at file scope:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> cival=<span class="number">123</span>;</span><br></pre></td></tr></table></figure>
<p>The above code has different linkage when compiled with C and C++ compilers:</p>
<ul>
<li>In C language, it has external linkage.</li>
<li>In C++, it has internal linkage.</li>
</ul>
<p>To test this (for a manual implementation of linkage through the compiler, see <a target="_blank" rel="noopener" href="https://imzlp.com/posts/27118/">C/C++ Compilation and Linkage Model Analysis</a>):</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// test.c</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> cival=<span class="number">123</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span>&#123;&#125;</span><br></pre></td></tr></table></figure>
<p>When compiled with a C compiler:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ gcc -c test.c -o test.o</span><br><span class="line">$ nm test.o</span><br><span class="line">-------- U __main</span><br><span class="line">00000000 R cival</span><br><span class="line">00000000 T main</span><br></pre></td></tr></table></figure>
<p>Whereas when compiled with a C++ compiler:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ g++ -c test.c -o test.o</span><br><span class="line">$ nm test.o</span><br><span class="line">-------- U __main</span><br><span class="line">00000000 T main</span><br></pre></td></tr></table></figure>
<p>You can see that the <code>cival</code> symbol is absent from the object file.</p>
<p>As for the reason, the C++ standard provides ample description:</p>
<blockquote>
<p><strong>Change:</strong> A name of file scope that is explicitly declared const, and not explicitly declared extern, has internal linkage, while in C it would have external linkage.<br><strong>Rationale:</strong> Because const objects can be used as compile-time values in C ++, this feature urges programmers to provide explicit initializer values for each const. This feature allows the user to put const objects in header files that are included in many compilation units.</p>
</blockquote>
<p>In summary, in C, global consts default to having external linkage; in C++ this is not the case unless explicitly declared <code>extern</code>.</p>
<h3 id="Function-Definition-Parameter-List"><a href="#Function-Definition-Parameter-List" class="headerlink" title="Function Definition Parameter List"></a>Function Definition Parameter List</h3><p>In C language, the following function definition style is allowed:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">f</span><span class="params">(a,b,c)</span><span class="type">int</span> a</span>;<span class="type">char</span> b;<span class="type">double</span> c;&#123;<span class="comment">/*...*/</span>&#125;</span><br></pre></td></tr></table></figure>
<p>In C++, this is not allowed; it must change to:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">f</span><span class="params">(<span class="type">int</span> a,<span class="type">char</span> b,<span class="type">double</span> c;)</span></span>&#123;<span class="comment">/*...*/</span>&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Global-Variable-Definition"><a href="#Global-Variable-Definition" class="headerlink" title="Global Variable Definition"></a>Global Variable Definition</h3><p>In C, a global data object can be declared multiple times in a single translation unit without the <code>extern</code> specifier. As long as there is <strong>at most</strong> one that provides an initializer, this object is considered defined only once.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// This can compile in C</span></span><br><span class="line"><span class="type">int</span> i;</span><br><span class="line"><span class="type">int</span> i=<span class="number">123</span>;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span>&#123;&#125;</span><br></pre></td></tr></table></figure>
<p>In C++, this results in a redefinition error:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> i;</span><br><span class="line"><span class="type">int</span> i=<span class="number">123</span>; <span class="comment">// error: redefinition of &#x27;i&#x27;</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span>&#123;&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Nested-Structure-Scope"><a href="#Nested-Structure-Scope" class="headerlink" title="Nested Structure Scope"></a>Nested Structure Scope</h3><p>In C, the names of nested structures are in the same scope as the outer structure.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">A</span>&#123;</span><br><span class="line">  <span class="type">int</span> a;</span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">B</span>&#123;</span><br><span class="line">    <span class="type">int</span> b;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">A</span> aobj;</span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">B</span> bobj;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>In C++, due to the concept of <strong>class scope</strong>, the outer name must be specified:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">A</span> aobj;</span><br><span class="line">  <span class="keyword">struct</span> <span class="title class_">A</span>::B bobj;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

    </div>

    
    
        
        
          
            <blockquote class="blockquote-center">
              
                The article is finished. If you have any questions, please comment and communicate.
              
            <br/>
            
                <div class="qr-code" onclick="return false">
                    <script src="/js/qrcode.min.js"></script>
                    <div id="qrcode">
                      
                        <img src="https://imzlp.com/images/wechat-qrcode.webp">
                      
                    <p>Scan the QR code on WeChat and follow me.</p>
                    </div>
                </div>
            
            </blockquote>
          
        

        
          <div class="postCopyright" style="clear:both;">
             <span>Title:</span><a href="/posts/14446/" target="_blank">Incompatibilities between C and C++</a><br/>
             <span>Author:</span><a href="/about" target="_blank" title="查看 LIPENGZHA 的资料">LIPENGZHA</a><br/>
             <span>Publish Date:</span>2017/02/27 15:25<br/>
             
              <span>Update Date:</span>2017/05/23 10:46<br/>
             
             <span>Word Count:</span><span class="page-count">8.4k Words</span><br/>
             
             <span>Link:</span><a href="/posts/14446/" target="_blank" title="Incompatibilities between C and C++">https://en.imzlp.com/posts/14446/</a>
             <span class="copy-path" data-clipboard-text="Link: https://en.imzlp.com/posts/14446/ Author: LIPENGZHA" title="点击复制文章链接"><i class="fa fa-clipboard"></i></span>
             <script src="/js/jquery.min.js"></script>
             <script src="/js/clipboard.min.js"></script>
             <script> var clipboard = new Clipboard('.copy-path'); </script>
             <br/>
             
             <span>License:</span><i class="fab fa-creative-commons"></i> <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" title="Attribution-NonCommercial-ShareAlike 4.0 International">CC BY-NC-SA 4.0</a><br/>
             
             <span>Reprinting of the full article is prohibited.</span>
          </div>
        
    

        
  <div class="reward-container">
    <div>Your donation will encourage me to keep creating!</div>
    <button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
      Donate
    </button>
    <div id="qr" style="display: none;">
        
        <div style="display: inline-block;">
          <img src="/images/reward/wechatpay.webp" alt="LIPENGZHA WeChat Pay">
          <p>WeChat Pay</p>
        </div>

    </div>
  </div>



      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/C/" rel="tag"># C++</a>
              <a href="/tags/C%E8%AF%AD%E8%A8%80/" rel="tag"># C语言</a>
              <a href="/tags/%E6%A0%87%E5%87%86%E8%A7%A3%E8%AF%BB/" rel="tag"># 标准解读</a>
              <a href="/tags/C%E8%AF%AD%E8%A8%80%E6%A0%87%E5%87%86/" rel="tag"># C语言标准</a>
              <a href="/tags/C-%E6%A0%87%E5%87%86/" rel="tag"># C++标准</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/posts/15272/" rel="prev" title="Main-function prototype verification and program termination behavior">
      <i class="fa fa-chevron-left"></i> Main-function prototype verification and program termination behavior
    </a></div>
      <div class="post-nav-item">
    <a href="/posts/21831/" rel="next" title="The difference between declaration and define in C++">
      The difference between declaration and define in C++ <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
      <div class="tabs tabs-comment">
        <ul class="nav-tabs">
            <li class="tab"><a href="#comment-utteranc">utteranc</a></li>
            <li class="tab"><a href="#comment-valine">valine</a></li>
        </ul>
        <div class="tab-content">
            <div class="tab-pane utteranc" id="comment-utteranc">
              
  
  <div class="comments">
  <script src="https://utteranc.es/client.js" repo="hxhb/blog-comments" issue-term="pathname" theme="github-light" crossorigin="anonymous" async></script>
  </div>
  
  
            </div>
            <div class="tab-pane valine" id="comment-valine">
              <div class="comments" id="valine-comments"></div>
            </div>
        </div>
      </div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#Function-Declaration-Definition"><span class="nav-number">1.</span> <span class="nav-text">Function Declaration&#x2F;Definition</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#sizeof-Operation"><span class="nav-number">2.</span> <span class="nav-text">sizeof Operation</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#enum"><span class="nav-number">3.</span> <span class="nav-text">enum</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#void-Cannot-Be-Implicitly-Converted-to-Other-Pointer-Types"><span class="nav-number">4.</span> <span class="nav-text">void* Cannot Be Implicitly Converted to Other Pointer Types</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Type-Definition-in-Parameter-Return-Types"><span class="nav-number">5.</span> <span class="nav-text">Type Definition in Parameter&#x2F;Return Types</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Character-Array-Initialization"><span class="nav-number">6.</span> <span class="nav-text">Character Array Initialization</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Character-Literal-Base-Type"><span class="nav-number">7.</span> <span class="nav-text">Character Literal Base Type</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#String-Literal-Type"><span class="nav-number">8.</span> <span class="nav-text">String Literal Type</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#C-Struct-and-C-Class-Member-Requirements"><span class="nav-number">9.</span> <span class="nav-text">C Struct and C++ Class Member Requirements</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Recursive-Main-Function"><span class="nav-number">10.</span> <span class="nav-text">Recursive Main Function</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#const-Object-File-Scope-Linkage"><span class="nav-number">11.</span> <span class="nav-text">const Object File Scope Linkage</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Function-Definition-Parameter-List"><span class="nav-number">12.</span> <span class="nav-text">Function Definition Parameter List</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Global-Variable-Definition"><span class="nav-number">13.</span> <span class="nav-text">Global Variable Definition</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Nested-Structure-Scope"><span class="nav-number">14.</span> <span class="nav-text">Nested Structure Scope</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person" oncontextmenu="return false" οndragstart="return false">
    <img class="site-author-image" itemprop="image" alt="LIPENGZHA"
      src="https://img.imzlp.com/imgs/zlp/picgo/2023/202304152112902.webp">
  <p class="site-author-name" itemprop="name">LIPENGZHA</p>
  <div class="site-description" itemprop="description">"I think, therefore I am"</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
             
          <span class="site-state-item-count">190</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">95</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">190</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/hxhb" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;hxhb" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://linkedin.com/in/lipengzha" title="Linkedin → https:&#x2F;&#x2F;linkedin.com&#x2F;in&#x2F;lipengzha" rel="noopener" target="_blank"><i class="fab fa-linkedin fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.zhihu.com/people/imzlp" title="知乎 → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;imzlp" rel="noopener" target="_blank"><i class="fa fa-custom zhihu fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="/images/wechat-qrcode-offical.webp" title="微信公众号 → &#x2F;images&#x2F;wechat-qrcode-offical.webp"><i class="fab fa-weixin fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:imzlp@foxmail.com" title="E-Mail → mailto:imzlp@foxmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="/atom.xml" title="RSS → &#x2F;atom.xml"><i class="fa fa-rss fa-fw"></i></a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://consolehelp.imzlp.com/" title="https:&#x2F;&#x2F;consolehelp.imzlp.com&#x2F;" rel="noopener" target="_blank">UE Console Help</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://imzlp.com/opensource/" title="https:&#x2F;&#x2F;imzlp.com&#x2F;opensource&#x2F;" rel="noopener" target="_blank">Open Source Projects</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://imzlp.com/posts/11515/" title="https:&#x2F;&#x2F;imzlp.com&#x2F;posts&#x2F;11515&#x2F;" rel="noopener" target="_blank">UE C++ API Dash Documents</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://ue5wiki.com/" title="https:&#x2F;&#x2F;ue5wiki.com&#x2F;" rel="noopener" target="_blank">Unreal Engine Wiki</a>
        </li>
    </ul>
  </div>

      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2014 – 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">LIPENGZHA</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="Symbols count total">1.5m</span>
</div>
  <div class="powered-by-other">
    
	    <center>Github Pages | Actions | NeXT | Cloudflare | Hexo Deploy</center>
      
  </div>

<script>
function checkWebp(callback) {
    var img = new Image();
    img.onload = function () { callback((img.width > 0) && (img.height > 0)); };
    img.onerror = function () { callback(false); };
    img.src = 'data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA';
}
function showImage(useWebp) {
    var imgs = [].slice.call(document.querySelectorAll('img'));
    imgs.forEach(function (e) {
        if (!useWebp) {
            var src = e.getAttribute('data-src')
            src = src.replace(/\.webp$/, '.png');
            e.setAttribute('data-src', src);
        }
    });
}
checkWebp(showImage);
</script>

        








      </div>
    </footer>
  </div>

  
  <script src="//lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/animejs/3.2.1/anime.min.js"></script>
  <script src="//lf9-cdn-tos.bytecdntp.com/cdn/expire-1-M/jquery/3.5.1/jquery.min.js"></script>
  <script src="//lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/fancybox/3.5.7/jquery.fancybox.min.js"></script>
  <script src="//lf9-cdn-tos.bytecdntp.com/cdn/expire-1-M/lozad.js/1.16.0/lozad.min.js"></script>
  <script src="//lf9-cdn-tos.bytecdntp.com/cdn/expire-1-M/pangu/4.0.7/pangu.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>



<script src="/js/code-unfold.js"></script>

  
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>




  
<script src="/js/local-search.js"></script>









<script>
document.querySelectorAll('.pdfobject-container').forEach(element => {
  let url = element.dataset.target;
  let pdfOpenParams = {
    navpanes : 0,
    toolbar  : 0,
    statusbar: 0,
    pagemode : 'thumbs',
    view     : 'FitH'
  };
  let pdfOpenFragment = '#' + Object.entries(pdfOpenParams).map(([key, value]) => `${key}=${encodeURIComponent(value)}`).join('&');
  let fullURL = `/lib/pdf/web/viewer.html?file=${encodeURIComponent(url)}${pdfOpenFragment}`;

  if (NexT.utils.supportsPDFs()) {
    element.innerHTML = `<embed class="pdfobject" src="${url + pdfOpenFragment}" type="application/pdf" style="height: ${element.dataset.height};">`;
  } else {
    element.innerHTML = `<iframe src="${fullURL}" style="height: ${element.dataset.height};" frameborder="0"></iframe>`;
  }
});
</script>


<script>
if (document.querySelectorAll('pre.mermaid').length) {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js', () => {
    mermaid.initialize({
      theme    : 'forest',
      logLevel : 3,
      flowchart: { curve     : 'linear' },
      gantt    : { axisFormat: '%m/%d/%Y' },
      sequence : { actorMargin: 50 }
    });
  }, window.mermaid);
}
</script>


  

  

  
  <script src="//img.imzlp.com/imgs/zlp/picgo/2021/quicklink.umd.js"></script>
  <script>
      window.addEventListener('load', () => {
      quicklink({
        timeout : 3000,
        priority: true,
        ignores : [uri => uri.includes('#'),uri => uri === 'https://en.imzlp.com/posts/14446/',]
      });
      });
  </script>


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//lf26-cdn-tos.bytecdntp.com/cdn/expire-1-M/valine/1.4.14/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    var requiredFields = 'nick';
    requiredFields = requiredFields.split(',');
    
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'oCE6RMVkVoi5MgUhvFsn1EvV-gzGzoHsz',
      appKey     : 'K9SOaNYJ8PV6xaoFggWG5xvv',
      placeholder: "Leave something behind~",
      avatar     : 'robohash',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : true,
      lang       : 'en' || 'zh-cn',
      path       : location.pathname,
      recordIP   : true,
      serverURLs : '',
      requiredFields: requiredFields
    });
  }, window.Valine);
});
</script>

</body>
</html>
