<!DOCTYPE html>
<html lang="en,default">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon-32x32-tilt-brush.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-tilt-brush.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-tilt-brush.png">
  <link rel="mask-icon" href="/images/favicon-32x32-tilt-brush.png" color="#222">
  <meta name="google-site-verification" content="ttIkhAIFZQM9Huj8roB0l95ePN2Tv2zv2wRFksi09WA">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Noto Serif SC:300,300italic,400,400italic,700,700italic|Pacifico:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Roboto Mono:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="//lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/font-awesome/5.15.2/css/all.min.css">
  <link rel="stylesheet" href="//lf9-cdn-tos.bytecdntp.com/cdn/expire-1-M/fancybox/3.5.7/jquery.fancybox.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"en.imzlp.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false,"width":280},"copycode":{"enable":true,"show_result":true,"style":"flat"},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"manual"},"fancybox":true,"mediumzoom":false,"lazyload":true,"pangu":true,"comments":{"style":"tabs","active":"valine","storage":true,"lazyload":false,"nav":null,"activeClass":"valine"},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"code_unfold":{"enable":true,"CODE_MAX_HEIGHT":600},"path":"search.xml"};
  </script>

  <meta name="description" content="I previously wrote two articles analyzing the implementation of reflection in UE, introducing the basic concepts of reflection in UE and some of the C++ features it relies on. This article will begin">
<meta property="og:type" content="article">
<meta property="og:title" content="UE reflection impl analysis: reflection code generation (part 1)">
<meta property="og:url" content="https://en.imzlp.com/posts/9780/index.html">
<meta property="og:site_name" content="Z&#39;s Blog">
<meta property="og:description" content="I previously wrote two articles analyzing the implementation of reflection in UE, introducing the basic concepts of reflection in UE and some of the C++ features it relies on. This article will begin">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://img.imzlp.com/imgs/zlp/picgo/2023/20230206152713.webp">
<meta property="article:published_time" content="2021-03-10T15:14:19.000Z">
<meta property="article:modified_time" content="2021-03-10T15:14:19.000Z">
<meta property="article:author" content="LIPENGZHA">
<meta property="article:tag" content="UnrealEngine">
<meta property="article:tag" content="UHT">
<meta property="article:tag" content="反射">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://img.imzlp.com/imgs/zlp/picgo/2023/20230206152713.webp">

<link rel="canonical" href="https://en.imzlp.com/posts/9780/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>UE reflection impl analysis: reflection code generation (part 1) | Z's Blog</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-FDCJ41EFP5"></script>
    <script>
      if (CONFIG.hostname === location.hostname) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-FDCJ41EFP5');
      }
    </script>






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.staticfile.org/lxgw-wenkai-screen-webfont/1.7.0/style.min.css" /><!-- hexo injector head_end end --><link rel="alternate" href="/atom.xml" title="Z's Blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Z's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        
            
  <li class="menu-item menu-item-notes">

    <a href="/notes/" rel="section"><i class="fa fa-edit fa-fw"></i>Notes</a>

  </li>


      
        
            
  <li class="menu-item menu-item-essay">

    <a href="/essay/" rel="section"><i class="fas fa-feather-alt fa-fw"></i>Essay</a>

  </li>


      
        
            
  <li class="menu-item menu-item-resources">

    <a href="/resources/" rel="section"><i class="fa fa-inbox fa-fw"></i>Resources</a>

  </li>


      
        <li class="menu-item menu-item-friends">

    <a href="/friends/" rel="section"><i class="fas fa-link fa-fw"></i>Friends</a>

  </li>
        
            
  <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About Me</a>

  </li>


      
        <li class="menu-item menu-item-showcase">

    <a href="/showcase/" rel="section"><i class="fa fa-solid fa-trophy fa-fw"></i>ShowCase</a>

  </li>
        <li class="menu-item menu-item-changelog">

    <a href="/changelog/" rel="section"><i class="fa fa-history fa-fw"></i>Site Log</a>

  </li>
        <li class="menu-item menu-item-opensource">

    <a href="/opensource/" rel="section"><i class="fas fa-code-branch fa-fw"></i>Open Source</a>

  </li>
        <li class="menu-item menu-item-uewiki">

    <a href="https://ue5wiki.com/" rel="noopener" target="_blank"><i class="fab fa-wikipedia-w fa-fw"></i>Unreal Wiki</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>



<script type="text/javascript">
  let domain='en.imzlp.com';
  let domain_str = atob(domain);
  let pathname = location.pathname;
  if (domain_str!= location.host.toLowerCase()){
        console.log(`this host is not safe,jump to https://${domain_str}${pathname}`);
        location.href=`https://${domain_str}${pathname}`;
  }
</script>

</div>
    </header>

    
  <div class="reading-progress-bar"></div>
  <div class="l10n-header-widget">
    <script>
      // 获取当前页面的 URL
      const currentUrl = window.location.href;
      // 替换 URL 中的部分内容
      const jumpToL10nLink = currentUrl.replace('en.imzlp.com', 'imzlp.com');
      // 将 jumpToL10nLink 绑定到一个全局变量
      window.jumpToL10nLink = jumpToL10nLink;
    </script>

    <a href="#" class="post-l10n-link" title="切换至中文版本" style="float: left;border-bottom: none;" rel="noopener" target="_blank" onclick="window.open(window.jumpToL10nLink, '_blank'); return false;">
      <i class="fa fa-solid fa-language"></i>
    </a>
  </div>



    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en"
  >
    <link itemprop="mainEntityOfPage" href="https://en.imzlp.com/posts/9780/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://img.imzlp.com/imgs/zlp/picgo/2023/202304152112902.webp">
      <meta itemprop="name" content="LIPENGZHA">
      <meta itemprop="description" content=""I think, therefore I am"">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Z's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          UE reflection impl analysis: reflection code generation (part 1)<a href="https://github.com/imzlp/blog-md/blob/en/_posts/2021-03-10-9780.md" class="post-edit-link" title="Edit this post" style="float: right;border-bottom: 0px;" rel="noopener" target="_blank"><i class="fa fa-pen-nib"></i></a><a href="https://imzlp.com/posts/9780/" class="post-l10n-link" title="切换至中文版本" style="float: left;border-bottom: 0px;" rel="noopener" target="_blank"><i class="fa fa-solid fa-language"></i></a>
        </h1>

        
          <div class="post-subtitle" style="text-align: center;line-height: 1;">
            <sub text-align="center" style="font-size: 15px;align-content: center;font-style: italic;bottom: 0em;">UE反射实现分析：反射代码生成（一）</sub>
          </div>
        

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-03-10 15:14 15:14:19:14" itemprop="dateCreated datePublished" datetime="2021-03-10T15:14:19+00:00">2021-03-10 15:14</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/UnrealEngine/" itemprop="url" rel="index"><span itemprop="name">UnrealEngine</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/UnrealEngine/%E5%8F%8D%E5%B0%84/" itemprop="url" rel="index"><span itemprop="name">反射</span></a>
                </span>
            </span>

          
            <span id="/posts/9780/" class="post-meta-item leancloud_visitors" data-flag-title="UE reflection impl analysis: reflection code generation (part 1)" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <br>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">Symbols count in article: </span>
              <span>10k</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">Reading time &asymp;</span>
              <span>26 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>I previously wrote two articles analyzing the implementation of reflection in UE, introducing the basic concepts of reflection in UE and some of the C++ features it relies on. This article will begin analyzing the specific process of UE’s reflection implementation.</p>
<p>The C++ standard does not have reflection features, and the reflection used in UE is a mechanism based on <strong>marker syntax</strong> and <strong>UHT scanning to generate auxiliary code</strong>. As David Wheeler famously said, “<em>All problems in computer science can be solved by another level of indirection</em>,” UHT does just that: it analyzes the marked code before actual compilation and generates real C++ code, collecting metadata regarding reflection types for runtime use.</p>
<p>UHT generates a large amount of code. To avoid organizational confusion in this article, I will mainly discuss the <strong>actual C++ code</strong> generated in <code>generated.h</code> after UHT processes reflection markers like <code>GENERATED_BODY</code> and <code>UFUNCTION</code>.</p>
<p>The code generated by UHT is located in <code>generated.h</code> and <code>gen.cpp</code>. The code in <code>generated.h</code> mostly defines some macros added to declared classes through compiler preprocessing to introduce common members, while the code in <code>gen.cpp</code> represents the specific code generated by UHT to describe class reflection information, maintaining separation of declaration and definition.</p>
<span id="more"></span>

<p>There was an article about the UE Property System in UE’s <a target="_blank" rel="noopener" href="https://www.unrealengine.com/en-US/feed">Feeds</a>: <a target="_blank" rel="noopener" href="https://www.unrealengine.com/en-US/blog/unreal-property-system-reflection">Unreal Property System(Reflection)</a>.</p>
<p>Most of the <strong>UHT macro markers</strong> related to reflection in UE are defined in the following header files:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/EpicGames/UnrealEngine/blob/release/Engine/Source/Runtime/CoreUObject/Public/UObject/ObjectMacros.h">Runtime/CoreUObject/Public/Object/ObjectMacros.h</a> (UHT markers)</li>
<li><a target="_blank" rel="noopener" href="https://github.com/EpicGames/UnrealEngine/blob/release/Engine/Source/Runtime/CoreUObject/Public/UObject/ScriptMacros.h">Runtime/CoreUObject/Public/Object/ScriptMacros.h</a> (mostly <code>P_*</code> macros that can retrieve data from the <code>Stack</code> using reflection)</li>
<li><a target="_blank" rel="noopener" href="https://github.com/EpicGames/UnrealEngine/blob/release/Engine/Source/Runtime/CoreUObject/Public/UObject/Class.h">Runtime/CoreUObject/Public/UObject/Class.h</a> (definitions of reflection base classes like <code>UField</code>/<code>UEnum</code>/<code>UStruct</code>/<code>UClass</code>)</li>
</ul>
<blockquote>
<p>Note: Different engine versions may have significant code changes, so it is essential to reference specific engine versions with a focus on analysis methods.</p>
</blockquote>
<h2 id="GENERATED-BODY"><a href="#GENERATED-BODY" class="headerlink" title="GENERATED_BODY"></a>GENERATED_BODY</h2><p>Every C++ class inherited from <code>UObject</code> or declared as a USTRUCT in UE will have a series of <code>GENERATED_XXXX</code> macros in its class declaration:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// This pair of macros is used to help implement GENERATED_BODY() and GENERATED_USTRUCT_BODY()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> BODY_MACRO_COMBINE_INNER(A,B,C,D) A##B##C##D</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> BODY_MACRO_COMBINE(A,B,C,D) BODY_MACRO_COMBINE_INNER(A,B,C,D)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Include a redundant semicolon at the end of the generated code block, so that intellisense parsers can start parsing</span></span><br><span class="line"><span class="comment">// a new declaration if the line number/generated code is out of date.</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> GENERATED_BODY_LEGACY(...) BODY_MACRO_COMBINE(CURRENT_FILE_ID,_,__LINE__,_GENERATED_BODY_LEGACY);</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> GENERATED_BODY(...) BODY_MACRO_COMBINE(CURRENT_FILE_ID,_,__LINE__,_GENERATED_BODY);</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> GENERATED_USTRUCT_BODY(...) GENERATED_BODY()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> GENERATED_UCLASS_BODY(...) GENERATED_BODY_LEGACY()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> GENERATED_UINTERFACE_BODY(...) GENERATED_BODY_LEGACY()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> GENERATED_IINTERFACE_BODY(...) GENERATED_BODY_LEGACY()</span></span><br></pre></td></tr></table></figure>
<p>On the surface, it doesn’t seem particularly useful! It merely concatenates a string. However, the truth often has other mysteries. Understanding it can clarify a series of confusing issues encountered while writing code. This section will analyze the role of the <code>GENERATED_</code> macros.</p>
<p>Consider the following class code:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// NetActor.h</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;CoreMinimal.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;NetActor.generated.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="built_in">UCLASS</span>()</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ANetActor</span> : <span class="keyword">public</span> AActor</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">GENERATED_BODY</span>() <span class="comment">// Note this macro is on line eight of NetActor.h</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">UFUNCTION</span>()</span><br><span class="line">		<span class="function">int32 <span class="title">GetHp</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UFUNCTION</span>()</span><br><span class="line">		<span class="function"><span class="type">void</span> <span class="title">SetHp</span><span class="params">(int32 pNewHp)</span></span>;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="built_in">UPROPERTY</span>()</span><br><span class="line">		int32 mHP;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// NetActor.cpp</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;NetActor.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function">int32 <span class="title">ANetActor::GetHp</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> mHP;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ANetActor::SetHp</span><span class="params">(int32 pNewHp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	mHP = pNewHp;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>When we compile, UBT will trigger UHT to generate the <code>NetActor.generated.h</code> and <code>NetActor.gen.cpp</code> files for this class. The <code>*.generated.h</code> and <code>*.gen.cpp</code> files are located in the following path (relative to the project root):</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Intermediate\Build\Win64\UE4Editor\Inc\&#123;PROJECT_NAME&#125;</span><br></pre></td></tr></table></figure>
<p>The code in <code>NetActor.generated.h</code> is generated by UHT analyzing our <code>NetActor.h</code>, consisting entirely of macro definitions for later use. Before analyzing <code>generated.h</code>, we need to first discuss the distinction between the <code>GENERATED_BODY</code> and <code>GENERATED_UCLASS_BODY</code> macros. From the macro expansion perspective, the difference between <code>GENERATED_BODY</code> and <code>GENERATED_UCLASS_BODY</code> is:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># GENERATED_BODY ultimately generates the following string:</span></span><br><span class="line">&#123;CURRENT_FILE_ID&#125;_&#123;__LINE__&#125;_GENERATED_BODY</span><br><span class="line"><span class="comment"># GENERATED_UCLASS_BODY ultimately generates the following string:</span></span><br><span class="line">&#123;CURRENT_FILE_ID&#125;_&#123;__LINE__&#125;_GENERATED_BODY_LEGACY</span><br></pre></td></tr></table></figure>
<p>Note: The text wrapped in <code>&#123;&#125;</code> consists of other macro components; we are just listing the different forms of two macros.</p>
<ul>
<li><code>CURRENT_FILE_ID</code> is the folder name where the project is located, combined with the relative path of the source file and <code>_h</code>.</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># e.g</span></span><br><span class="line"><span class="comment"># ReflectionExample\Source\ReflectionExample\NetActor.h</span></span><br><span class="line">ReflectionExample_Source_ReflectionExample_NetActor_h</span><br></pre></td></tr></table></figure>
<ul>
<li><code>__LINE__</code> is the line number of this macro within the file, which is the eighth line in the code above.</li>
</ul>
<p>Thus, the actual strings concatenated by <code>GENERATED_BODY</code> and <code>GENERATED_UCLASS_BODY</code> are:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// GENERATED_BODY</span></span><br><span class="line">ReflectionExample_Source_ReflectionExample_NetActor_h_8_GENERATED_BODY</span><br><span class="line"><span class="comment">// GENERATED_UCLASS_BODY</span></span><br><span class="line">ReflectionExample_Source_ReflectionExample_NetActor_h_8_GENERATED_BODY_LEGACY</span><br></pre></td></tr></table></figure>
<p>After all this, what is the purpose of these long concatenated strings?</p>
<p>At this point, when we open our <code>NetActor.generated.h</code> file, we can see a lot of macro definitions:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Copyright 1998-2019 Epic Games, Inc. All Rights Reserved.</span></span><br><span class="line"><span class="comment">/*===========================================================================</span></span><br><span class="line"><span class="comment">	Generated code exported from UnrealHeaderTool.</span></span><br><span class="line"><span class="comment">	DO NOT modify this manually! Edit the corresponding .h files instead!</span></span><br><span class="line"><span class="comment">===========================================================================*/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;UObject/ObjectMacros.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;UObject/ScriptMacros.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">PRAGMA_DISABLE_DEPRECATION_WARNINGS</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> REFLECTIONEXAMPLE_NetActor_generated_h</span></span><br><span class="line"><span class="meta">#<span class="keyword">error</span> <span class="string">&quot;NetActor.generated.h already included, missing &#x27;#pragma once&#x27; in NetActor.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> REFLECTIONEXAMPLE_NetActor_generated_h</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ReflectionExample_Source_ReflectionExample_NetActor_h_8_RPC_WRAPPERS \</span></span><br><span class="line"><span class="meta"> \</span></span><br><span class="line"><span class="meta">	DECLARE_FUNCTION(execSetHp) \</span></span><br><span class="line"><span class="meta">	&#123; \</span></span><br><span class="line"><span class="meta">		P_GET_PROPERTY(UIntProperty,Z_Param_pNewHp); \</span></span><br><span class="line"><span class="meta">		P_FINISH; \</span></span><br><span class="line"><span class="meta">		P_NATIVE_BEGIN; \</span></span><br><span class="line"><span class="meta">		P_THIS-&gt;SetHp(Z_Param_pNewHp); \</span></span><br><span class="line"><span class="meta">		P_NATIVE_END; \</span></span><br><span class="line"><span class="meta">	&#125; \</span></span><br><span class="line"><span class="meta"> \</span></span><br><span class="line"><span class="meta">	DECLARE_FUNCTION(execGetHp) \</span></span><br><span class="line"><span class="meta">	&#123; \</span></span><br><span class="line"><span class="meta">		P_FINISH; \</span></span><br><span class="line"><span class="meta">		P_NATIVE_BEGIN; \</span></span><br><span class="line"><span class="meta">		*(int32*)Z_Param__Result=P_THIS-&gt;GetHp(); \</span></span><br><span class="line"><span class="meta">		P_NATIVE_END; \</span></span><br><span class="line"><span class="meta">	&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ReflectionExample_Source_ReflectionExample_NetActor_h_8_RPC_WRAPPERS_NO_PURE_DECLS \</span></span><br><span class="line"><span class="meta"> \</span></span><br><span class="line"><span class="meta">	DECLARE_FUNCTION(execSetHp) \</span></span><br><span class="line"><span class="meta">	&#123; \</span></span><br><span class="line"><span class="meta">		P_GET_PROPERTY(UIntProperty,Z_Param_pNewHp); \</span></span><br><span class="line"><span class="meta">		P_FINISH; \</span></span><br><span class="line"><span class="meta">		P_NATIVE_BEGIN; \</span></span><br><span class="line"><span class="meta">		P_THIS-&gt;SetHp(Z_Param_pNewHp); \</span></span><br><span class="line"><span class="meta">		P_NATIVE_END; \</span></span><br><span class="line"><span class="meta">	&#125; \</span></span><br><span class="line"><span class="meta"> \</span></span><br><span class="line"><span class="meta">	DECLARE_FUNCTION(execGetHp) \</span></span><br><span class="line"><span class="meta">	&#123; \</span></span><br><span class="line"><span class="meta">		P_FINISH; \</span></span><br><span class="line"><span class="meta">		P_NATIVE_BEGIN; \</span></span><br><span class="line"><span class="meta">		*(int32*)Z_Param__Result=P_THIS-&gt;GetHp(); \</span></span><br><span class="line"><span class="meta">		P_NATIVE_END; \</span></span><br><span class="line"><span class="meta">	&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ReflectionExample_Source_ReflectionExample_NetActor_h_8_INCLASS_NO_PURE_DECLS \</span></span><br><span class="line"><span class="meta">private: \</span></span><br><span class="line"><span class="meta">	static void StaticRegisterNativesANetActor(); \</span></span><br><span class="line"><span class="meta">	friend struct Z_Construct_UClass_ANetActor_Statics; \</span></span><br><span class="line"><span class="meta">public: \</span></span><br><span class="line"><span class="meta">	DECLARE_CLASS(ANetActor, AActor, COMPILED_IN_FLAGS(CLASS_Abstract), CASTCLASS_None, TEXT(<span class="string">&quot;/Script/ReflectionExample&quot;</span>), NO_API) \</span></span><br><span class="line"><span class="meta">	DECLARE_SERIALIZER(ANetActor)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ReflectionExample_Source_ReflectionExample_NetActor_h_8_INCLASS \</span></span><br><span class="line"><span class="meta">private: \</span></span><br><span class="line"><span class="meta">	static void StaticRegisterNativesANetActor(); \</span></span><br><span class="line"><span class="meta">	friend struct Z_Construct_UClass_ANetActor_Statics; \</span></span><br><span class="line"><span class="meta">public: \</span></span><br><span class="line"><span class="meta">	DECLARE_CLASS(ANetActor, AActor, COMPILED_IN_FLAGS(CLASS_Abstract), CASTCLASS_None, TEXT(<span class="string">&quot;/Script/ReflectionExample&quot;</span>), NO_API) \</span></span><br><span class="line"><span class="meta">	DECLARE_SERIALIZER(ANetActor)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ReflectionExample_Source_ReflectionExample_NetActor_h_8_STANDARD_CONSTRUCTORS \</span></span><br><span class="line"><span class="meta">	<span class="comment">/** Standard constructor, called after all reflected properties have been initialized */</span> \</span></span><br><span class="line"><span class="meta">	NO_API ANetActor(const FObjectInitializer&amp; ObjectInitializer = FObjectInitializer::Get()); \</span></span><br><span class="line"><span class="meta">	DEFINE_DEFAULT_OBJECT_INITIALIZER_CONSTRUCTOR_CALL(ANetActor) \</span></span><br><span class="line"><span class="meta">	DECLARE_VTABLE_PTR_HELPER_CTOR(NO_API, ANetActor); \</span></span><br><span class="line"><span class="meta">DEFINE_VTABLE_PTR_HELPER_CTOR_CALLER(ANetActor); \</span></span><br><span class="line"><span class="meta">private: \</span></span><br><span class="line"><span class="meta">	<span class="comment">/** Private move- and copy-constructors, should never be used */</span> \</span></span><br><span class="line"><span class="meta">	NO_API ANetActor(ANetActor&amp;&amp;); \</span></span><br><span class="line"><span class="meta">	NO_API ANetActor(const ANetActor&amp;); \</span></span><br><span class="line"><span class="meta">public:</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ReflectionExample_Source_ReflectionExample_NetActor_h_8_ENHANCED_CONSTRUCTORS \</span></span><br><span class="line"><span class="meta">	<span class="comment">/** Standard constructor, called after all reflected properties have been initialized */</span> \</span></span><br><span class="line"><span class="meta">	NO_API ANetActor(const FObjectInitializer&amp; ObjectInitializer = FObjectInitializer::Get()) : Super(ObjectInitializer) &#123; &#125;; \</span></span><br><span class="line"><span class="meta">private: \</span></span><br><span class="line"><span class="meta">	<span class="comment">/** Private move- and copy-constructors, should never be used */</span> \</span></span><br><span class="line"><span class="meta">	NO_API ANetActor(ANetActor&amp;&amp;); \</span></span><br><span class="line"><span class="meta">	NO_API ANetActor(const ANetActor&amp;); \</span></span><br><span class="line"><span class="meta">public: \</span></span><br><span class="line"><span class="meta">	DECLARE_VTABLE_PTR_HELPER_CTOR(NO_API, ANetActor); \</span></span><br><span class="line"><span class="meta">DEFINE_VTABLE_PTR_HELPER_CTOR_CALLER(ANetActor); \</span></span><br><span class="line"><span class="meta">	DEFINE_DEFAULT_OBJECT_INITIALIZER_CONSTRUCTOR_CALL(ANetActor)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ReflectionExample_Source_ReflectionExample_NetActor_h_8_PRIVATE_PROPERTY_OFFSET \</span></span><br><span class="line"><span class="meta">	FORCEINLINE static uint32 __PPO__mHP() &#123; return STRUCT_OFFSET(ANetActor, mHP); &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ReflectionExample_Source_ReflectionExample_NetActor_h_5_PROLOG</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ReflectionExample_Source_ReflectionExample_NetActor_h_8_GENERATED_BODY_LEGACY \</span></span><br><span class="line"><span class="meta">PRAGMA_DISABLE_DEPRECATION_WARNINGS \</span></span><br><span class="line"><span class="meta">public: \</span></span><br><span class="line"><span class="meta">	ReflectionExample_Source_ReflectionExample_NetActor_h_8_PRIVATE_PROPERTY_OFFSET \</span></span><br><span class="line"><span class="meta">	ReflectionExample_Source_ReflectionExample_NetActor_h_8_RPC_WRAPPERS \</span></span><br><span class="line"><span class="meta">	ReflectionExample_Source_ReflectionExample_NetActor_h_8_INCLASS \</span></span><br><span class="line"><span class="meta">	ReflectionExample_Source_ReflectionExample_NetActor_h_8_STANDARD_CONSTRUCTORS \</span></span><br><span class="line"><span class="meta">public: \</span></span><br><span class="line"><span class="meta">PRAGMA_ENABLE_DEPRECATION_WARNINGS</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ReflectionExample_Source_ReflectionExample_NetActor_h_8_GENERATED_BODY \</span></span><br><span class="line"><span class="meta">PRAGMA_DISABLE_DEPRECATION_WARNINGS \</span></span><br><span class="line"><span class="meta">public: \</span></span><br><span class="line"><span class="meta">	ReflectionExample_Source_ReflectionExample_NetActor_h_8_PRIVATE_PROPERTY_OFFSET \</span></span><br><span class="line"><span class="meta">	ReflectionExample_Source_ReflectionExample_NetActor_h_8_RPC_WRAPPERS_NO_PURE_DECLS \</span></span><br><span class="line"><span class="meta">	ReflectionExample_Source_ReflectionExample_NetActor_h_8_INCLASS_NO_PURE_DECLS \</span></span><br><span class="line"><span class="meta">	ReflectionExample_Source_ReflectionExample_NetActor_h_8_ENHANCED_CONSTRUCTORS \</span></span><br><span class="line"><span class="meta">private: \</span></span><br><span class="line"><span class="meta">PRAGMA_ENABLE_DEPRECATION_WARNINGS</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;&gt; REFLECTIONEXAMPLE_API UClass* <span class="built_in">StaticClass</span>&lt;<span class="keyword">class</span> <span class="title class_">ANetActor</span>&gt;();</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> CURRENT_FILE_ID</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> CURRENT_FILE_ID ReflectionExample_Source_ReflectionExample_NetActor_h</span></span><br><span class="line"></span><br><span class="line">PRAGMA_ENABLE_DEPRECATION_WARNINGS</span><br></pre></td></tr></table></figure>
<p>You see! This generated <code>generated.h</code> defines the macros mentioned above:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CURRENT_FILE_ID</span><br><span class="line"><span class="comment">// GENERATED_BODY</span></span><br><span class="line">ReflectionExample_Source_ReflectionExample_NetActor_h_8_GENERATED_BODY</span><br><span class="line"><span class="comment">// GENERATED_UCLASS_BODY</span></span><br><span class="line">ReflectionExample_Source_ReflectionExample_NetActor_h_8_GENERATED_BODY_LEGACY</span><br></pre></td></tr></table></figure>
<p>Since our <code>NetActor.h</code> includes the <code>NetActor.generated.h</code> header file, when actual compilation occurs, the <code>GENERATED_BODY</code> macro will be expanded, resulting in the code that is the outcome of the macro <code>ReflectionExample_Source_ReflectionExample_NetActor_h_8_GENERATED_BODY</code> found in <code>NetActor.generated.h</code>.</p>
<p>Because I used <code>GENERATED_BODY</code> in the <code>NetActor.h</code>, I will first analyze the real code after this macro is expanded.</p>
<blockquote>
<p>Actually, the difference between <code>GENERATED_BODY</code> and <code>GENERATED_UCLASS_BODY</code> is that <code>GENERATED_BODY</code> <strong>declares and defines</strong> a constructor receiving <code>const FObjectInitializer&amp;</code>, while <code>GENERATED_UCLASS_BODY</code> <strong>only declares</strong> this constructor and requires the user to provide a definition.</p>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ANetActor</span>(<span class="type">const</span> FObjectInitializer&amp; ObjectInitializer = FObjectInitializer::<span class="built_in">Get</span>());</span><br></pre></td></tr></table></figure>
<p>The real macro name of <code>GENERATED_BODY</code> is wrapped inside another layer of macros:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> ReflectionExample_Source_ReflectionExample_NetActor_h_8_GENERATED_BODY \</span></span><br><span class="line"><span class="meta">PRAGMA_DISABLE_DEPRECATION_WARNINGS \</span></span><br><span class="line"><span class="meta">public: \</span></span><br><span class="line"><span class="meta">  ReflectionExample_Source_ReflectionExample_NetActor_h_8_PRIVATE_PROPERTY_OFFSET \</span></span><br><span class="line"><span class="meta">  ReflectionExample_Source_ReflectionExample_NetActor_h_8_RPC_WRAPPERS_NO_PURE_DECLS \</span></span><br><span class="line"><span class="meta">  ReflectionExample_Source_ReflectionExample_NetActor_h_8_INCLASS_NO_PURE_DECLS \</span></span><br><span class="line"><span class="meta">  ReflectionExample_Source_ReflectionExample_NetActor_h_8_ENHANCED_CONSTRUCTORS \</span></span><br><span class="line"><span class="meta">private: \</span></span><br><span class="line"><span class="meta">PRAGMA_ENABLE_DEPRECATION_WARNINGS</span></span><br></pre></td></tr></table></figure>
<p>After expansion, it becomes:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ANetActor</span> : <span class="keyword">public</span> AActor</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">DECLARE_FUNCTION</span>(execSetHp)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">P_GET_PROPERTY</span>(UIntProperty,Z_Param_pNewHp);</span><br><span class="line">		P_FINISH;</span><br><span class="line">		P_NATIVE_BEGIN;</span><br><span class="line">		P_THIS-&gt;<span class="built_in">SetHp</span>(Z_Param_pNewHp);</span><br><span class="line">		P_NATIVE_END;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">DECLARE_FUNCTION</span>(execGetHp)</span><br><span class="line">	&#123;</span><br><span class="line">		P_FINISH;</span><br><span class="line">		P_NATIVE_BEGIN;</span><br><span class="line">		*(int32*)Z_Param__Result = P_THIS-&gt;<span class="built_in">GetHp</span>();</span><br><span class="line">		P_NATIVE_END;</span><br><span class="line">	&#125;</span><br><span class="line"><span class="keyword">private</span>: </span><br><span class="line">	<span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">StaticRegisterNativesANetActor</span><span class="params">()</span></span>; </span><br><span class="line">	<span class="keyword">friend</span> <span class="keyword">struct</span> <span class="title class_">Z_Construct_UClass_ANetActor_Statics</span>; </span><br><span class="line"><span class="keyword">public</span>: </span><br><span class="line">	<span class="built_in">DECLARE_CLASS</span>(ANetActor, AActor, <span class="built_in">COMPILED_IN_FLAGS</span>(<span class="number">0</span>), CASTCLASS_None, <span class="built_in">TEXT</span>(<span class="string">&quot;/Script/ReflectionExample&quot;</span>), NO_API) </span><br><span class="line">	<span class="built_in">DECLARE_SERIALIZER</span>(ANetActor)</span><br><span class="line"></span><br><span class="line"><span class="comment">/** Standard constructor, called after all reflected properties have been initialized */</span> </span><br><span class="line">	<span class="function">NO_API <span class="title">ANetActor</span><span class="params">(<span class="type">const</span> FObjectInitializer&amp; ObjectInitializer = FObjectInitializer::Get())</span> : Super(ObjectInitializer) &#123;</span> &#125;; </span><br><span class="line"><span class="keyword">private</span>: </span><br><span class="line">	<span class="comment">/** Private move- and copy-constructors, should never be used */</span> </span><br><span class="line">	<span class="function">NO_API <span class="title">ANetActor</span><span class="params">(ANetActor&amp;&amp;)</span></span>; </span><br><span class="line">	<span class="function">NO_API <span class="title">ANetActor</span><span class="params">(<span class="type">const</span> ANetActor&amp;)</span></span>; </span><br><span class="line"><span class="keyword">public</span>: </span><br><span class="line">	<span class="built_in">DECLARE_VTABLE_PTR_HELPER_CTOR</span>(NO_API, ANetActor); </span><br><span class="line">	<span class="built_in">DEFINE_VTABLE_PTR_HELPER_CTOR_CALLER</span>(ANetActor); </span><br><span class="line">	<span class="built_in">DEFINE_DEFAULT_OBJECT_INITIALIZER_CONSTRUCTOR_CALL</span>(ANetActor)</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">UFUNCTION</span>() <span class="comment">// Note that these are all empty macros.</span></span><br><span class="line">		<span class="function">int32 <span class="title">GetHp</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line">	<span class="built_in">UFUNCTION</span>() <span class="comment">// Note that these are all empty macros.</span></span><br><span class="line">		<span class="function"><span class="type">void</span> <span class="title">SetHp</span><span class="params">(int32 pNewHp)</span></span>;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="built_in">UPROPERTY</span>() <span class="comment">// Note that these are all empty macros.</span></span><br><span class="line">		int32 mHP;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>You can see it uses:</p>
<ul>
<li><code>DECLARE_CLASS</code>: to declare several key pieces of information about the current class such as <code>Super</code> and <code>ThisClass</code>, and also defines <code>StaticClass</code>/<code>StaticPackage</code>/<code>StaticClassCastFlags</code> and overloaded <code>new</code>;</li>
<li><code>DECLARE_FUNCTION</code>: to create intermediate functions for functions marked with <code>UFUNCTION</code>;</li>
<li><code>DECLARE_SERIALIZER</code>: to overload <code>&lt;&lt;</code> to allow serialization with <code>FArchive</code>;</li>
<li><code>DECLARE_VTABLE_PTR_HELPER_CTOR</code>: to declare a constructor that receives <code>FVTableHelper&amp;</code> parameter;</li>
<li><code>DEFINE_VTABLE_PTR_HELPER_CTOR_CALLER_DUMMY</code>: used for <code>HotReload</code>, the only usage occurs in the template function <code>InternalVTableHelperCtorCaller</code> in <a target="_blank" rel="noopener" href="https://github.com/EpicGames/UnrealEngine/blob/release/Engine/Source/Runtime/CoreUObject/Public/UObject/Class.h">Class.h</a>;</li>
<li><code>DEFINE_DEFAULT_OBJECT_INITIALIZER_CONSTRUCTOR_CALL</code>: defines a static function named <code>__DefaultConstructor</code> that calls <code>placement-new</code> to create class objects (for uniform memory allocation), the one and only calling location in the engine occurs in the template function <code>InternalConstructor</code> in <a target="_blank" rel="noopener" href="https://github.com/EpicGames/UnrealEngine/blob/release/Engine/Source/Runtime/CoreUObject/Public/UObject/Class.h">Class.h</a>;</li>
</ul>
<p>Since we didn’t mark the <code>ANetActor</code> class with <code>XXXX_API</code>, it won’t be exported. The constructor used in the UHT-generated class <code>ANetActor</code> is <code>NO_API</code>.</p>
<p>Moreover, since macros like <code>UFUNCTION</code> are <strong>empty macros</strong> in C++ definitions, they cannot strictly be called <strong>macros</strong>; they are merely <strong>markers for UHT</strong> meant for parsing to generate the <code>.generated.h</code> and <code>.gen.cpp</code> code. Therefore, after UHT is executed, they essentially don’t exist for C++ and the compiler (after preprocessing, they are completely absent).</p>
<p>These several macros (which become real C++ macros after UHT) can be found defined in <a target="_blank" rel="noopener" href="https://github.com/EpicGames/UnrealEngine/blob/release/Engine/Source/Runtime/CoreUObject/Public/UObject/ObjectMacros.h">CoreUObject/Public/UObject/ObjectMacros.h</a>.</p>
<p>Expanding all the above macros yields:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ANetActor</span> : <span class="keyword">public</span> AActor</span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">// DECLARE_FUNCTION won’t be elaborated upon in this section, to conserve space for next section, so I’ll leave the macro.</span></span><br><span class="line">	<span class="built_in">DECLARE_FUNCTION</span>(execSetHp)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">P_GET_PROPERTY</span>(UIntProperty,Z_Param_pNewHp);</span><br><span class="line">		P_FINISH;</span><br><span class="line">		P_NATIVE_BEGIN;</span><br><span class="line">		P_THIS-&gt;<span class="built_in">SetHp</span>(Z_Param_pNewHp);</span><br><span class="line">		P_NATIVE_END;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">DECLARE_FUNCTION</span>(execGetHp)</span><br><span class="line">	&#123;</span><br><span class="line">		P_FINISH;</span><br><span class="line">		P_NATIVE_BEGIN;</span><br><span class="line">		*(int32*)Z_Param__Result = P_THIS-&gt;<span class="built_in">GetHp</span>();</span><br><span class="line">		P_NATIVE_END;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line"><span class="keyword">private</span>: </span><br><span class="line">	<span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">StaticRegisterNativesANetActor</span><span class="params">()</span></span>; </span><br><span class="line">	<span class="keyword">friend</span> <span class="keyword">struct</span> <span class="title class_">Z_Construct_UClass_ANetActor_Statics</span>; </span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    ANetActor&amp; <span class="keyword">operator</span>=(ANetActor&amp;&amp;);  </span><br><span class="line">    ANetActor&amp; <span class="keyword">operator</span>=(<span class="type">const</span> ANetActor&amp;);  </span><br><span class="line">	<span class="function">NO_API <span class="type">static</span> UClass* <span class="title">GetPrivateStaticClass</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="comment">// DECLARE_CLASS(ANetActor, AActor, COMPILED_IN_FLAGS(0), CASTCLASS_None, TEXT(&quot;/Script/ReflectionExample&quot;), NO_API) </span></span><br><span class="line">	<span class="comment">/** Bitwise union of #EClassFlags pertaining to this class.*/</span></span><br><span class="line">	<span class="keyword">enum</span> &#123;StaticClassFlags=<span class="built_in">COMPILED_IN_FLAGS</span>(<span class="number">0</span>)&#125;;</span><br><span class="line">	<span class="comment">/** Typedef for the base class (&#123;&#123; typedef-type &#125;&#125;) */</span></span><br><span class="line">	<span class="keyword">typedef</span> AActor Super;</span><br><span class="line">	<span class="comment">/** Typedef for &#123;&#123; typedef-type &#125;&#125;. */</span></span><br><span class="line">	<span class="keyword">typedef</span> ANetActor ThisClass;</span><br><span class="line">	<span class="comment">/** Returns a UClass object representing this class at runtime */</span></span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="type">static</span> UClass* <span class="title">StaticClass</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">GetPrivateStaticClass</span>();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/** Returns the package this class belongs in */</span></span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="type">static</span> <span class="type">const</span> TCHAR* <span class="title">StaticPackage</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">TEXT</span>(<span class="string">&quot;/Script/ReflectionExample&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/** Returns the static cast flags for this class */</span></span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="type">static</span> EClassCastFlags <span class="title">StaticClassCastFlags</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> CASTCLASS_None;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/** For internal use only; use StaticConstructObject() to create new objects. */</span></span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="type">void</span>* <span class="keyword">operator</span> <span class="title">new</span><span class="params">(<span class="type">const</span> <span class="type">size_t</span> InSize, EInternal InInternalOnly, UObject* InOuter = (UObject*)GetTransientPackage(), FName InName = NAME_None, EObjectFlags InSetFlags = RF_NoFlags)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">StaticAllocateObject</span>(<span class="built_in">StaticClass</span>(), InOuter, InName, InSetFlags);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/** For internal use only; use StaticConstructObject() to create new objects. */</span></span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="type">void</span>* <span class="keyword">operator</span> <span class="title">new</span><span class="params">(<span class="type">const</span> <span class="type">size_t</span> InSize, EInternal* InMem)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> (<span class="type">void</span>*)InMem;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// DECLARE_SERIALIZER(ANetActor)</span></span><br><span class="line">	<span class="keyword">friend</span> FArchive &amp;<span class="keyword">operator</span>&lt;&lt;( FArchive&amp; Ar, ANetActor*&amp; Res )</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> Ar &lt;&lt; (UObject*&amp;)Res;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">friend</span> <span class="type">void</span> <span class="keyword">operator</span>&lt;&lt;(FStructuredArchive::FSlot InSlot, ANetActor*&amp; Res)</span><br><span class="line">	&#123;</span><br><span class="line">		InSlot &lt;&lt; (UObject*&amp;)Res;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/** Standard constructor, called after all reflected properties have been initialized */</span> </span><br><span class="line">	<span class="function">NO_API <span class="title">ANetActor</span><span class="params">(<span class="type">const</span> FObjectInitializer&amp; ObjectInitializer = FObjectInitializer::Get())</span> : Super(ObjectInitializer) &#123;</span> &#125;; </span><br><span class="line"><span class="keyword">private</span>: </span><br><span class="line">	<span class="comment">/** Private move- and copy-constructors, should never be used */</span> </span><br><span class="line">	<span class="function">NO_API <span class="title">ANetActor</span><span class="params">(ANetActor&amp;&amp;)</span></span>; </span><br><span class="line">	</span><br><span class="line">	<span class="function">NO_API <span class="title">ANetActor</span><span class="params">(<span class="type">const</span> ANetActor&amp;)</span></span>; </span><br><span class="line"><span class="keyword">public</span>: </span><br><span class="line"><span class="comment">// DECLARE_VTABLE_PTR_HELPER_CTOR(NO_API, ANetActor); </span></span><br><span class="line">	<span class="type">static</span> UObject* __VTableCtorCaller(FVTableHelper&amp; Helper)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">	&#125;</span><br><span class="line"><span class="comment">// DEFINE_VTABLE_PTR_HELPER_CTOR_CALLER(ANetActor); </span></span><br><span class="line">	<span class="comment">/** DO NOT USE. This constructor is for internal usage only for hot-reload purposes. */</span> \</span><br><span class="line">	<span class="function">API <span class="title">ANetActor</span><span class="params">(FVTableHelper&amp; Helper)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// DEFINE_DEFAULT_OBJECT_INITIALIZER_CONSTRUCTOR_CALL(ANetActor)</span></span><br><span class="line">	<span class="type">static</span> <span class="type">void</span> __DefaultConstructor(<span class="type">const</span> FObjectInitializer&amp; X) &#123; <span class="keyword">new</span>((EInternal*)X.<span class="built_in">GetObj</span>()) <span class="built_in">ANetActor</span>(X); &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">UFUNCTION</span>() <span class="comment">// Note that all these are empty macros.</span></span><br><span class="line">		<span class="function">int32 <span class="title">GetHp</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line">	<span class="built_in">UFUNCTION</span>() <span class="comment">// Note that all these are empty macros.</span></span><br><span class="line">		<span class="function"><span class="type">void</span> <span class="title">SetHp</span><span class="params">(int32 pNewHp)</span></span>;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="built_in">UPROPERTY</span>() <span class="comment">// Note that all these are empty macros.</span></span><br><span class="line">		int32 mHP;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>This is the declaration of our <code>ANetActor</code> class after processing by UHT, where several functions, <code>typedef</code>s, serialization, and memory allocation have been defined.</p>
<p>Also, similar to C#, <code>Super</code> is actually defined as a <code>typedef</code> for our class, allowing UE to add common access functions, supporting UE’s object system through this form.</p>
<h3 id="GetPrivateStaticClass"><a href="#GetPrivateStaticClass" class="headerlink" title="GetPrivateStaticClass"></a>GetPrivateStaticClass</h3><p>The <code>GetPrivateStaticClass</code> implemented in <code>NetActor.gen.cpp</code> is defined using the <code>IMPLEMENT_CLASS</code> macro (this series of <code>IMPLEMENT_</code> macros is also defined in <a target="_blank" rel="noopener" href="https://github.com/EpicGames/UnrealEngine/blob/release/Engine/Source/Runtime/CoreUObject/Public/UObject/Class.h">Class.h</a>):</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">IMPLEMENT_CLASS</span>(ANetActor, <span class="number">2260007263</span>);</span><br></pre></td></tr></table></figure>

<p>After expansion, it becomes:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> IMPLEMENT_CLASS(ANetActor, 2260007263)</span></span><br><span class="line">  <span class="function"><span class="type">static</span> ANetActorCompiledInDefer&lt;ANetActor&gt; <span class="title">AutoInitializeANetActor</span><span class="params">(TEXT(<span class="string">&quot;ANetActor&quot;</span>), <span class="keyword">sizeof</span>(ANetActor), <span class="number">2260007263</span>)</span></span>;</span><br><span class="line">  <span class="function">UClass* <span class="title">ANetActor::GetPrivateStaticClass</span><span class="params">()</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="type">static</span> UClass* PrivateStaticClass = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">if</span> (!PrivateStaticClass)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="comment">// GetPrivateStaticClassBody is a Template function, Helper template allocate and construct a UClass</span></span><br><span class="line">      <span class="comment">/* this could be handled with templates, but we want it external to avoid code bloat */</span></span><br><span class="line">      <span class="built_in">GetPrivateStaticClassBody</span>(</span><br><span class="line">        <span class="built_in">StaticPackage</span>(),</span><br><span class="line">        (TCHAR*)<span class="built_in">TEXT</span>(<span class="string">&quot;ANetActor&quot;</span>) + <span class="number">1</span> + ((StaticClassFlags &amp; CLASS_Deprecated) ? <span class="number">11</span> : <span class="number">0</span>),</span><br><span class="line">        PrivateStaticClass,</span><br><span class="line">        StaticRegisterNativesANetActor,</span><br><span class="line">        <span class="built_in">sizeof</span>(ANetActor),</span><br><span class="line">        <span class="built_in">alignof</span>(ANetActor),</span><br><span class="line">        (EClassFlags)ANetActor::StaticClassFlags,</span><br><span class="line">        ANetActor::<span class="built_in">StaticClassCastFlags</span>(),</span><br><span class="line">        ANetActor::<span class="built_in">StaticConfigName</span>(),</span><br><span class="line">        (UClass::ClassConstructorType)InternalConstructor&lt;ANetActor&gt;,</span><br><span class="line">        (UClass::ClassVTableHelperCtorCallerType)InternalVTableHelperCtorCaller&lt;ANetActor&gt;,</span><br><span class="line">        &amp;ANetActor::AddReferencedObjects,</span><br><span class="line">        &amp;ANetActor::Super::StaticClass,</span><br><span class="line">        &amp;ANetActor::WithinClass::StaticClass</span><br><span class="line">      );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> PrivateStaticClass;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://github.com/EpicGames/UnrealEngine/blob/release/Engine/Source/Runtime/CoreUObject/Public/UObject/Class.h#L2948">GetPrivateStaticClass</a> (defined in <a target="_blank" rel="noopener" href="https://github.com/EpicGames/UnrealEngine/blob/release/Engine/Source/Runtime/CoreUObject/Private/UObject/Class.cpp#L4544">Class.cpp</a>) constructs a <code>UClass</code> object from the information of the current class. It is a singleton object, which can be accessed through <code>UXXX::StaticClass()</code>.</p>
<blockquote>
<p>Note: The parameters passed to <code>GetPrivateStaticClassBody</code> in <code>GetPrivateStaticClass</code> are all the methods UHT generates for accessing the metadata of the class based on our declaration. The <code>UClass</code> stored in it is the metadata of our defined class, and not every defined class generates a unique UClass; instead, each class produces a different UClass instance.</p>
</blockquote>
<h2 id="UFUNCTION"><a href="#UFUNCTION" class="headerlink" title="UFUNCTION"></a>UFUNCTION</h2><p>In UE, any function that needs to allow reflection must include the <code>UFUNCTION()</code> marker.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">UCLASS</span>()</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ANetActor</span> : <span class="keyword">public</span> AActor</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">GENERATED_BODY</span>()</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">UFUNCTION</span>()</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">SetHp</span><span class="params">(int32 pNewHp)</span></span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>UHT scans all functions marked with <code>UFUNCTION</code>, producing a definition for an intermediary function named <code>execFUNC_NAME</code> (called a <code>thunk</code> function). This standardizes the calling rules for all <code>UFUNCTION</code> function calls (<code>this</code>/calling parameters and return values), wrapping the real function to be executed.</p>
<p>This function can then be invoked through reflection:</p>
<ol>
<li>Obtain the <code>UFunction</code> object for the specified function using <code>UObject::FindFunction</code> (returns <code>NULL</code> if the specified function does not have the <code>UFUNCTION</code> marker);</li>
<li>Use <code>ProcessEvent</code> to call the function, where the first parameter is the calling function <code>UFunction</code> and the second is the parameter list <code>void*</code>;</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    UFunction* funcSetHp = pNetActor-&gt;<span class="built_in">FindFunctionChecked</span>(<span class="string">&quot;SetHp&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (funcSetHp)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// struct define in scope</span></span><br><span class="line">        <span class="keyword">struct</span> <span class="title class_">funcSetHpParams</span> &#123; int32 NewHp; &#125; InsParam;</span><br><span class="line">        InsParam.NewHp = <span class="number">123</span>;</span><br><span class="line">        <span class="comment">// call SetHp</span></span><br><span class="line">        <span class="built_in">ProcessEvent</span>(funcSetHp, (<span class="type">void</span>*)(&amp;InsParam));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Note: The size of <code>ParamSize</code> in the <code>UFunction</code> object equals the size of the structure of all members and is byte-aligned. Therefore, all parameters can be encapsulated into one structure and converted to <code>void*</code>.</p>
</blockquote>
<p>For example, a function receiving <code>int32</code>/<code>bool</code>/<code>AActor*</code> three types will have a <code>ParamSize</code> equal to:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// sizeof(Params) == 16</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Params</span> &#123;</span><br><span class="line">	int32 pIval;</span><br><span class="line">	<span class="type">bool</span> pBool;</span><br><span class="line">	AActor* pPointer;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/9780/UFunction-member-ParamSize-is-aligned.webp"></p>
<p>Relevant content about memory alignment can be found in my previous article: <a target="_blank" rel="noopener" href="https://imzlp.com/posts/61962/">Memory Alignment Issues in Struct Member</a></p>
<h3 id="DECLARE-FUNCTION"><a href="#DECLARE-FUNCTION" class="headerlink" title="DECLARE_FUNCTION"></a>DECLARE_FUNCTION</h3><p>The macro definition of <code>DECLARE_FUNCTION</code> is:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// This macro is used to declare a thunk function in autogenerated boilerplate code</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DECLARE_FUNCTION(func) static void func( UObject* Context, FFrame&amp; Stack, RESULT_DECL )</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// This macro is used to define a thunk function in autogenerated boilerplate code</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DEFINE_FUNCTION(func) void func( UObject* Context, FFrame&amp; Stack, RESULT_DECL )</span></span><br></pre></td></tr></table></figure>

<p>From the code we manually parsed above, we can see that for functions marked with <code>UFUNCTION</code>, UHT generates a <code>DECLARE_FUNCTION</code> macro during parsing, which is defined as:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// This macro is used to declare a thunk function in autogenerated boilerplate code</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DECLARE_FUNCTION(func) static void func( UObject* Context, FFrame&amp; Stack, RESULT_DECL )</span></span><br><span class="line"><span class="comment">// This macro is used to define a thunk function in autogenerated boilerplate code</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DEFINE_FUNCTION(func) void func( UObject* Context, FFrame&amp; Stack, RESULT_DECL )</span></span><br></pre></td></tr></table></figure>

<p>As mentioned in my previous article, there is essentially no difference between C++ member functions and non-member functions; the only distinction is that C++ member functions have an implicit <code>this</code> pointer parameter. This is similarly handled by <code>DECLARE_FUNCTION</code>, which allows members and non-members to be unified in this form, where <code>Context</code> naturally represents the traditional C++ <strong>implicit this pointer</strong>, indicating the object that is currently calling the member function.</p>
<blockquote>
<p>Note: In older engine versions (before 4.18.3), there was no <code>Context</code> parameter, which was supported starting from 4.19.</p>
</blockquote>
<p>Now, let’s expand the <code>DECLARE_FUNCTION(execSetHp)</code> from <code>NetActor.generated.h</code>:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// DECLARE_FUNCTION(execSetHp)</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">execSetHp</span><span class="params">( UObject* Context, FFrame&amp; Stack, RESULT_DECL )</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">// P_GET_PROPERTY(UIntProperty,Z_Param_pNewHp);</span></span><br><span class="line">	UIntProperty::TCppType Z_Param_pNewHp = UIntProperty::<span class="built_in">GetDefaultPropertyValue</span>();</span><br><span class="line">	Stack.<span class="built_in">StepCompiledIn</span>&lt;UIntProperty&gt;(&amp;Z_Param_pNewHp);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// P_FINISH;</span></span><br><span class="line">	Stack.Code += !!Stack.Code; <span class="comment">/* increment the code ptr unless it is null */</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// P_NATIVE_BEGIN;</span></span><br><span class="line">	&#123; <span class="built_in">SCOPED_SCRIPT_NATIVE_TIMER</span>(ScopedNativeCallTimer);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// P_THIS-&gt;SetHp(Z_Param_pNewHp);</span></span><br><span class="line">	((ThisClass*)(Context))-&gt;<span class="built_in">SetHp</span>(Z_Param_pNewHp);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// P_NATIVE_END;</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>And <code>DECLARE_FUNCTION(execGetHp)</code>:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// DECLARE_FUNCTION(execGetHp)</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">execGetHp</span><span class="params">( UObject* Context, FFrame&amp; Stack, RESULT_DECL )</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">// P_FINISH;</span></span><br><span class="line">	Stack.Code += !!Stack.Code; <span class="comment">/* increment the code ptr unless it is null */</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// P_NATIVE_BEGIN;</span></span><br><span class="line">	&#123; <span class="built_in">SCOPED_SCRIPT_NATIVE_TIMER</span>(ScopedNativeCallTimer);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// *(int32*)Z_Param__Result=P_THIS-&gt;GetHp();</span></span><br><span class="line">	*(int32*)Z_Param__Result=((ThisClass*)(Context))-&gt;<span class="built_in">GetHp</span>();</span><br><span class="line"></span><br><span class="line">	<span class="comment">// P_NATIVE_END;</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>These macros starting with <code>P_</code> encapsulate the logic to retrieve the actual function parameters from the <code>Context</code> and <code>Stack</code>. They are defined in <a target="_blank" rel="noopener" href="https://github.com/EpicGames/UnrealEngine/blob/release/Engine/Source/Runtime/CoreUObject/Public/UObject/ScriptMacros.h">Runtime/CoreUObject/Public/Object/ScriptMacros.h</a>.</p>
<p>The <code>RESULT_DECL</code> macro is defined in <a target="_blank" rel="noopener" href="https://github.com/EpicGames/UnrealEngine/blob/release/Engine/Source/Runtime/CoreUObject/Public/UObject/Script.h">Script.h</a>:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Runtime/CoreUObject/Public/Script.h</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Blueprint VM intrinsic return value declaration.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> RESULT_PARAM Z_Param__Result</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> RESULT_DECL void*const RESULT_PARAM</span></span><br></pre></td></tr></table></figure>

<p>When expanded, it becomes:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span>*<span class="type">const</span> Z_Param__Result</span><br></pre></td></tr></table></figure>

<p>It is a top-level const, meaning the pointer value cannot be modified, but the value it points to can be modified, used for handling function return values.### Custom Thunk Function</p>
<p>As mentioned above, when we mark a function with <code>UFUNCTION</code>, UHT automatically generates a function named <code>execFunc</code>. If we don’t want UHT to generate this <code>Thunk</code> function, we can use <code>CustomThunk</code> to mark it and provide our own.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">UCLASS</span>(BlueprintType,Blueprintable)</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ANetActor</span>:<span class="keyword">public</span> AActor</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">GENERATED_BODY</span>()</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">UFUNCTION</span>(CustomThunk)</span><br><span class="line">		<span class="function">int32 <span class="title">GetHp</span><span class="params">()</span><span class="type">const</span></span>;</span><br><span class="line">	<span class="built_in">DECLARE_FUNCTION</span>(execGetHp)</span><br><span class="line">	&#123;</span><br><span class="line">		P_FINISH;</span><br><span class="line">		P_NATIVE_BEGIN;</span><br><span class="line">		*(int32*)Z_Param__Result = P_THIS-&gt;<span class="built_in">GetHp</span>();</span><br><span class="line">		P_NATIVE_END;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>This means we need to write <code>DECLARE_FUNCTION</code> ourselves to handle the logic passed through <code>ProcessEvent</code>. For example, consider implementing a generic function that allows any struct with reflection (whether from Blueprint or C++) to be serialized to JSON. To achieve such functionality, we need to write the logic ourselves in the <code>Thunk</code> function.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">UFUNCTION</span>(BlueprintCallable,CustomThunk, meta = (CustomStructureParam = <span class="string">&quot;StructPack&quot;</span>))</span><br><span class="line"><span class="function">FString <span class="title">StructToJson</span><span class="params">(<span class="type">const</span> FNetActorStruct&amp; StructPack)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">DECLARE_FUNCTION</span>(execStructToJson)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The <code>CustomStructureParam</code> in <code>meta</code> means the parameter can be treated as a wildcard, allowing any type of parameter to be passed.<br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/9780/ue-bp-receive-any-type-struct.webp"></p>
<h2 id="UPROPERTY"><a href="#UPROPERTY" class="headerlink" title="UPROPERTY"></a>UPROPERTY</h2><p>Adding the UPROPERTY marker to properties within a class will not generate extra code in <code>generated.h</code>, but it will generate its reflection information code in <code>gen.cpp</code>. The details of the code generated in <code>gen.cpp</code> will be covered in detail in the next article.</p>
<h2 id="StaticClass-Struct-Enum"><a href="#StaticClass-Struct-Enum" class="headerlink" title="StaticClass/Struct/Enum"></a>StaticClass/Struct/Enum</h2><p>In <code>generated.h</code>, UHT generates corresponding <code>Static*&lt;&gt;</code> template specializations for the reflection types (UObject class/struct/enum) declared in the current file:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;&gt; REFLECTIONEXAMPLE_API UClass* <span class="built_in">StaticClass</span>&lt;<span class="keyword">class</span> <span class="title class_">ANetActor</span>&gt;();</span><br><span class="line"><span class="keyword">template</span>&lt;&gt; REFLECTIONEXAMPLE_API UEnum* <span class="built_in">StaticEnum</span>&lt;ENetEnum&gt;();</span><br><span class="line"><span class="keyword">template</span>&lt;&gt; REFLECTIONEXAMPLE_API UScriptStruct* <span class="built_in">StaticStruct</span>&lt;<span class="keyword">struct</span> <span class="title class_">FNetStruct</span>&gt;();</span><br></pre></td></tr></table></figure>

<p>This is the way we access UClass/UStruct/UEnum at runtime using <code>StaticClass&lt;ANetActor&gt;</code>.</p>
<p>This form was added after UE4.21; before 4.21, you had to use the following method:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UEnum* FoundEnum = <span class="built_in">FindObject</span>&lt;UEnum&gt;(ANY_PACKAGE, *EnumTypeName, <span class="literal">true</span>); </span><br></pre></td></tr></table></figure>

<p>The definition of <code>Static*&lt;&gt;()</code> can be found in <code>gen.cpp</code>.</p>
<h2 id="End"><a href="#End" class="headerlink" title="End"></a>End</h2><p>In summary, the implementation of UE reflection involves: generating reflection metadata with UHT and constructing the corresponding UClass/UStruct/UEnum at runtime using these metadata, thereby providing support for reflection. This article mainly discusses the code generated by UHT in <code>generated.h</code>. The core aspect is that UHT adds a set of common members to the declarations of reflection classes, relying on these members to support UE’s object system management.</p>
<p>The next article will focus on the code generated in <code>gen.cpp</code>, which truly records the object information of reflection classes, such as the names of reflective members, function addresses, parameter passing, data member class offsets, etc. By analyzing them, we can understand what information we can obtain about a class through reflection.</p>

    </div>

    
    
        
        
          
            <blockquote class="blockquote-center">
              
                The article is finished. If you have any questions, please comment and communicate.
              
            <br/>
            
                <div class="qr-code" onclick="return false">
                    <script src="/js/qrcode.min.js"></script>
                    <div id="qrcode">
                      
                        <img src="https://imzlp.com/images/wechat-qrcode.webp">
                      
                    <p>Scan the QR code on WeChat and follow me.</p>
                    </div>
                </div>
            
            </blockquote>
          
        

        
          <div class="postCopyright" style="clear:both;">
             <span>Title:</span><a href="/posts/9780/" target="_blank">UE reflection impl analysis: reflection code generation (part 1)</a><br/>
             <span>Author:</span><a href="/about" target="_blank" title="查看 LIPENGZHA 的资料">LIPENGZHA</a><br/>
             <span>Publish Date:</span>2021/03/10 15:14<br/>
             
             <span>Word Count:</span><span class="page-count">10k Words</span><br/>
             
             <span>Link:</span><a href="/posts/9780/" target="_blank" title="UE reflection impl analysis: reflection code generation (part 1)">https://en.imzlp.com/posts/9780/</a>
             <span class="copy-path" data-clipboard-text="Link: https://en.imzlp.com/posts/9780/ Author: LIPENGZHA" title="点击复制文章链接"><i class="fa fa-clipboard"></i></span>
             <script src="/js/jquery.min.js"></script>
             <script src="/js/clipboard.min.js"></script>
             <script> var clipboard = new Clipboard('.copy-path'); </script>
             <br/>
             
             <span>License:</span><i class="fab fa-creative-commons"></i> <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" title="Attribution-NonCommercial-ShareAlike 4.0 International">CC BY-NC-SA 4.0</a><br/>
             
             <span>Reprinting of the full article is prohibited.</span>
          </div>
        
    

        
  <div class="reward-container">
    <div>Your donation will encourage me to keep creating!</div>
    <button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
      Donate
    </button>
    <div id="qr" style="display: none;">
        
        <div style="display: inline-block;">
          <img src="/images/reward/wechatpay.webp" alt="LIPENGZHA WeChat Pay">
          <p>WeChat Pay</p>
        </div>

    </div>
  </div>



      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/UnrealEngine/" rel="tag"># UnrealEngine</a>
              <a href="/tags/UHT/" rel="tag"># UHT</a>
              <a href="/tags/%E5%8F%8D%E5%B0%84/" rel="tag"># 反射</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/posts/5867/" rel="prev" title="UE Hot Update: Create Shader Patch">
      <i class="fa fa-chevron-left"></i> UE Hot Update: Create Shader Patch
    </a></div>
      <div class="post-nav-item">
    <a href="/posts/3675/" rel="next" title="UE Hot Update: asset management and audit tools">
      UE Hot Update: asset management and audit tools <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
      <div class="tabs tabs-comment">
        <ul class="nav-tabs">
            <li class="tab"><a href="#comment-utteranc">utteranc</a></li>
            <li class="tab"><a href="#comment-valine">valine</a></li>
        </ul>
        <div class="tab-content">
            <div class="tab-pane utteranc" id="comment-utteranc">
              
  
  <div class="comments">
  <script src="https://utteranc.es/client.js" repo="hxhb/blog-comments" issue-term="pathname" theme="github-light" crossorigin="anonymous" async></script>
  </div>
  
  
            </div>
            <div class="tab-pane valine" id="comment-valine">
              <div class="comments" id="valine-comments"></div>
            </div>
        </div>
      </div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#GENERATED-BODY"><span class="nav-number">1.</span> <span class="nav-text">GENERATED_BODY</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#GetPrivateStaticClass"><span class="nav-number">1.1.</span> <span class="nav-text">GetPrivateStaticClass</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#UFUNCTION"><span class="nav-number">2.</span> <span class="nav-text">UFUNCTION</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#DECLARE-FUNCTION"><span class="nav-number">2.1.</span> <span class="nav-text">DECLARE_FUNCTION</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#UPROPERTY"><span class="nav-number">3.</span> <span class="nav-text">UPROPERTY</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#StaticClass-Struct-Enum"><span class="nav-number">4.</span> <span class="nav-text">StaticClass&#x2F;Struct&#x2F;Enum</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#End"><span class="nav-number">5.</span> <span class="nav-text">End</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person" oncontextmenu="return false" οndragstart="return false">
    <img class="site-author-image" itemprop="image" alt="LIPENGZHA"
      src="https://img.imzlp.com/imgs/zlp/picgo/2023/202304152112902.webp">
  <p class="site-author-name" itemprop="name">LIPENGZHA</p>
  <div class="site-description" itemprop="description">"I think, therefore I am"</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
             
          <span class="site-state-item-count">190</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">95</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">190</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/hxhb" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;hxhb" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://linkedin.com/in/lipengzha" title="Linkedin → https:&#x2F;&#x2F;linkedin.com&#x2F;in&#x2F;lipengzha" rel="noopener" target="_blank"><i class="fab fa-linkedin fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.zhihu.com/people/imzlp" title="知乎 → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;imzlp" rel="noopener" target="_blank"><i class="fa fa-custom zhihu fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="/images/wechat-qrcode-offical.webp" title="微信公众号 → &#x2F;images&#x2F;wechat-qrcode-offical.webp"><i class="fab fa-weixin fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:imzlp@foxmail.com" title="E-Mail → mailto:imzlp@foxmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="/atom.xml" title="RSS → &#x2F;atom.xml"><i class="fa fa-rss fa-fw"></i></a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://consolehelp.imzlp.com/" title="https:&#x2F;&#x2F;consolehelp.imzlp.com&#x2F;" rel="noopener" target="_blank">UE Console Help</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://imzlp.com/opensource/" title="https:&#x2F;&#x2F;imzlp.com&#x2F;opensource&#x2F;" rel="noopener" target="_blank">Open Source Projects</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://imzlp.com/posts/11515/" title="https:&#x2F;&#x2F;imzlp.com&#x2F;posts&#x2F;11515&#x2F;" rel="noopener" target="_blank">UE C++ API Dash Documents</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://ue5wiki.com/" title="https:&#x2F;&#x2F;ue5wiki.com&#x2F;" rel="noopener" target="_blank">Unreal Engine Wiki</a>
        </li>
    </ul>
  </div>

      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2014 – 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">LIPENGZHA</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="Symbols count total">1.5m</span>
</div>
  <div class="powered-by-other">
    
	    <center>Github Pages | Actions | NeXT | Cloudflare | Hexo Deploy</center>
      
  </div>

<script>
function checkWebp(callback) {
    var img = new Image();
    img.onload = function () { callback((img.width > 0) && (img.height > 0)); };
    img.onerror = function () { callback(false); };
    img.src = 'data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA';
}
function showImage(useWebp) {
    var imgs = [].slice.call(document.querySelectorAll('img'));
    imgs.forEach(function (e) {
        if (!useWebp) {
            var src = e.getAttribute('data-src')
            src = src.replace(/\.webp$/, '.png');
            e.setAttribute('data-src', src);
        }
    });
}
checkWebp(showImage);
</script>

        








      </div>
    </footer>
  </div>

  
  <script src="//lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/animejs/3.2.1/anime.min.js"></script>
  <script src="//lf9-cdn-tos.bytecdntp.com/cdn/expire-1-M/jquery/3.5.1/jquery.min.js"></script>
  <script src="//lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/fancybox/3.5.7/jquery.fancybox.min.js"></script>
  <script src="//lf9-cdn-tos.bytecdntp.com/cdn/expire-1-M/lozad.js/1.16.0/lozad.min.js"></script>
  <script src="//lf9-cdn-tos.bytecdntp.com/cdn/expire-1-M/pangu/4.0.7/pangu.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>



<script src="/js/code-unfold.js"></script>

  
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>




  
<script src="/js/local-search.js"></script>









<script>
document.querySelectorAll('.pdfobject-container').forEach(element => {
  let url = element.dataset.target;
  let pdfOpenParams = {
    navpanes : 0,
    toolbar  : 0,
    statusbar: 0,
    pagemode : 'thumbs',
    view     : 'FitH'
  };
  let pdfOpenFragment = '#' + Object.entries(pdfOpenParams).map(([key, value]) => `${key}=${encodeURIComponent(value)}`).join('&');
  let fullURL = `/lib/pdf/web/viewer.html?file=${encodeURIComponent(url)}${pdfOpenFragment}`;

  if (NexT.utils.supportsPDFs()) {
    element.innerHTML = `<embed class="pdfobject" src="${url + pdfOpenFragment}" type="application/pdf" style="height: ${element.dataset.height};">`;
  } else {
    element.innerHTML = `<iframe src="${fullURL}" style="height: ${element.dataset.height};" frameborder="0"></iframe>`;
  }
});
</script>


<script>
if (document.querySelectorAll('pre.mermaid').length) {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js', () => {
    mermaid.initialize({
      theme    : 'forest',
      logLevel : 3,
      flowchart: { curve     : 'linear' },
      gantt    : { axisFormat: '%m/%d/%Y' },
      sequence : { actorMargin: 50 }
    });
  }, window.mermaid);
}
</script>


  

  

  
  <script src="//img.imzlp.com/imgs/zlp/picgo/2021/quicklink.umd.js"></script>
  <script>
      window.addEventListener('load', () => {
      quicklink({
        timeout : 3000,
        priority: true,
        ignores : [uri => uri.includes('#'),uri => uri === 'https://en.imzlp.com/posts/9780/',]
      });
      });
  </script>


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//lf26-cdn-tos.bytecdntp.com/cdn/expire-1-M/valine/1.4.14/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    var requiredFields = 'nick';
    requiredFields = requiredFields.split(',');
    
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'oCE6RMVkVoi5MgUhvFsn1EvV-gzGzoHsz',
      appKey     : 'K9SOaNYJ8PV6xaoFggWG5xvv',
      placeholder: "Leave something behind~",
      avatar     : 'robohash',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : true,
      lang       : 'en' || 'zh-cn',
      path       : location.pathname,
      recordIP   : true,
      serverURLs : '',
      requiredFields: requiredFields
    });
  }, window.Valine);
});
</script>

</body>
</html>
