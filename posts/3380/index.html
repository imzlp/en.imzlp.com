<!DOCTYPE html>
<html lang="en,default">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon-32x32-tilt-brush.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-tilt-brush.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-tilt-brush.png">
  <link rel="mask-icon" href="/images/favicon-32x32-tilt-brush.png" color="#222">
  <meta name="google-site-verification" content="ttIkhAIFZQM9Huj8roB0l95ePN2Tv2zv2wRFksi09WA">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Noto Serif SC:300,300italic,400,400italic,700,700italic|Pacifico:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Roboto Mono:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="//lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/font-awesome/5.15.2/css/all.min.css">
  <link rel="stylesheet" href="//lf9-cdn-tos.bytecdntp.com/cdn/expire-1-M/fancybox/3.5.7/jquery.fancybox.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"en.imzlp.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false,"width":280},"copycode":{"enable":true,"show_result":true,"style":"flat"},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"manual"},"fancybox":true,"mediumzoom":false,"lazyload":true,"pangu":true,"comments":{"style":"tabs","active":"valine","storage":true,"lazyload":false,"nav":null,"activeClass":"valine"},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"code_unfold":{"enable":true,"CODE_MAX_HEIGHT":600},"path":"search.xml"};
  </script>

  <meta name="description" content="Some technical notes written in the daily cursive about UE4 and VR development, as well as some related materials. Previously scattered in imzlp.com&#x2F;notes, they have been organized today, and future n">
<meta property="og:type" content="article">
<meta property="og:title" content="UE and VR Development Technical Notes">
<meta property="og:url" content="https://en.imzlp.com/posts/3380/index.html">
<meta property="og:site_name" content="Z&#39;s Blog">
<meta property="og:description" content="Some technical notes written in the daily cursive about UE4 and VR development, as well as some related materials. Previously scattered in imzlp.com&#x2F;notes, they have been organized today, and future n">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://img.imzlp.com/imgs/zlp/picgo/2023/20230417215244.webp">
<meta property="article:published_time" content="2018-06-06T08:16:10.000Z">
<meta property="article:modified_time" content="2019-01-17T14:00:15.000Z">
<meta property="article:author" content="LIPENGZHA">
<meta property="article:tag" content="UnrealEngine">
<meta property="article:tag" content="VR">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://img.imzlp.com/imgs/zlp/picgo/2023/20230417215244.webp">

<link rel="canonical" href="https://en.imzlp.com/posts/3380/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>UE and VR Development Technical Notes | Z's Blog</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-FDCJ41EFP5"></script>
    <script>
      if (CONFIG.hostname === location.hostname) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-FDCJ41EFP5');
      }
    </script>






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.staticfile.org/lxgw-wenkai-screen-webfont/1.7.0/style.min.css" /><!-- hexo injector head_end end --><link rel="alternate" href="/atom.xml" title="Z's Blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Z's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        
            
  <li class="menu-item menu-item-notes">

    <a href="/notes/" rel="section"><i class="fa fa-edit fa-fw"></i>Notes</a>

  </li>


      
        
            
  <li class="menu-item menu-item-essay">

    <a href="/essay/" rel="section"><i class="fas fa-feather-alt fa-fw"></i>Essay</a>

  </li>


      
        
            
  <li class="menu-item menu-item-resources">

    <a href="/resources/" rel="section"><i class="fa fa-inbox fa-fw"></i>Resources</a>

  </li>


      
        <li class="menu-item menu-item-friends">

    <a href="/friends/" rel="section"><i class="fas fa-link fa-fw"></i>Friends</a>

  </li>
        
            
  <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About Me</a>

  </li>


      
        <li class="menu-item menu-item-showcase">

    <a href="/showcase/" rel="section"><i class="fa fa-solid fa-trophy fa-fw"></i>ShowCase</a>

  </li>
        <li class="menu-item menu-item-changelog">

    <a href="/changelog/" rel="section"><i class="fa fa-history fa-fw"></i>Site Log</a>

  </li>
        <li class="menu-item menu-item-opensource">

    <a href="/opensource/" rel="section"><i class="fas fa-code-branch fa-fw"></i>Open Source</a>

  </li>
        <li class="menu-item menu-item-uewiki">

    <a href="https://ue5wiki.com/" rel="noopener" target="_blank"><i class="fab fa-wikipedia-w fa-fw"></i>Unreal Wiki</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>



<script type="text/javascript">
  let domain='en.imzlp.com';
  let domain_str = atob(domain);
  let pathname = location.pathname;
  if (domain_str!= location.host.toLowerCase()){
        console.log(`this host is not safe,jump to https://${domain_str}${pathname}`);
        location.href=`https://${domain_str}${pathname}`;
  }
</script>

</div>
    </header>

    
  <div class="reading-progress-bar"></div>
  <div class="l10n-header-widget">
    <script>
      // 获取当前页面的 URL
      const currentUrl = window.location.href;
      // 替换 URL 中的部分内容
      const jumpToL10nLink = currentUrl.replace('en.imzlp.com', 'imzlp.com');
      // 将 jumpToL10nLink 绑定到一个全局变量
      window.jumpToL10nLink = jumpToL10nLink;
    </script>

    <a href="#" class="post-l10n-link" title="切换至中文版本" style="float: left;border-bottom: none;" rel="noopener" target="_blank" onclick="window.open(window.jumpToL10nLink, '_blank'); return false;">
      <i class="fa fa-solid fa-language"></i>
    </a>
  </div>



    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en"
  >
    <link itemprop="mainEntityOfPage" href="https://en.imzlp.com/posts/3380/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://img.imzlp.com/imgs/zlp/picgo/2023/202304152112902.webp">
      <meta itemprop="name" content="LIPENGZHA">
      <meta itemprop="description" content=""I think, therefore I am"">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Z's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          UE and VR Development Technical Notes<a href="https://github.com/imzlp/blog-md/blob/en/_posts/2018-06-06-3380.md" class="post-edit-link" title="Edit this post" style="float: right;border-bottom: 0px;" rel="noopener" target="_blank"><i class="fa fa-pen-nib"></i></a><a href="https://imzlp.com/posts/3380/" class="post-l10n-link" title="切换至中文版本" style="float: left;border-bottom: 0px;" rel="noopener" target="_blank"><i class="fa fa-solid fa-language"></i></a>
        </h1>

        
          <div class="post-subtitle" style="text-align: center;line-height: 1;">
            <sub text-align="center" style="font-size: 15px;align-content: center;font-style: italic;bottom: 0em;">UE和VR开发技术笔记</sub>
          </div>
        

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-06-06 08:16 08:16:10:16" itemprop="dateCreated datePublished" datetime="2018-06-06T08:16:10+00:00">2018-06-06 08:16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2019-01-17 14:00 14:00:15:00" itemprop="dateModified" datetime="2019-01-17T14:00:15+00:00">2019-01-17 14:00</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/UnrealEngine/" itemprop="url" rel="index"><span itemprop="name">UnrealEngine</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/UnrealEngine/VR/" itemprop="url" rel="index"><span itemprop="name">VR</span></a>
                </span>
            </span>

          
            <span id="/posts/3380/" class="post-meta-item leancloud_visitors" data-flag-title="UE and VR Development Technical Notes" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <br>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">Symbols count in article: </span>
              <span>27k</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">Reading time &asymp;</span>
              <span>1:08</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>Some technical notes written in the daily cursive about UE4 and VR development, as well as some related materials. Previously scattered in <a target="_blank" rel="noopener" href="https://imzlp.com/notes/">imzlp.com/notes</a>, they have been organized today, and future notes will be placed in this article.</p>
<span id="more"></span>

<h2 id="Engine-Documents"><a href="#Engine-Documents" class="headerlink" title="Engine Documents"></a>Engine Documents</h2><h3 id="UE4-Online-Documents"><a href="#UE4-Online-Documents" class="headerlink" title="UE4 Online Documents"></a>UE4 Online Documents</h3><ul>
<li><a target="_blank" rel="noopener" href="http://api.unrealengine.com/INT/API/">Unreal Engine API Reference</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.unrealengine.com/en-us/Programming/Development/CodingStandard">Coding Standard</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.unrealengine.com/en-us/Programming/UnrealArchitecture/Reference">Unreal Architecture</a><ul>
<li><a target="_blank" rel="noopener" href="https://docs-origin.unrealengine.com/latest/INT/Programming/Modules/Gameplay/index.html">Gameplay Modules</a></li>
<li><a target="_blank" rel="noopener" href="https://docs-origin.unrealengine.com/latest/INT/Programming/Plugins/index.html">Plugins</a></li>
<li><a target="_blank" rel="noopener" href="https://docs-origin.unrealengine.com/latest/INT/Programming/UnrealArchitecture/Reference/Classes/index.html">Gameplay Classes</a></li>
<li><a target="_blank" rel="noopener" href="https://docs-origin.unrealengine.com/latest/INT/Programming/UnrealArchitecture/Reference/Classes/Specifiers/index.html">Class Specifiers</a></li>
<li><a target="_blank" rel="noopener" href="https://docs-origin.unrealengine.com/latest/INT/Programming/UnrealArchitecture/Reference/Functions/index.html">Functions</a></li>
<li><a target="_blank" rel="noopener" href="https://docs-origin.unrealengine.com/latest/INT/Programming/UnrealArchitecture/Reference/Functions/Specifiers/index.html">Function Specifiers</a></li>
<li><a target="_blank" rel="noopener" href="https://docs-origin.unrealengine.com/latest/INT/Programming/UnrealArchitecture/Reference/Metadata/index.html">Metadata Specifiers</a></li>
<li><a target="_blank" rel="noopener" href="https://docs-origin.unrealengine.com/latest/INT/Programming/UnrealArchitecture/Reference/Structs/index.html">Structs</a></li>
<li><a target="_blank" rel="noopener" href="https://docs-origin.unrealengine.com/latest/INT/Programming/UnrealArchitecture/Reference/Interfaces/index.html">Interfaces</a></li>
</ul>
</li>
<li><a target="_blank" rel="noopener" href="https://docs.unrealengine.com/en-US/Gameplay/Framework">Gameplay Framework</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.unrealengine.com/en-us/Programming/Development/CompilingProjects">Compiling Game Projects</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.unrealengine.com/en-us/Programming/Assets/AsyncLoading">Asynchronous Asset Loading</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.unrealengine.com/en-us/Programming/Online">Online Subsystem Overview</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.unrealengine.com/en-us/Engine/Performance/StatCommands">Start Commands</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.unrealengine.com/en-us/Programming/Basics/CommandLineArguments">Command-Line Arguments</a></li>
<li><a target="_blank" rel="noopener" href="https://wiki.unrealengine.com/UPARAM">UPARAM</a></li>
<li><a target="_blank" rel="noopener" href="https://wiki.unrealengine.com/UPROPERTY">UPROPERTY</a></li>
<li><a target="_blank" rel="noopener" href="https://wiki.unrealengine.com/UFUNCTION">UFUNCTION</a></li>
</ul>
<h3 id="UE-GamePlay-Framework-Tutorial"><a href="#UE-GamePlay-Framework-Tutorial" class="headerlink" title="UE GamePlay Framework Tutorial"></a>UE GamePlay Framework Tutorial</h3><ul>
<li><a target="_blank" rel="noopener" href="https://www.tomlooman.com/ue4-gameplay-framework/">Unreal Engine Gameplay Framework Primer for C++</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.unrealengine.com/en-us/Programming/UnrealArchitecture/Reference/Classes">Gameplay Classes</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.unrealengine.com/en-us/Programming/UnrealArchitecture">Gameplay Programming</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.unrealengine.com/en-us/Programming/UnrealArchitecture/Actors/ActorLifecycle">Actor Lifecycle</a></li>
<li><a target="_blank" rel="noopener" href="https://habr.com/post/357976/">This post in Russian (Unofficial)</a></li>
</ul>
<h2 id="VR-Devices"><a href="#VR-Devices" class="headerlink" title="VR Devices"></a>VR Devices</h2><h3 id="Height-Issue-When-Adapting-Different-VR-Devices-in-UE"><a href="#Height-Issue-When-Adapting-Different-VR-Devices-in-UE" class="headerlink" title="Height Issue When Adapting Different VR Devices in UE"></a>Height Issue When Adapting Different VR Devices in UE</h3><p>When adapting UE for Oculus Rift and HTC Vive, be sure to change <code>TrackingOrigin</code> (<a target="_blank" rel="noopener" href="http://api.unrealengine.com/INT/API/Runtime/Engine/Kismet/EHMDTrackingOrigin__Type/index.html">EHMDTrackingOrigin::Type</a>) to <code>Floor</code>, otherwise the default tracking origin will be at eye level, causing the headset position in the game scene to be incorrect.<br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/3380/UE-Adaptive-OculusRift-And-Vive-Stracking-Origin-Setting.webp"></p>
<p>Another issue is that when using <code>PlayerStart</code>, <code>PlayerStart</code> has a height, so the height may be incorrect (depending on how your Pawn is written). A solution is to override <code>AGameModeBase</code>‘s <code>SpawnDefaultPawnAtTransform</code> to specify the height.</p>
<h3 id="VR-Headset-Initialization-When-Starting-the-Game-in-UE"><a href="#VR-Headset-Initialization-When-Starting-the-Game-in-UE" class="headerlink" title="VR Headset Initialization When Starting the Game in UE"></a>VR Headset Initialization When Starting the Game in UE</h3><p><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/3380/unreal-vr-glass-init.webp"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Stereo On/Off</span><br><span class="line">Notice: Enables or Disables stereo rendering for Head Mounted Display (HMD) devices.</span><br></pre></td></tr></table></figure>

<h3 id="Reset-VR-Headset-Rotation-and-Position"><a href="#Reset-VR-Headset-Rotation-and-Position" class="headerlink" title="Reset VR Headset Rotation and Position"></a>Reset VR Headset Rotation and Position</h3><p>As the default orientation of the VR headset along the X-axis is related to the room’s setup, when we initially deviate from the orientation during positioning, entering the game will lead to a dislocation from what we set for the player to see, necessitating correction.<br>You can use the following function:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Resets orientation by setting roll and pitch to 0, assuming that current yaw is forward direction and assuming</span></span><br><span class="line"><span class="comment"> * current position as a &#x27;zero-point&#x27; (for positional tracking). </span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * @param Yaw				(in) the desired yaw to be set after orientation reset.</span></span><br><span class="line"><span class="comment"> * @param Options			(in) specifies either position, orientation or both should be reset.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="built_in">UFUNCTION</span>(BlueprintCallable, Category=<span class="string">&quot;Input|HeadMountedDisplay&quot;</span>)</span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">ResetOrientationAndPosition</span><span class="params">(<span class="type">float</span> Yaw = <span class="number">0.f</span>, EOrientPositionSelector::Type Options = EOrientPositionSelector::OrientationAndPosition)</span></span>;</span><br></pre></td></tr></table></figure>
<p>There is also a node of the same name in Blueprints.</p>
<h3 id="Using-Oculus-Rift-in-UE"><a href="#Using-Oculus-Rift-in-UE" class="headerlink" title="Using Oculus Rift in UE"></a>Using Oculus Rift in UE</h3><p>After installing the Oculus Rift device, you need to enable <code>Unknown Source</code> in the Oculus Store; otherwise, it cannot be previewed in UE.<br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/3380/oculus-rift-setting.webp"></p>
<p>The documentation page adapted for Oculus Rift in Unreal is: <a target="_blank" rel="noopener" href="https://docs.unrealengine.com/latest/INT/Platforms/Oculus/index.html">Developing for Oculus Rift</a>.</p>
<p>The official key operation introduction provided by Oculus:<br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/3380/Oculus-touch-controller-map.webp"></p>
<p>Additionally, key mapping for Oculus Rift in UE:<br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/3380/oculus-rift-key-mapping-on-ue4.webp"></p>
<h3 id="HTC-Vive-Key-Mapping"><a href="#HTC-Vive-Key-Mapping" class="headerlink" title="HTC Vive Key Mapping"></a>HTC Vive Key Mapping</h3><p>In comparison to the above Oculus Rift, here is a key mapping for HTC Vive:<br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/3380/htc-vive-key-mapping-on-ue4.webp"></p>
<h3 id="HTC-VIVE-Device-Setup"><a href="#HTC-VIVE-Device-Setup" class="headerlink" title="HTC VIVE Device Setup"></a>HTC VIVE Device Setup</h3><p><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/3380/Vive-Setting-01.webp"><br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/3380/Vive-Setting-02.webp"><br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/3380/Vive-Setting-03.webp"></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://support.steampowered.com/steamvr/HTC_Vive/">SteamVR Support - HTC Vive Installation Guide</a></li>
</ul>
<h3 id="SteamVR-2-0-Base-Stations"><a href="#SteamVR-2-0-Base-Stations" class="headerlink" title="SteamVR 2.0 Base Stations"></a>SteamVR 2.0 Base Stations</h3><p>HTC Vive Pro supports SteamVR 2.0 base stations, with a tracking range of 150° and 7 meters, and supports base station daisy chaining (up to 16) to achieve large space tracking solutions.<br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/3380/SteamVR/SteamVR2.0.webp"><br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/3380/SteamVR/SteamVR2.0-station-channel-configuration.webp"></p>
<p>Note: The second-generation base stations do not support the first-generation HTC Vive headset.</p>
<h3 id="Using-Proxifier-to-Route-Oculus-through-SS-Proxy"><a href="#Using-Proxifier-to-Route-Oculus-through-SS-Proxy" class="headerlink" title="Using Proxifier to Route Oculus through SS Proxy"></a>Using Proxifier to Route Oculus through SS Proxy</h3><p>Yesterday the company purchased an Oculus Rift device, and during the installation, a global proxy is needed. On Windows, I used Proxifier to route Oculus-related software through the proxy.<br>First, add the proxy in Proxifier:<br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/3380/proxifier-add-proxy-serves.webp"><br>Once the connection test is successful, you can proceed with the following operations.</p>
<p>After a successful connection, you can add a proxy rule. The processes related to Oculus programs are as follows; what we need to do is route these processes through the SS proxy:</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">OculusSetup.exe;OculusClient.exe;OVRServiceLauncher.exe;OVRServer_x64.exe;OculusVR.exe;OculusCompatCheck.exe;CompatToolCommandLine.exe;OculusLogGatherer.exe;OVRLibrarian.exe;oculus-driver.exe;OVRLibraryService.exe;oculus-overlays.exe;OVRRedistributableInstaller.exe;</span><br></pre></td></tr></table></figure>
<p>Fill in the above content in the <code>Application</code> text box, then select the local proxy port for SS routing.<br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/3380/proxifier-ocukus-proxy-setting.webp"></p>
<p>For other programs (such as foreign-made games, Steam, etc.), if you need to force them through the SS proxy, the same method applies.</p>
<h3 id="VR-Blurriness-Issue"><a href="#VR-Blurriness-Issue" class="headerlink" title="VR Blurriness Issue"></a>VR Blurriness Issue</h3><p>Because the default <a target="_blank" rel="noopener" href="https://docs.unrealengine.com/en-us/Resources/ContentExamples/PostProcessing/1_13">Screen Percentage</a> value in UE projects is very low, it can appear very blurry. However, increasing it directly can result in a severe frame rate drop.<br>Typically, setting it to under 200 provides good image quality. Below are the recommended values from UE (ideal values). The art team then needs to optimize the scene based on this to ensure a frame rate close to full.</p>
<p>For versions prior to 4.19 (excluding 4.19), the recommended ideal value for VR HMD (<strong>r.ScreenPercentage</strong>) is:</p>
<table>
<thead>
<tr>
<th align="center">DeviceType</th>
<th align="center">r.ScreenPercentage</th>
</tr>
</thead>
<tbody><tr>
<td align="center">Oculus Rift</td>
<td align="center">133</td>
</tr>
<tr>
<td align="center">HTC Vive</td>
<td align="center">140</td>
</tr>
<tr>
<td align="center">PSVR</td>
<td align="center">140</td>
</tr>
<tr>
<td align="center">GearVR</td>
<td align="center">120</td>
</tr>
<tr>
<td align="center">GoogleVR</td>
<td align="center">120</td>
</tr>
</tbody></table>
<p>In versions after 4.19, UE introduced <code>vr.PixelDensity</code>; with <code>r.ScreenPercentage</code> set to 100, standardized values can be used across different platform devices:</p>
<table>
<thead>
<tr>
<th align="center">DeviceType</th>
<th align="center">r.ScreenPercentage</th>
<th align="center">vr.PixelDensity</th>
</tr>
</thead>
<tbody><tr>
<td align="center">Oculus Rift</td>
<td align="center">100</td>
<td align="center">1</td>
</tr>
<tr>
<td align="center">HTC Vive</td>
<td align="center">100</td>
<td align="center">1</td>
</tr>
<tr>
<td align="center">PSVR</td>
<td align="center">100</td>
<td align="center">1</td>
</tr>
<tr>
<td align="center">GearVR</td>
<td align="center">100</td>
<td align="center">1</td>
</tr>
<tr>
<td align="center">GoogleVR</td>
<td align="center">100</td>
<td align="center">1</td>
</tr>
</tbody></table>
<blockquote>
<p>Lower values will perform faster but will be undersampled (more blurry) while values over 1 will perform slower and will supersample (extra sharp).</p>
</blockquote>
<p>This way, you can control display quality by adjusting the standardized value of <code>vr.PixelDensity</code>.<br>For a detailed introduction, refer to the link: <a target="_blank" rel="noopener" href="https://www.unrealengine.com/en-US/blog/significant-changes-coming-to-vr-resolution-settings-in-4-19">Significant Changes Coming To VR Resolution Settings in 4.19</a></p>
<h3 id="Solution-for-HTC-VIVE-Tracker-Fault-03"><a href="#Solution-for-HTC-VIVE-Tracker-Fault-03" class="headerlink" title="Solution for HTC VIVE Tracker Fault (03)"></a>Solution for HTC VIVE Tracker Fault (03)</h3><p>If the tracker panel flashes red and SteamVR shows <strong>Tracker Fault (03)</strong>, please try to manually flash the tracker (base station) firmware. The steps are as follows:<br>The firmware path is located under the Steam installation path: <code>Steam\steamapps\common\SteamVR\tools\lighthouse\firmware\lighthouse_tx\archive\htc_2.0</code>, locate the following two files:</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* lighthouse_tx_htc_2_0-calibration-rescue-244.bin</span><br><span class="line">* lighthouse_tx_htc_2_0-244-2016-03-12.bin</span><br></pre></td></tr></table></figure>
<ol>
<li>With the tracker (base station) powered off, connect it to the computer using a micro-B USB cable.</li>
<li>Press and hold the mode button on the back of the tracker (base station) and insert the power cable.</li>
<li>Once the computer confirms it as a USB mass storage device, you can release the mode button.</li>
<li>The connected tracker (base station) storage device will be named “CRP_DISABLED”. Open it and delete the file “firmware.bin”.</li>
<li>Copy the file “lighthouse_tx_htc_2_0-calibration-rescue-244.bin” to the base station’s storage.</li>
<li>After copying, unplug the power cable.</li>
<li>Wait a few seconds, and then plug the power back in. Do not press the mode button during this process. After a few seconds, the tracker (base station) should blink green or red quickly. A green light indicates successful recovery.</li>
<li>If it flashes red, it indicates it cannot fix automatically, please send it for repairs.</li>
<li>Unplug the power again.</li>
<li>Repeat steps 1 to 7, but in step 5, change the copied file to “lighthouse_tx_htc_2_0-244-2016-03-12.bin”.</li>
<li>Once complete, the tracker (base station) should return to normal; set its channel to “A” and track it individually (with the other base station powered off) to confirm functionality. Once confirmed to be working properly, turn on the other base station.</li>
</ol>
<p>If there is a flashing green light and it cannot be used normally, repeat steps 1 to 7, but in the fifth step, clear all files in “CRP_DISABLED” and only copy “lighthouse_tx_htc_2_0-244-2016-03-12.bin”.</p>
<ul>
<li>If manually flashing the tracker (base station) firmware and calibration still doesn’t work, please take a photo to ensure whether the two laser dots are functioning normally (an iPhone/iPad cannot capture laser dots). If either of these two laser dots does not show, it indicates laser damage, please send it for customer service inspection.</li>
</ul>
<p><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/3380/using-burn-bin-fix-htc-vive-red-light-flicker.webp"><br>Reference link: <a target="_blank" rel="noopener" href="https://www.vive.com/cn/forum/2632">Tracker Fault (03)</a></p>
<h2 id="Engine-Analysis"><a href="#Engine-Analysis" class="headerlink" title="Engine Analysis"></a>Engine Analysis</h2><h3 id="Starting-UE-Game"><a href="#Starting-UE-Game" class="headerlink" title="Starting UE Game"></a>Starting UE Game</h3><p>The game’s initialization starts from <code>UGameInstance::StartGameInstance</code>.<br>Called through <code>FEngineLoop::Init()</code>, it polymorphically calls <code>GEngine-&gt;Start()</code>, which then invokes <code>UGameEngine::Start()</code>’s <code>GameInstance-&gt;StartGameInstance();</code>:<br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/3380/UE-GameStart-GameInit-StartGameInstance.webp"></p>
<h3 id="Actor-Initialization-in-UE"><a href="#Actor-Initialization-in-UE" class="headerlink" title="Actor Initialization in UE"></a>Actor Initialization in UE</h3><p>The <code>PreInitializeComponents</code>/<code>InitializeComponents</code>/<code>PostInitializeComponents</code> and <code>DispatchBeginPlay</code> of AActor are all invoked in <a target="_blank" rel="noopener" href="http://api.unrealengine.com/INT/API/Runtime/Engine/Engine/ULevel/RouteActorInitialize/index.html">ULevel::RouteActorInitialize</a>.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">ULevel::RouteActorInitialize</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="comment">// Send PreInitializeComponents and collect volumes.</span></span><br><span class="line">  <span class="keyword">for</span>( int32 Index = <span class="number">0</span>; Index &lt; Actors.<span class="built_in">Num</span>(); ++Index )</span><br><span class="line">  &#123;</span><br><span class="line">    AActor* <span class="type">const</span> Actor = Actors[Index];</span><br><span class="line">    <span class="keyword">if</span>( Actor &amp;&amp; !Actor-&gt;<span class="built_in">IsActorInitialized</span>() )</span><br><span class="line">    &#123;</span><br><span class="line">      Actor-&gt;<span class="built_in">PreInitializeComponents</span>();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="type">const</span> <span class="type">bool</span> bCallBeginPlay = OwningWorld-&gt;<span class="built_in">HasBegunPlay</span>();</span><br><span class="line">  TArray&lt;AActor *&gt; ActorsToBeginPlay;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Send InitializeComponents on components and PostInitializeComponents.</span></span><br><span class="line">  <span class="keyword">for</span>( int32 Index = <span class="number">0</span>; Index &lt; Actors.<span class="built_in">Num</span>(); ++Index )</span><br><span class="line">  &#123;</span><br><span class="line">    AActor* <span class="type">const</span> Actor = Actors[Index];</span><br><span class="line">    <span class="keyword">if</span>( Actor )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>( !Actor-&gt;<span class="built_in">IsActorInitialized</span>() )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">// Call Initialize on Components.</span></span><br><span class="line">        Actor-&gt;<span class="built_in">InitializeComponents</span>();</span><br><span class="line"></span><br><span class="line">        Actor-&gt;<span class="built_in">PostInitializeComponents</span>(); <span class="comment">// should set Actor-&gt;bActorInitialized = true</span></span><br><span class="line">        <span class="keyword">if</span> (!Actor-&gt;<span class="built_in">IsActorInitialized</span>() &amp;&amp; !Actor-&gt;<span class="built_in">IsPendingKill</span>())</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="built_in">UE_LOG</span>(LogActor, Fatal, <span class="built_in">TEXT</span>(<span class="string">&quot;%s failed to route PostInitializeComponents.  Please call Super::PostInitializeComponents() in your &lt;className&gt;::PostInitializeComponents() function. &quot;</span>), *Actor-&gt;<span class="built_in">GetFullName</span>() );</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (bCallBeginPlay &amp;&amp; !Actor-&gt;<span class="built_in">IsChildActor</span>())</span><br><span class="line">        &#123;</span><br><span class="line">          ActorsToBeginPlay.<span class="built_in">Add</span>(Actor);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Components are all set up, init touching state.</span></span><br><span class="line">      <span class="comment">// Note: Not doing notifies here since loading or streaming in isn&#x27;t actually conceptually beginning a touch.</span></span><br><span class="line">      <span class="comment">//       Rather, it was always touching and the mechanics of loading is just an implementation detail.</span></span><br><span class="line">      Actor-&gt;<span class="built_in">UpdateOverlaps</span>(Actor-&gt;bGenerateOverlapEventsDuringLevelStreaming);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Do this in a second pass to make sure they&#x27;re all initialized before begin play starts</span></span><br><span class="line">  <span class="keyword">for</span> (int32 ActorIndex = <span class="number">0</span>; ActorIndex &lt; ActorsToBeginPlay.<span class="built_in">Num</span>(); ActorIndex++)</span><br><span class="line">  &#123;</span><br><span class="line">    AActor* Actor = ActorsToBeginPlay[ActorIndex];</span><br><span class="line">    <span class="built_in">SCOPE_CYCLE_COUNTER</span>(STAT_ActorBeginPlay);</span><br><span class="line">    Actor-&gt;<span class="built_in">DispatchBeginPlay</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="UE4-Engine-Start-Order"><a href="#UE4-Engine-Start-Order" class="headerlink" title="UE4: Engine Start Order"></a>UE4: Engine Start Order</h3><p><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/3380/UnrealEngineStartOrder.webp"></p>
<h3 id="UE-Engine-Tick-Call-Stack"><a href="#UE-Engine-Tick-Call-Stack" class="headerlink" title="UE Engine Tick Call Stack"></a>UE Engine Tick Call Stack</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">FEngineLoop_Tick=&gt;start: void FEngineLoop::Tick()</span><br><span class="line">UGameEngine_Tick=&gt;operation: void UGameEngine::Tick( float DeltaSeconds, bool bIdleMode )</span><br><span class="line">UWorld_Tick=&gt;operation: void UWorld::Tick( ELevelTick TickType, float DeltaSeconds)</span><br><span class="line">UWorld_RunTickGroup=&gt;operation: void UWorld::RunTickGroup(ETickingGroup Group, bool bBlockTillComplete = true)</span><br><span class="line">FTickTaskManager_RunTickGroup=&gt;operation: void FTickTaskManager::RunTickGroup(ETickingGroup Group, bool bBlockTillComplete )</span><br><span class="line">FTickTaskSequencer_ReleaseTickGroup=&gt;operation: void FTickTaskSequencer::ReleaseTickGroup(ETickingGroup WorldTickGroup, bool bBlockTillComplete)</span><br><span class="line">FTaskGraphImplementation_WaitUntilTaskComplete=&gt;operation: FTaskGraphImplementation::WaitUntilTaskComplete()</span><br><span class="line">FNamedTaskThread_ProcessTaskUntilQuit=&gt;operation: FNamedTaskThread::ProcessTaskUntilQuit()</span><br><span class="line">FNameTaskThread_ProcessTaskNamedThread=&gt;operation: FNameTaskThread::ProcessTaskNamedThread()</span><br><span class="line">FTaskGraphInterfaces_ExecuteTask=&gt;operation: FTaskGraphInterfaces::ExecuteTask()</span><br><span class="line">FTickFunction_DoTask=&gt;operation: FTickFunction::DoTask()</span><br><span class="line">DynamicExecFTickFunctionExecuteTick=&gt;condition: Polymorphism execute FTickFunction::ExecuteTask()</span><br><span class="line">AActor_Tick=&gt;subroutine: AActor</span><br><span class="line">AActor_Tick_FActorTickFunction_ExecuteTick=&gt;operation: FActorTickFunction::ExecuteTick()</span><br><span class="line">AActor_Tick_AActor_TickActor=&gt;operation: AActor::TickActor()</span><br><span class="line">AActor_Tick_AActor_Tick=&gt;operation: AActor::Tick()</span><br><span class="line">AActor_Tick_AActor_ReceiveTick=&gt;operation: AActor::ReceiveTick() // BpTick</span><br><span class="line"></span><br><span class="line">ActorComponent_Tick=&gt;subroutine: ActorComponent</span><br><span class="line">ActorComponent_Tick_FActorComponentTickFunction_ExecuteTick=&gt;operation: FActorComponentTickFunction::ExecuteTick()</span><br><span class="line">ActorComponent_Tick_FActorComponentTickFunction_ExecuteTickHelper=&gt;operation: FActorComponentTickFunction::ExecuteTickHelper()</span><br><span class="line">ActorComponent_Tick_UActorComponent_TickComponent=&gt;operation: UActorComponent::TickComponent()</span><br><span class="line">ActorComponent_Tick_ReceiveTick=&gt;operation: UActorComponent::ReceiveTick(DeltaTime) // BpTick</span><br><span class="line">end=&gt;end: End</span><br><span class="line"></span><br><span class="line">FEngineLoop_Tick-&gt;UGameEngine_Tick</span><br><span class="line">UGameEngine_Tick-&gt;UWorld_Tick</span><br><span class="line">UWorld_Tick-&gt;UWorld_RunTickGroup</span><br><span class="line">UWorld_RunTickGroup-&gt;FTickTaskManager_RunTickGroup</span><br><span class="line">FTickTaskManager_RunTickGroup-&gt;FTickTaskSequencer_ReleaseTickGroup</span><br><span class="line">FTickTaskSequencer_ReleaseTickGroup-&gt;FTaskGraphImplementation_WaitUntilTaskComplete</span><br><span class="line">FTaskGraphImplementation_WaitUntilTaskComplete-&gt;FNamedTaskThread_ProcessTaskUntilQuit</span><br><span class="line">FNamedTaskThread_ProcessTaskUntilQuit-&gt;FNameTaskThread_ProcessTaskNamedThread</span><br><span class="line">FNameTaskThread_ProcessTaskNamedThread-&gt;FTaskGraphInterfaces_ExecuteTask</span><br><span class="line">FTaskGraphInterfaces_ExecuteTask-&gt;FTickFunction_DoTask</span><br><span class="line">FTickFunction_DoTask-&gt;DynamicExecFTickFunctionExecuteTick</span><br><span class="line">DynamicExecFTickFunctionExecuteTick(yes,left)-&gt;AActor_Tick</span><br><span class="line">AActor_Tick-&gt;AActor_Tick_FActorTickFunction_ExecuteTick</span><br><span class="line">AActor_Tick_FActorTickFunction_ExecuteTick-&gt;AActor_Tick_AActor_TickActor</span><br><span class="line">AActor_Tick_AActor_TickActor-&gt;AActor_Tick_AActor_Tick</span><br><span class="line">AActor_Tick_AActor_Tick-&gt;AActor_Tick_AActor_ReceiveTick</span><br><span class="line">AActor_Tick_AActor_ReceiveTick-&gt;end</span><br><span class="line">DynamicExecFTickFunctionExecuteTick(no,right)-&gt;ActorComponent_Tick</span><br><span class="line">ActorComponent_Tick-&gt;ActorComponent_Tick_FActorComponentTickFunction_ExecuteTick</span><br><span class="line">ActorComponent_Tick_FActorComponentTickFunction_ExecuteTick-&gt;ActorComponent_Tick_FActorComponentTickFunction_ExecuteTickHelper</span><br><span class="line">ActorComponent_Tick_FActorComponentTickFunction_ExecuteTickHelper-&gt;ActorComponent_Tick_UActorComponent_TickComponent</span><br><span class="line">ActorComponent_Tick_UActorComponent_TickComponent-&gt;ActorComponent_Tick_ReceiveTick</span><br><span class="line">ActorComponent_Tick_ReceiveTick-&gt;end</span><br></pre></td></tr></table></figure>

<h3 id="Game-Flow-on-UE4"><a href="#Game-Flow-on-UE4" class="headerlink" title="Game Flow on UE4"></a>Game Flow on UE4</h3><p><a target="_blank" rel="noopener" href="https://docs.unrealengine.com/en-US/Gameplay/Framework/GameFlow">Game Flow Overview on UE4</a></p>
<p><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/3380/GameFlowChart.webp"></p>
<h3 id="Actor-LifeCycle"><a href="#Actor-LifeCycle" class="headerlink" title="Actor LifeCycle"></a>Actor LifeCycle</h3><p><a target="_blank" rel="noopener" href="https://docs.unrealengine.com/en-us/Programming/UnrealArchitecture/Actors/ActorLifecycle">Actor Lifecycle on Unreal Engine</a><br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/3380/ActorLifeCycle.webp"></p>
<h3 id="UE-Log-Macros-Defined"><a href="#UE-Log-Macros-Defined" class="headerlink" title="UE Log Macros Defined"></a>UE Log Macros Defined</h3><p>Some log definitions in UE source code:<br>These logs are defined in <a target="_blank" rel="noopener" href="https://github.com/EpicGames/UnrealEngine/blob/release/Engine/Source/Runtime/Engine/Public/EngineLogs.h">EngineLogs.h</a>:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ENGINE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogPath, Warning, All)</span></span>;</span><br><span class="line"><span class="function">ENGINE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogPhysics, Warning, All)</span></span>;</span><br><span class="line"><span class="function">ENGINE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogBlueprint, Warning, All)</span></span>;</span><br><span class="line"><span class="function">ENGINE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogBlueprintUserMessages, Log, All)</span></span>;</span><br><span class="line"><span class="function">ENGINE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogAnimation, Warning, All)</span></span>;</span><br><span class="line"><span class="function">ENGINE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogRootMotion, Warning, All)</span></span>;</span><br><span class="line"><span class="function">ENGINE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogLevel, Log, All)</span></span>;</span><br><span class="line"><span class="function">ENGINE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogSkeletalMesh, Log, All)</span></span>;</span><br><span class="line"><span class="function">ENGINE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogStaticMesh, Log, All)</span></span>;</span><br><span class="line"><span class="function">ENGINE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogNet, Log, All)</span></span>;</span><br><span class="line"><span class="function">ENGINE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogRep, Log, All)</span></span>;</span><br><span class="line"><span class="function">ENGINE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogNetPlayerMovement, Warning, All)</span></span>;</span><br><span class="line"><span class="function">ENGINE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogNetTraffic, Warning, All)</span></span>;</span><br><span class="line"><span class="function">ENGINE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogRepTraffic, Warning, All)</span></span>;</span><br><span class="line"><span class="function">ENGINE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogNetFastTArray, Warning, All)</span></span>;</span><br><span class="line"><span class="function">ENGINE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogNetDormancy, Warning, All)</span></span>;</span><br><span class="line"><span class="function">ENGINE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogSkeletalControl, Warning, All)</span></span>;</span><br><span class="line"><span class="function">ENGINE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogSubtitle, Log, All)</span></span>;</span><br><span class="line"><span class="function">ENGINE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogTexture, Log, All)</span></span>;</span><br><span class="line"><span class="function">ENGINE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogPlayerManagement, Error, All)</span></span>;</span><br><span class="line"><span class="function">ENGINE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogSecurity, Warning, All)</span></span>;</span><br><span class="line"><span class="function">ENGINE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogEngineSessionManager, Log, All)</span></span>;</span><br></pre></td></tr></table></figure>

<p>In <a target="_blank" rel="noopener" href="https://github.com/EpicGames/UnrealEngine/blob/release/Engine/Source/Runtime/Core/Public/CoreGlobals.h">CoreGlobals.h</a>, the following logs are defined:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">CORE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogHAL, Log, All)</span></span>;</span><br><span class="line"><span class="function">CORE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogMac, Log, All)</span></span>;</span><br><span class="line"><span class="function">CORE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogLinux, Log, All)</span></span>;</span><br><span class="line"><span class="function">CORE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogIOS, Log, All)</span></span>;</span><br><span class="line"><span class="function">CORE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogAndroid, Log, All)</span></span>;</span><br><span class="line"><span class="function">CORE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogPS4, Log, All)</span></span>;</span><br><span class="line"><span class="function">CORE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogXboxOne, Log, All)</span></span>;</span><br><span class="line"><span class="function">CORE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogWindows, Log, All)</span></span>;</span><br><span class="line"><span class="function">CORE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogSwitch, Log, All)</span></span>;</span><br><span class="line"><span class="function">CORE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogQuail, Log, All)</span></span>;</span><br><span class="line"><span class="function">CORE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogSerialization, Log, All)</span></span>;</span><br><span class="line"><span class="function">CORE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogUnrealMath, Log, All)</span></span>;</span><br><span class="line"><span class="function">CORE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogUnrealMatrix, Log, All)</span></span>;</span><br><span class="line"><span class="function">CORE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogContentComparisonCommandlet, Log, All)</span></span>;</span><br><span class="line"><span class="function">CORE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogNetPackageMap, Warning, All)</span></span>;</span><br><span class="line"><span class="function">CORE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogNetSerialization, Warning, All)</span></span>;</span><br><span class="line"><span class="function">CORE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogMemory, Log, All)</span></span>;</span><br><span class="line"><span class="function">CORE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogProfilingDebugging, Log, All)</span></span>;</span><br><span class="line"><span class="function">CORE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogCore, Log, All)</span></span>;</span><br><span class="line"><span class="function">CORE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogOutputDevice, Log, All)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function">CORE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogSHA, Warning, All)</span></span>;</span><br><span class="line"><span class="function">CORE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogStats, Log, All)</span></span>;</span><br><span class="line"><span class="function">CORE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogStreaming, Display, All)</span></span>;</span><br><span class="line"><span class="function">CORE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogInit, Log, All)</span></span>;</span><br><span class="line"><span class="function">CORE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogExit, Log, All)</span></span>;</span><br><span class="line"><span class="function">CORE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogExec, Warning, All)</span></span>;</span><br><span class="line"><span class="function">CORE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogScript, Warning, All)</span></span>;</span><br><span class="line"><span class="function">CORE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogLocalization, Error, All)</span></span>;</span><br><span class="line"><span class="function">CORE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogLongPackageNames, Log, All)</span></span>;</span><br><span class="line"><span class="function">CORE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogProcess, Log, All)</span></span>;</span><br><span class="line"><span class="function">CORE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogLoad, Log, All)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Temporary log category, generally you should not check things that use this</span></span><br><span class="line"><span class="function">CORE_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogTemp, Log, All)</span></span>;</span><br></pre></td></tr></table></figure>
<p>Some log definitions recently used are pasted here:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Module: Json</span></span><br><span class="line"><span class="comment">// File: Runtime/Json/Public/JsonGlobals.h</span></span><br><span class="line"><span class="function">JSON_API <span class="title">DECLARE_LOG_CATEGORY_EXTERN</span><span class="params">(LogJson, Log, All)</span></span>;</span><br></pre></td></tr></table></figure>
<h3 id="Method-to-Detect-if-Engine-is-Installed-Version"><a href="#Method-to-Detect-if-Engine-is-Installed-Version" class="headerlink" title="Method to Detect if Engine is Installed Version"></a>Method to Detect if Engine is Installed Version</h3><p>The engine version installed via EpicGameLauncher cannot create a Target <code>Program</code> project using <code>UnrealBuildTool.exe -ProjectFiles &quot;ProgramProjectName&quot;</code>, and it will prompt the following error:</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ERROR: UnrealBuildTool Exception: A game project path was not specified, which is required when generating project files using an installed build or passing -game on the command line</span><br></pre></td></tr></table></figure>
<p>This exception in UBT’s related code is in <code>ProjectFileGenreator.cs</code>:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ProjectFileGenreator.cs</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">ConfigureProjectFileGeneration</span>(<span class="params"> String[] Arguments, <span class="keyword">ref</span> <span class="built_in">bool</span> IncludeAllPlatforms </span>)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">switch</span>( CurArgument.ToUpperInvariant() )</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">// ...</span></span><br><span class="line">		<span class="keyword">case</span> <span class="string">&quot;-GAME&quot;</span>:</span><br><span class="line">			<span class="comment">// Generates project files for a single game</span></span><br><span class="line">			bGeneratingGameProjectFiles = <span class="literal">true</span>;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="comment">// ...</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>( bGeneratingGameProjectFiles || UnrealBuildTool.IsEngineInstalled() )</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (OnlyGameProject == <span class="literal">null</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> BuildException(<span class="string">&quot;A game project path was not specified, which is required when generating project files using an installed build or passing -game on the command line&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		GameProjectName = OnlyGameProject.GetFileNameWithoutExtension();</span><br><span class="line">		<span class="keyword">if</span> (String.IsNullOrEmpty(GameProjectName))</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">throw</span> <span class="keyword">new</span> BuildException(<span class="string">&quot;A valid game project was not found in the specified location (&quot;</span> + OnlyGameProject.Directory.FullName + <span class="string">&quot;)&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">bool</span> bInstalledEngineWithSource = UnrealBuildTool.IsEngineInstalled() &amp;&amp; DirectoryReference.Exists(UnrealBuildTool.EngineSourceDirectory);</span><br><span class="line"></span><br><span class="line">		bIncludeEngineSource = bAlwaysIncludeEngineModules || bInstalledEngineWithSource;</span><br><span class="line">		bIncludeDocumentation = <span class="literal">false</span>;</span><br><span class="line">		bIncludeBuildSystemFiles = <span class="literal">false</span>;</span><br><span class="line">		bIncludeShaderSource = <span class="literal">true</span>;</span><br><span class="line">		bIncludeTemplateFiles = <span class="literal">false</span>;</span><br><span class="line">		bIncludeConfigFiles = <span class="literal">true</span>;</span><br><span class="line">		IncludeEnginePrograms = bAlwaysIncludeEngineModules;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>From this code, it can be seen that if the <code>-game</code> parameter is passed to UBT and the engine is an installed version (EpicGameLauncher), it will check if the <code>project</code> parameter is provided; if not, it will throw an exception.<br>The normal UBT call command is:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UnrelBuildTool.exe -ProjectFiles -project=&quot;D:\UnrealProjects\UEProject.uproject&quot; -game</span><br></pre></td></tr></table></figure>
<p>This ordinary Game parameter will not throw an exception in UBT. However, calling UBT with the command to generate Program will throw an exception:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UnrelBuildTool.exe -ProjectFiles ProgramName</span><br></pre></td></tr></table></figure>
<p>According to the above <code>ProjectFileGenreator.cs</code> detection code, what we need to do is change the result returned by <code>UnrealBuildTool.IsEngineInstalled()</code> to false.<br>Continuing with the code, <code>UnrealBuildTool.IsEngineInstalled()</code> retrieves a bool variable <code>bIsEngineInstalled</code> in <code>UnrealBuildTool</code>:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// UnrealBuildTool.cs</span></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">public</span> <span class="built_in">bool</span> <span class="title">IsEngineInstalled</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">if</span> (!bIsEngineInstalled.HasValue)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">throw</span> <span class="keyword">new</span> BuildException(<span class="string">&quot;IsEngineInstalled() called before being initialized.&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> bIsEngineInstalled.Value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>A search for references reveals that the <code>bIsEngineInstalled</code> variable is set in <code>GuardedMain</code>:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// UnrealBuildTool.cs</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="built_in">int</span> <span class="title">GuardedMain</span>(<span class="params"><span class="built_in">string</span>[] Arguments</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	<span class="keyword">try</span>&#123;</span><br><span class="line">		<span class="comment">// ...</span></span><br><span class="line">		<span class="keyword">foreach</span> (<span class="built_in">string</span> Argument <span class="keyword">in</span> Arguments)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">string</span> LowercaseArg = Argument.ToLowerInvariant();</span><br><span class="line">			<span class="keyword">if</span> (LowercaseArg == <span class="string">&quot;-installed&quot;</span> || LowercaseArg == <span class="string">&quot;-installedengine&quot;</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				bIsEngineInstalled = <span class="literal">true</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (LowercaseArg == <span class="string">&quot;-notinstalledengine&quot;</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				bIsEngineInstalled = <span class="literal">false</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (!bIsEngineInstalled.HasValue)</span><br><span class="line">		&#123;</span><br><span class="line">			bIsEngineInstalled = FileReference.Exists(FileReference.Combine(RootDirectory, <span class="string">&quot;Engine&quot;</span>, <span class="string">&quot;Build&quot;</span>, <span class="string">&quot;InstalledBuild.txt&quot;</span>));</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">// ...</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>From the code, we can see that UBT has three methods to determine whether the engine version is installed:</p>
<ol>
<li>Check if the parameters passed include <code>-installled</code> and <code>-installedengine</code></li>
<li>Check if the parameters passed include <code>-notinstallengine</code></li>
<li>Check if the engine path contains the <code>InstalledBuild.txt</code> file under <code>Engine\Build</code></li>
</ol>
<p>(So there are actually three methods but effectively two; even if <code>-notinstallengine</code> is specified, it still needs to check for the existence of the <code>Engine\Build\InstalledBuild.txt</code> file.)<br>The detection order is as follows:</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-installled &gt; -installedengine &gt; -notinstalledengine &gt; Engine\Build\InstalledBuild.txt</span><br></pre></td></tr></table></figure>
<p>Therefore, when I want UBT to consider my engine version as not installed, there are two ways:</p>
<ol>
<li>Pass the <code>-notinstalledengine</code> parameter to UBT and delete the <code>InstalledBuild.txt</code> file from the <code>Engine\Build</code> directory.</li>
<li>Call UBT without passing <code>-installled</code> and <code>-installedengine</code> parameters, and delete the <code>InstalledBuild.txt</code> file from the <code>Engine\Build</code> directory.</li>
</ol>
<p><strong>Note</strong>: There are also the following two checks in UBT:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// UnrealBuildTools.cs</span></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">public</span> <span class="built_in">bool</span> <span class="title">IsEnterpriseInstalled</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">if</span>(!bIsEnterpriseInstalled.HasValue)</span><br><span class="line">	&#123;</span><br><span class="line">		bIsEnterpriseInstalled = FileReference.Exists(FileReference.Combine(EnterpriseDirectory, <span class="string">&quot;Build&quot;</span>, <span class="string">&quot;InstalledBuild.txt&quot;</span>));</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> bIsEnterpriseInstalled.Value;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">public</span> <span class="built_in">bool</span> <span class="title">IsProjectInstalled</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">if</span> (!bIsProjectInstalled.HasValue)</span><br><span class="line">	&#123;</span><br><span class="line">		bIsProjectInstalled = FileReference.Exists(FileReference.Combine(RootDirectory, <span class="string">&quot;Engine&quot;</span>, <span class="string">&quot;Build&quot;</span>, <span class="string">&quot;InstalledProjectBuild.txt&quot;</span>));</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> bIsProjectInstalled.Value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="UE-Get-all-registered-Engines"><a href="#UE-Get-all-registered-Engines" class="headerlink" title="UE:Get all registered Engines"></a>UE:Get all registered Engines</h3><p>You can use <code>IDesktopPlatform::EnumerateEngineInstallations</code> to obtain all engine versions installed from the launcher, and those registered by the user using <code>UnrealVersionSelector</code> in the current system.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">TMap&lt;FString,FString&gt; Installations;</span><br><span class="line">FDesktopPlatformModule::<span class="built_in">Get</span>()-&gt;<span class="built_in">EnumerateEngineInstallations</span>(Installations)</span><br></pre></td></tr></table></figure>

<h3 id="UnrealVersionSelector-Registered-Engine-Path"><a href="#UnrealVersionSelector-Registered-Engine-Path" class="headerlink" title="UnrealVersionSelector Registered Engine Path"></a>UnrealVersionSelector Registered Engine Path</h3><p>When registering an engine using UnrealVersionSelector, it will write the registered engine path into the registry:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HKEY_CURRENT_USER\SOFTWARE\Epic Games\Unreal Engine\Builds</span><br></pre></td></tr></table></figure>
<p>The registry entry’s <code>lpValueName</code> will be a generated GUID:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// DesktopPlatfromWindows.cpp</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">FDesktopPlatformWindows::RegisterEngineInstallation</span><span class="params">(<span class="type">const</span> FString &amp;RootDir, FString &amp;OutIdentifier)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">bool</span> bRes = <span class="literal">false</span>;</span><br><span class="line">  <span class="keyword">if</span>(<span class="built_in">IsValidRootDirectory</span>(RootDir))</span><br><span class="line">  &#123;</span><br><span class="line">    HKEY hRootKey;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">RegCreateKeyEx</span>(HKEY_CURRENT_USER, InstallationsSubKey, <span class="number">0</span>, <span class="literal">NULL</span>, REG_OPTION_NON_VOLATILE, KEY_ALL_ACCESS, <span class="literal">NULL</span>, &amp;hRootKey, <span class="literal">NULL</span>) == ERROR_SUCCESS)</span><br><span class="line">    &#123;</span><br><span class="line">      FString NewIdentifier = FGuid::<span class="built_in">NewGuid</span>().<span class="built_in">ToString</span>(EGuidFormats::DigitsWithHyphensInBraces);</span><br><span class="line">      LRESULT SetResult = <span class="built_in">RegSetValueEx</span>(hRootKey, *NewIdentifier, <span class="number">0</span>, REG_SZ, (<span class="type">const</span> BYTE*)*RootDir, (RootDir.<span class="built_in">Len</span>() + <span class="number">1</span>) * <span class="built_in">sizeof</span>(TCHAR));</span><br><span class="line">      <span class="built_in">RegCloseKey</span>(hRootKey);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span>(SetResult == ERROR_SUCCESS)</span><br><span class="line">      &#123;</span><br><span class="line">        OutIdentifier = NewIdentifier;</span><br><span class="line">        bRes = <span class="literal">true</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> bRes;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>UE does not directly provide an API in <code>IDesktopPlatfrom</code> for obtaining the list of engines registered by users through the UnrealVersionSelector.<br>However, it writes the function to obtain <code>per-user installations</code> engines from the registry in <code>EnumerateEngineInstallations</code>:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">FDesktopPlatformWindows::EnumerateEngineInstallations</span><span class="params">(TMap&lt;FString, FString&gt; &amp;OutInstallations)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="comment">// Enumerate the binary installations</span></span><br><span class="line">  <span class="built_in">EnumerateLauncherEngineInstallations</span>(OutInstallations);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Enumerate the per-user installations</span></span><br><span class="line">  HKEY hKey;</span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">RegOpenKeyEx</span>(HKEY_CURRENT_USER, InstallationsSubKey, <span class="number">0</span>, KEY_ALL_ACCESS, &amp;hKey) == ERROR_SUCCESS)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// Get a list of all the directories</span></span><br><span class="line">    TArray&lt;FString&gt; UniqueDirectories;</span><br><span class="line">    OutInstallations.<span class="built_in">GenerateValueArray</span>(UniqueDirectories);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Enumerate all the installations</span></span><br><span class="line">    TArray&lt;FString&gt; InvalidKeys;</span><br><span class="line">    <span class="keyword">for</span> (::DWORD Index = <span class="number">0</span>;; Index++)</span><br><span class="line">    &#123;</span><br><span class="line">      TCHAR ValueName[<span class="number">256</span>];</span><br><span class="line">      TCHAR ValueData[MAX_PATH];</span><br><span class="line">      ::DWORD ValueType = <span class="number">0</span>;</span><br><span class="line">      ::DWORD ValueNameLength = <span class="built_in">sizeof</span>(ValueName) / <span class="built_in">sizeof</span>(ValueName[<span class="number">0</span>]);</span><br><span class="line">      ::DWORD ValueDataSize = <span class="built_in">sizeof</span>(ValueData);</span><br><span class="line"></span><br><span class="line">      LRESULT Result = <span class="built_in">RegEnumValue</span>(hKey, Index, ValueName, &amp;ValueNameLength, <span class="literal">NULL</span>, &amp;ValueType, (BYTE*)&amp;ValueData[<span class="number">0</span>], &amp;ValueDataSize);</span><br><span class="line">      <span class="keyword">if</span>(Result == ERROR_SUCCESS)</span><br><span class="line">      &#123;</span><br><span class="line">        int32 ValueDataLength = ValueDataSize / <span class="built_in">sizeof</span>(TCHAR);</span><br><span class="line">        <span class="keyword">if</span>(ValueDataLength &gt; <span class="number">0</span> &amp;&amp; ValueData[ValueDataLength - <span class="number">1</span>] == <span class="number">0</span>) ValueDataLength--;</span><br><span class="line"></span><br><span class="line">        <span class="function">FString <span class="title">NormalizedInstalledDirectory</span><span class="params">(ValueDataLength, ValueData)</span></span>;</span><br><span class="line">        FPaths::<span class="built_in">NormalizeDirectoryName</span>(NormalizedInstalledDirectory);</span><br><span class="line">        FPaths::<span class="built_in">CollapseRelativeDirectories</span>(NormalizedInstalledDirectory);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">IsValidRootDirectory</span>(NormalizedInstalledDirectory) &amp;&amp; !UniqueDirectories.<span class="built_in">Contains</span>(NormalizedInstalledDirectory))</span><br><span class="line">        &#123;</span><br><span class="line">          OutInstallations.<span class="built_in">Add</span>(ValueName, NormalizedInstalledDirectory);</span><br><span class="line">          UniqueDirectories.<span class="built_in">Add</span>(NormalizedInstalledDirectory);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">          InvalidKeys.<span class="built_in">Add</span>(ValueName);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span> <span class="keyword">if</span>(Result == ERROR_NO_MORE_ITEMS)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Remove all the keys which weren&#x27;t valid</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">const</span> FString InvalidKey: InvalidKeys)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">RegDeleteValue</span>(hKey, *InvalidKey);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">RegCloseKey</span>(hKey);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="EpicGameLauncher-Version-Engine-Registry-Path"><a href="#EpicGameLauncher-Version-Engine-Registry-Path" class="headerlink" title="EpicGameLauncher Version Engine Registry Path"></a>EpicGameLauncher Version Engine Registry Path</h3><p>It was mentioned above that if the engine is a non-source version, the registered paths will be written into the registry when using UnrealVersionSelector:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HKEY_CURRENT_USER\SOFTWARE\Epic Games\Unreal Engine\Builds</span><br></pre></td></tr></table></figure>
<p>The versions installed from EpicGameLauncher will be written to another registry path:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HKEY_LOCAL_MACHINE\SOFTWARE\EpicGames\Unreal Engine</span><br></pre></td></tr></table></figure>
<p>Its value (exported from the registry) is:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Windows Registry Editor Version 5.00</span><br><span class="line"></span><br><span class="line">[HKEY_LOCAL_MACHINE\SOFTWARE\EpicGames\Unreal Engine\4.18]</span><br><span class="line">&quot;InstalledDirectory&quot;=&quot;C:\\Program Files\\Epic Games\\UE_4.18&quot;</span><br></pre></td></tr></table></figure>

<p>UE provides a method to obtain engines installed from EpicGameLauncher (via the <code>IDesktopPlatfrom</code> interface):</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">TMap&lt;FString,FString&gt; Installations;</span><br><span class="line">FDesktopPlatformModule::<span class="built_in">Get</span>()-&gt;<span class="built_in">EnumerateLauncherEngineInstallations</span>(OutInstallations);</span><br></pre></td></tr></table></figure>

<h3 id="UnrealVersionSelector-Registry-File-Association"><a href="#UnrealVersionSelector-Registry-File-Association" class="headerlink" title="UnrealVersionSelector Registry File Association"></a>UnrealVersionSelector Registry File Association</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">Windows Registry Editor Version 5.00</span><br><span class="line"></span><br><span class="line">[HKEY_CLASSES_ROOT\.uproject]</span><br><span class="line">@=&quot;Unreal.ProjectFile&quot;</span><br><span class="line"></span><br><span class="line">[HKEY_CLASSES_ROOT\Unreal.ProjectFile]</span><br><span class="line">@=&quot;Unreal Engine Project File&quot;</span><br><span class="line"></span><br><span class="line">[HKEY_CLASSES_ROOT\Unreal.ProjectFile\DefaultIcon]</span><br><span class="line">@=&quot;\&quot;C:\\Program Files (x86)\\Epic Games\\Launcher\\Engine\\Binaries\\Win64\\UnrealVersionSelector.exe\&quot;&quot;</span><br><span class="line"></span><br><span class="line">[HKEY_CLASSES_ROOT\Unreal.ProjectFile\shell]</span><br><span class="line"></span><br><span class="line">[HKEY_CLASSES_ROOT\Unreal.ProjectFile\shell\open]</span><br><span class="line">@=&quot;Open&quot;</span><br><span class="line"></span><br><span class="line">[HKEY_CLASSES_ROOT\Unreal.ProjectFile\shell\open\command]</span><br><span class="line">@=&quot;\&quot;C:\\Program Files (x86)\\Epic Games\\Launcher\\Engine\\Binaries\\Win64\\UnrealVersionSelector.exe\&quot; /editor \&quot;%1\&quot;&quot;</span><br><span class="line"></span><br><span class="line">[HKEY_CLASSES_ROOT\Unreal.ProjectFile\shell\run]</span><br><span class="line">@=&quot;Launch game&quot;</span><br><span class="line">&quot;Icon&quot;=&quot;\&quot;C:\\Program Files (x86)\\Epic Games\\Launcher\\Engine\\Binaries\\Win64\\UnrealVersionSelector.exe\&quot;&quot;</span><br><span class="line"></span><br><span class="line">[HKEY_CLASSES_ROOT\Unreal.ProjectFile\shell\run\command]</span><br><span class="line">@=&quot;\&quot;C:\\Program Files (x86)\\Epic Games\\Launcher\\Engine\\Binaries\\Win64\\UnrealVersionSelector.exe\&quot; /game \&quot;%1\&quot;&quot;</span><br><span class="line"></span><br><span class="line">[HKEY_CLASSES_ROOT\Unreal.ProjectFile\shell\rungenproj]</span><br><span class="line">@=&quot;Generate Visual Studio project files&quot;</span><br><span class="line">&quot;Icon&quot;=&quot;\&quot;C:\\Program Files (x86)\\Epic Games\\Launcher\\Engine\\Binaries\\Win64\\UnrealVersionSelector.exe\&quot;&quot;</span><br><span class="line"></span><br><span class="line">[HKEY_CLASSES_ROOT\Unreal.ProjectFile\shell\rungenproj\command]</span><br><span class="line">@=&quot;\&quot;C:\\Program Files (x86)\\Epic Games\\Launcher\\Engine\\Binaries\\Win64\\UnrealVersionSelector.exe\&quot; /projectfiles \&quot;%1\&quot;&quot;</span><br><span class="line"></span><br><span class="line">[HKEY_CLASSES_ROOT\Unreal.ProjectFile\shell\switchversion]</span><br><span class="line">@=&quot;Switch Unreal Engine version...&quot;</span><br><span class="line">&quot;Icon&quot;=&quot;\&quot;C:\\Program Files (x86)\\Epic Games\\Launcher\\Engine\\Binaries\\Win64\\UnrealVersionSelector.exe\&quot;&quot;</span><br><span class="line"></span><br><span class="line">[HKEY_CLASSES_ROOT\Unreal.ProjectFile\shell\switchversion\command]</span><br><span class="line">@=&quot;\&quot;C:\\Program Files (x86)\\Epic Games\\Launcher\\Engine\\Binaries\\Win64\\UnrealVersionSelector.exe\&quot; /switchversion \&quot;%1\&quot;&quot;</span><br></pre></td></tr></table></figure>

<p>Note: If you want to add launch methods for your defined files, you can use this method.</p>
<h3 id="UE-Registered-Compiled-Engine-Installation-Path"><a href="#UE-Registered-Compiled-Engine-Installation-Path" class="headerlink" title="UE Registered Compiled Engine Installation Path"></a>UE Registered Compiled Engine Installation Path</h3><p>UE provides the <code>UnrealVersionSelector</code> tool to select engine versions/generate sln, etc., which can also be used to register local engines (non-Launcher installed, such as self-compiled source engines) into the right-click <code>Select Unreal Engine Version...</code> list in the project file.<br>A simple analysis of the <code>UnrealVersionSelector</code> code shows its registration process as follows:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">WinMain_Func=&gt;start: WinMain</span><br><span class="line">Main_Func=&gt;operation: Main(Arguments)</span><br><span class="line">RegisterCurrentEngineDirectoryWithPrompt_Func=&gt;operation: RegisterCurrentEngineDirectoryWithPrompt()</span><br><span class="line">RegisterCurrentEngineDirectory_Func=&gt;operation: RegisterCurrentEngineDirectory(false)</span><br><span class="line">GetEngineIdentifierFromRootDir_Func=&gt;operation: FDesktopPlatformModule::Get()-&gt;GetEngineIdentifierFromRootDir(EngineRootDir, Identifier)</span><br><span class="line">RegisterEngineInstallation_Func=&gt;operation: RegisterEngineInstallation(RootDir, OutIdentifier)</span><br><span class="line">end=&gt;end: End</span><br><span class="line"></span><br><span class="line">WinMain_Func-&gt;Main_Func</span><br><span class="line">Main_Func-&gt;RegisterCurrentEngineDirectoryWithPrompt_Func</span><br><span class="line">RegisterCurrentEngineDirectoryWithPrompt_Func-&gt;RegisterCurrentEngineDirectory_Func</span><br><span class="line">RegisterCurrentEngineDirectory_Func-&gt;GetEngineIdentifierFromRootDir_Func</span><br><span class="line">GetEngineIdentifierFromRootDir_Func-&gt;RegisterEngineInstallation_Func</span><br><span class="line">RegisterEngineInstallation_Func-&gt;end</span><br></pre></td></tr></table></figure>
<p>The operation of writing to the registry is in the <code>FDesktopPlatformWindows::RegisterEngineInstallation</code> function.<br>The operation is to write the registered engine directory into a string item in <code>HKEY_CURRENT_USER\Software\Epic Games\Unreal Engine\Builds</code>.<br>When right-clicking <code>Switch Unreal Engine Version...</code>, it will modify the <code>.uproject</code> file’s <code>EngineAssociation</code> value:</p>
<p>The call flow is as follows:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">WinMain_Func=&gt;start: WinMain</span><br><span class="line">Main_Func=&gt;operation: Main(Arguments)</span><br><span class="line">SwitchVersion_Func=&gt;operation: SwitchVersion(const FString&amp; ProjectFileName)</span><br><span class="line">GetEngineIdentifierForProject_fUNC=&gt;operation: FDesktopPlatformModule::Get()-&gt;GetEngineIdentifierForProject(ProjectFileName, Identifier) // Get the currently selected engine</span><br><span class="line">SelectEngineInstallation_Func=&gt;operation: FPlatformInstallation::SelectEngineInstallation(Identifier) // Popup select engine list box; current selection is default</span><br><span class="line">SetEngineIdentifierForProject_func=&gt;operation: FDesktopPlatformModule::Get()-&gt;SetEngineIdentifierForProject(ProjectFileName, Identifier) // Set the selected engine and write to uproject file</span><br><span class="line">ContentOnly=&gt;condition: Is Content Only Project?</span><br><span class="line">GenerateProjectFiles_func=&gt;operation: GenerateProjectFiles(ProjectFileName)</span><br><span class="line">end=&gt;end: End</span><br><span class="line"></span><br><span class="line">WinMain_Func-&gt;Main_Func</span><br><span class="line">Main_Func-&gt;SwitchVersion_Func</span><br><span class="line">SwitchVersion_Func-&gt;GetEngineIdentifierForProject_fUNC</span><br><span class="line">GetEngineIdentifierForProject_fUNC-&gt;SelectEngineInstallation_Func</span><br><span class="line">SelectEngineInstallation_Func-&gt;SetEngineIdentifierForProject_func</span><br><span class="line">SetEngineIdentifierForProject_func-&gt;ContentOnly</span><br><span class="line">ContentOnly(yes)-&gt;end</span><br><span class="line">ContentOnly(no)-&gt;GenerateProjectFiles_func</span><br><span class="line">GenerateProjectFiles_func-&gt;end</span><br></pre></td></tr></table></figure>
<p>The execution of writing the project file operation is in <code>FDesktopPlatformBase::SetEngineIdentifierForProject</code>:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">FDesktopPlatformBase::SetEngineIdentifierForProject</span><span class="params">(<span class="type">const</span> FString &amp;ProjectFileName, <span class="type">const</span> FString &amp;InIdentifier)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="comment">// Load the project file</span></span><br><span class="line">  TSharedPtr&lt;FJsonObject&gt; ProjectFile = <span class="built_in">LoadProjectFile</span>(ProjectFileName);</span><br><span class="line">  <span class="keyword">if</span> (!ProjectFile.<span class="built_in">IsValid</span>())</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Check if the project is a non-foreign project of the given engine installation. If so, blank the identifier </span></span><br><span class="line">  <span class="comment">// string to allow portability between source control databases. GetEngineIdentifierForProject will translate</span></span><br><span class="line">  <span class="comment">// the association back into a local identifier on other machines or syncs.</span></span><br><span class="line">  FString Identifier = InIdentifier;</span><br><span class="line">  <span class="keyword">if</span>(Identifier.<span class="built_in">Len</span>() &gt; <span class="number">0</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    FString RootDir;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">GetEngineRootDirFromIdentifier</span>(Identifier, RootDir))</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">const</span> FUProjectDictionary &amp;Dictionary = <span class="built_in">GetCachedProjectDictionary</span>(RootDir);</span><br><span class="line">      <span class="keyword">if</span>(!Dictionary.<span class="built_in">IsForeignProject</span>(ProjectFileName))</span><br><span class="line">      &#123;</span><br><span class="line">        Identifier.<span class="built_in">Empty</span>();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Set the association on the project and save it</span></span><br><span class="line">  ProjectFile-&gt;<span class="built_in">SetStringField</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;EngineAssociation&quot;</span>), Identifier);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">SaveProjectFile</span>(ProjectFileName, ProjectFile);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>So if you choose a project that uses a compiled engine, you can open the project’s <code>.uproject</code> file with a text editor and see that the value of the <code>EngineAssociation</code> item is the version value of the engine from the registry.<br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/3380/Unreal-Select-Engine-Version.webp"></p>
<p>Note: The command line arguments supported by <a target="_blank" rel="noopener" href="https://github.com/EpicGames/UnrealEngine/blob/4.18/Engine/Source/Programs/UnrealVersionSelector/">UnrealVersionSelector</a> and their purposes can be found in <a target="_blank" rel="noopener" href="https://github.com/EpicGames/UnrealEngine/blob/4.18/Engine/Source/Programs/UnrealVersionSelector/Private/UnrealVersionSelector.cpp#L224">UnrealVersionSelector.cpp#L224</a>:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">Main</span><span class="params">(<span class="type">const</span> TArray&lt;FString&gt;&amp; Arguments)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">bool</span> bRes = <span class="literal">false</span>;</span><br><span class="line">  <span class="keyword">if</span> (Arguments.<span class="built_in">Num</span>() == <span class="number">0</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// Add the current directory to the list of installations</span></span><br><span class="line">    bRes = <span class="built_in">RegisterCurrentEngineDirectoryWithPrompt</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (Arguments.<span class="built_in">Num</span>() == <span class="number">1</span> &amp;&amp; Arguments[<span class="number">0</span>] == <span class="built_in">TEXT</span>(<span class="string">&quot;-register&quot;</span>))</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// Add the current directory to the list of installations</span></span><br><span class="line">    bRes = <span class="built_in">RegisterCurrentEngineDirectory</span>(<span class="literal">true</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (Arguments.<span class="built_in">Num</span>() == <span class="number">1</span> &amp;&amp; Arguments[<span class="number">0</span>] == <span class="built_in">TEXT</span>(<span class="string">&quot;-fileassociations&quot;</span>))</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// Update all the settings.</span></span><br><span class="line">    bRes = <span class="built_in">UpdateFileAssociations</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (Arguments.<span class="built_in">Num</span>() == <span class="number">2</span> &amp;&amp; Arguments[<span class="number">0</span>] == <span class="built_in">TEXT</span>(<span class="string">&quot;-switchversion&quot;</span>))</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// Associate with an engine label</span></span><br><span class="line">    bRes = <span class="built_in">SwitchVersion</span>(Arguments[<span class="number">1</span>]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (Arguments.<span class="built_in">Num</span>() == <span class="number">3</span> &amp;&amp; Arguments[<span class="number">0</span>] == <span class="built_in">TEXT</span>(<span class="string">&quot;-switchversionsilent&quot;</span>))</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// Associate with a specific engine label</span></span><br><span class="line">    bRes = <span class="built_in">SwitchVersionSilent</span>(Arguments[<span class="number">1</span>], Arguments[<span class="number">2</span>]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (Arguments.<span class="built_in">Num</span>() == <span class="number">2</span> &amp;&amp; Arguments[<span class="number">0</span>] == <span class="built_in">TEXT</span>(<span class="string">&quot;-editor&quot;</span>))</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// Open a project with the editor</span></span><br><span class="line">    bRes = <span class="built_in">LaunchEditor</span>(Arguments[<span class="number">1</span>], <span class="string">L&quot;&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (Arguments.<span class="built_in">Num</span>() == <span class="number">2</span> &amp;&amp; Arguments[<span class="number">0</span>] == <span class="built_in">TEXT</span>(<span class="string">&quot;-game&quot;</span>))</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// Play a game using the editor executable</span></span><br><span class="line">    bRes = <span class="built_in">LaunchEditor</span>(Arguments[<span class="number">1</span>], <span class="string">L&quot;-game&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (Arguments.<span class="built_in">Num</span>() == <span class="number">2</span> &amp;&amp; Arguments[<span class="number">0</span>] == <span class="built_in">TEXT</span>(<span class="string">&quot;-projectfiles&quot;</span>))</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// Generate Visual Studio project files</span></span><br><span class="line">    bRes = <span class="built_in">GenerateProjectFiles</span>(Arguments[<span class="number">1</span>]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// Invalid command line</span></span><br><span class="line">    FPlatformMisc::<span class="built_in">MessageBoxExt</span>(EAppMsgType::Ok, <span class="built_in">TEXT</span>(<span class="string">&quot;Invalid command line&quot;</span>), <span class="literal">NULL</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> bRes ? <span class="number">0</span> : <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Resolving-uproject-Right-Click-Generation-Failure"><a href="#Resolving-uproject-Right-Click-Generation-Failure" class="headerlink" title="Resolving .uproject Right-Click Generation Failure"></a>Resolving .uproject Right-Click Generation Failure</h3><p>First, you need to check the path of the <code>UnrealVersionSelector.exe</code> used in the right-click menu by opening the registry:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HKEY_CLASSES_ROOT\Unreal.ProjectFile</span><br></pre></td></tr></table></figure>
<p>Then find the <code>shell\open\command</code> entry to see the location of <code>UnrealVersionSelector.exe</code> (if you haven’t installed the source version, it will default to the Binaries path of EpicGamesLauncher), for example:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;C:\Program Files (x86)\Epic Games\Launcher\Engine\Binaries\Win64\UnrealVersionSelector.exe&quot; /editor &quot;%1&quot;</span><br></pre></td></tr></table></figure>
<p>Then go to <code>C:\Program Files (x86)\Epic Games\Launcher\Engine\Binaries\Win64</code> and set <code>UnrealVersionSelector.exe</code> to run with administrator privileges (right-click - Properties - Compatibility - Run this program as an administrator).</p>
<h2 id="GamePlay"><a href="#GamePlay" class="headerlink" title="GamePlay"></a>GamePlay</h2><h3 id="UE-Macro-Library-Issues"><a href="#UE-Macro-Library-Issues" class="headerlink" title="UE Macro Library Issues"></a>UE Macro Library Issues</h3><p>When using macro libraries in UE blueprints, simply saving changes to the macros inside the macro library isn’t sufficient; you must compile the blueprint using the macro library to see changes take effect. Essentially, the compilation inside the blueprint is what directly expands the macro. Otherwise, it will still be the earlier unmodified version, which is very frustrating. This issue exists in UE4.18.3; other versions haven’t been tested.</p>
<h3 id="UE-Saved-Directory-When-Packing-in-Shipping-Mode"><a href="#UE-Saved-Directory-When-Packing-in-Shipping-Mode" class="headerlink" title="UE Saved Directory When Packing in Shipping Mode"></a>UE Saved Directory When Packing in Shipping Mode</h3><p>The UE project includes the <code>Saved</code> directory under the <code>project directory</code> or <code>target directory</code> packed for <code>Development</code> or <code>DebugGame</code>, which contains <code>Autosaves</code>/<code>Backup</code>/<code>Config</code>/<code>Logs</code>/<code>Crashs</code>/<code>SaveGames</code>, etc.<br>However, with Shipping packaging, the <code>Saved</code> directory will not be located in the <code>target directory</code> but instead in <code>C:/User/%username%/AppData/Local/ProjectName</code>, with <code>ProjectName</code> replaced by your project name.</p>
<p>For more about UE packaging, you can check the UE documentation:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://docs.unrealengine.com/en-us/Engine/Basics/Projects/Packaging">Packaging Projects</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.unrealengine.com/en-us/Programming/Development/BuildConfigurations">BuildConfigurations</a></li>
</ul>
<h3 id="CharacterMovement-Enabling-RVO-Obstacle-Avoidance"><a href="#CharacterMovement-Enabling-RVO-Obstacle-Avoidance" class="headerlink" title="CharacterMovement Enabling RVO Obstacle Avoidance"></a>CharacterMovement Enabling RVO Obstacle Avoidance</h3><p><code>CharacterMovementComponent</code> has an automatic avoidance function; you just need to enable <code>UseRVOAvoidance</code>.<br>However, remember to disable the RVO obstacles after the character dies; otherwise, it will lead to issues where monsters avoid obstacles on open ground.<br>You can use <code>SetAvoidanceEnable</code> to disable it.</p>
<h3 id="VR-Bow-Model-Standards"><a href="#VR-Bow-Model-Standards" class="headerlink" title="VR Bow Model Standards"></a>VR Bow Model Standards</h3><p>The bow needed for VR should be a SkeleMesh, with the root bone point located at the gripping position (preferably at the center of the bow), and for computation convenience, the model direction should follow the requirement below:<br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/3380/vr-bow-mesh-rotation.webp"><br>This is to facilitate the calculation of the rotation when the VR player grabs the bow:<br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/3380/calc-vr-pickup-bow-rotation.webp"></p>
<blockquote>
<p>When drawing the bow, the <strong>hand gripping the bow</strong> provides Roll rotation, while Pitch and Yaw are provided by the rotation needed for the <strong>hand gripping the bow to look at the hand drawing the bow</strong>.</p>
</blockquote>
<p>All bows should follow the same model rotation standard, which is easy to implement visually, but adjusting them differently programmatically is cumbersome.</p>
<p>Additionally, the model origin of the arrow should be at the tail of the arrow fletching:<br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/3380/vr-arrow-mesh-pivot.webp"></p>
<p>Creating a satisfying bow experience is quite complicated, and the key lies in detail optimization.</p>
<h3 id="Implementation-of-Outfit-Change-in-UE"><a href="#Implementation-of-Outfit-Change-in-UE" class="headerlink" title="Implementation of Outfit Change in UE"></a>Implementation of Outfit Change in UE</h3><p>In the UE <a target="_blank" rel="noopener" href="http://api.unrealengine.com/INT/API/Runtime/Engine/Components/USkinnedMeshComponent/index.html">USkinnedMeshComponent</a>, there is a function like this:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ENGINE_API</span> USkinnedMeshComponent : <span class="keyword">public</span> UMeshComponent</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * Set MasterPoseComponent for this component</span></span><br><span class="line"><span class="comment">	 *</span></span><br><span class="line"><span class="comment">	 * @param NewMasterBoneComponent New MasterPoseComponent</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="built_in">UFUNCTION</span>(BlueprintCallable, Category=<span class="string">&quot;Components|SkinnedMesh&quot;</span>)</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">SetMasterPoseComponent</span><span class="params">(USkinnedMeshComponent* NewMasterBoneComponent)</span></span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>It essentially means that the current <code>SkinnedMeshComponent</code> will move according to the pose of <code>NewMasterBoneComponent</code>.<br>We can use a set of models using the same skeleton to implement the outfit change functionality, such as head, torso, legs, feet, and hands, by having a character possess five separate <code>USkinnedMeshComponent</code> model components to represent different parts.<br>The character can have an animated <code>USkinnedMeshComponent</code> as the body, and then set the <code>MasterPose</code> of the five upper <code>USkinnedMeshComponent</code> parts to it.<br>At this point, all parts will animate according to the body’s animation; achieving outfit changes can simply be done by modifying the models of the respective parts.</p>
<h3 id="Compiling-Blueprint-to-C-Code-in-UE"><a href="#Compiling-Blueprint-to-C-Code-in-UE" class="headerlink" title="Compiling Blueprint to C++ Code in UE"></a>Compiling Blueprint to C++ Code in UE</h3><p>UE supports compiling blueprints to C++ code. You need to select <code>Exclusive</code> (only selected blueprint assets will generate C++) or <code>Inclusive</code> (generates C++ for all blueprint assets) in <code>Project Setting</code> - <code>Packaging</code> - <code>Blueprints</code>.<br>After selection, pack the project. Once packed successfully, you can find the <code>.cpp</code> and <code>.h</code> files starting with the blueprint name in the <code>public</code>/<code>private</code> directories under the <code>Intermediate\Plugins\NativizedAssets\Windows\Game\Source\NativizedAssets</code> path.</p>
<h3 id="UE-Blueprint-Function-Library-Cannot-Be-Called-in-UObject"><a href="#UE-Blueprint-Function-Library-Cannot-Be-Called-in-UObject" class="headerlink" title="UE Blueprint Function Library Cannot Be Called in UObject"></a>UE Blueprint Function Library Cannot Be Called in UObject</h3><p>When creating a Blueprint Function Library in the editor and creating a function, that function cannot be called in the blueprint’s <code>Object</code>, it will prompt:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Function Requires A World Context.</span><br></pre></td></tr></table></figure>
<p>Writing a test blueprint function library generates C++ code:<br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/3380/UE-gEN-Cpp-Code-From-Bp-Asset.webp"><br>The generated C++ code is as follows (removing redundant parts; full code can be found <a target="_blank" rel="noopener" href="https://gist.github.com/hxhb/69655c527024f06b1ddbcf3c29e7a816">here</a>):</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// TestFuncLib_pf1448227310.h</span></span><br><span class="line"><span class="built_in">UFUNCTION</span>(BlueprintCallable, BlueprintPure, meta=(WorldContext=<span class="string">&quot;__WorldContext&quot;</span>, Category, OverrideNativeName=<span class="string">&quot;GetComponents&quot;</span>))</span><br><span class="line"><span class="function"><span class="type">static</span> TArray&lt;UActorComponent*&gt;  <span class="title">bpf__GetComponents__pf</span><span class="params">(AActor* bpp__pActor__pf, UClass* bpp__pCompClass__pf, UObject* bpp____WorldContext__pf)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// TestFuncLib_pf1448227310.cpp</span></span><br><span class="line"><span class="function">TArray&lt;UActorComponent*&gt;  <span class="title">UTestFuncLib_C__pf1448227310::bpf__GetComponents__pf</span><span class="params">(AActor* bpp__pActor__pf, UClass* bpp__pCompClass__pf, UObject* bpp____WorldContext__pf)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  TArray&lt;UActorComponent*&gt; bpp__ReturnValue__pf&#123;&#125;;</span><br><span class="line">  TArray&lt;UActorComponent*&gt; bpfv__CallFunc_GetComponentsByClass_ReturnValue__pf&#123;&#125;;</span><br><span class="line">  FString bpfv__CallFunc_GetDisplayName_ReturnValue__pf&#123;&#125;;</span><br><span class="line">  bpfv__CallFunc_GetDisplayName_ReturnValue__pf = UKismetSystemLibrary::<span class="built_in">GetDisplayName</span>(bpp____WorldContext__pf);</span><br><span class="line">  UKismetSystemLibrary::<span class="built_in">PrintString</span>(bpp____WorldContext__pf, bpfv__CallFunc_GetDisplayName_ReturnValue__pf, <span class="literal">true</span>, <span class="literal">true</span>, <span class="built_in">FLinearColor</span>(<span class="number">0.000000</span>,<span class="number">0.660000</span>,<span class="number">1.000000</span>,<span class="number">1.000000</span>), <span class="number">2.000000</span>);</span><br><span class="line">  <span class="keyword">if</span>(<span class="built_in">IsValid</span>(bpp__pActor__pf))</span><br><span class="line">  &#123;</span><br><span class="line">    bpfv__CallFunc_GetComponentsByClass_ReturnValue__pf = bpp__pActor__pf-&gt;AActor::<span class="built_in">GetComponentsByClass</span>(bpp__pCompClass__pf);</span><br><span class="line">  &#125;</span><br><span class="line">  bpp__ReturnValue__pf = bpfv__CallFunc_GetComponentsByClass_ReturnValue__pf;</span><br><span class="line">  <span class="keyword">return</span> bpp__ReturnValue__pf;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Simply copying the above code to a C++ blueprint function library can be callable in UObject… this is perplexing.</p>
<h3 id="Placing-Components-into-Bone-Sockets-in-UE"><a href="#Placing-Components-into-Bone-Sockets-in-UE" class="headerlink" title="Placing Components into Bone Sockets in UE"></a>Placing Components into Bone Sockets in UE</h3><p>In Blueprints, you can directly set the <code>parent socket</code> property in the Blueprint editor to place a component into a bone socket. In C++, it’s similar but slightly more complex. Let’s look at a code example from ShooterGame:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ShooterGame\Private\Weapons\ShooterWeapon.cpp</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">AShooterWeapon::AttachMeshToPawn</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (MyPawn)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// Remove and hide both first and third person meshes</span></span><br><span class="line">    <span class="built_in">DetachMeshFromPawn</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// For locally controlled players we attach both weapons and let the bOnlyOwnerSee, bOwnerNoSee flags deal with visibility.</span></span><br><span class="line">    FName AttachPoint = MyPawn-&gt;<span class="built_in">GetWeaponAttachPoint</span>();</span><br><span class="line">    <span class="keyword">if</span>( MyPawn-&gt;<span class="built_in">IsLocallyControlled</span>() == <span class="literal">true</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      USkeletalMeshComponent* PawnMesh1p = MyPawn-&gt;<span class="built_in">GetSpecifcPawnMesh</span>(<span class="literal">true</span>);</span><br><span class="line">      USkeletalMeshComponent* PawnMesh3p = MyPawn-&gt;<span class="built_in">GetSpecifcPawnMesh</span>(<span class="literal">false</span>);</span><br><span class="line">      Mesh1P-&gt;<span class="built_in">SetHiddenInGame</span>( <span class="literal">false</span> );</span><br><span class="line">      Mesh3P-&gt;<span class="built_in">SetHiddenInGame</span>( <span class="literal">false</span> );</span><br><span class="line">      Mesh1P-&gt;<span class="built_in">AttachToComponent</span>(PawnMesh1p, FAttachmentTransformRules::KeepRelativeTransform, AttachPoint);</span><br><span class="line">      Mesh3P-&gt;<span class="built_in">AttachToComponent</span>(PawnMesh3p, FAttachmentTransformRules::KeepRelativeTransform, AttachPoint);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      USkeletalMeshComponent* UseWeaponMesh = <span class="built_in">GetWeaponMesh</span>();</span><br><span class="line">      USkeletalMeshComponent* UsePawnMesh = MyPawn-&gt;<span class="built_in">GetPawnMesh</span>();</span><br><span class="line">      UseWeaponMesh-&gt;<span class="built_in">AttachToComponent</span>(UsePawnMesh, FAttachmentTransformRules::KeepRelativeTransform, AttachPoint);</span><br><span class="line">      UseWeaponMesh-&gt;<span class="built_in">SetHiddenInGame</span>( <span class="literal">false</span> );</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The same <code>AttachToComponent</code> method is used, and in Blueprints, you can also use a node with the same name to attach to bone sockets.### Getting OpenLevel Options in Unreal</p>
<p>When loading a level in UE, you can pass a <code>FString</code> of options:<br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/3380/UE-OpenLebel-PassOptions.webp"></p>
<p>In the loaded level, you can retrieve it using <code>GetGameMode</code>:<br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/3380/UE-OpenLebel-GetOptions.webp"></p>
<p>Using C++, the code looks like this:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">AGameModeBase* OurGameMode=UGameplayStatics::<span class="built_in">GetGameMode</span>(<span class="keyword">this</span>);</span><br><span class="line">FString LevelOptionString=OurGameMode-&gt;OptionsString;</span><br></pre></td></tr></table></figure>
<p><strong>Note:</strong> After switching levels, objects created in the original level will be destroyed. To retain specified Actors during level switch, use the GameMode’s <code>GetSeamlessTravelActorList</code>.</p>
<h3 id="Converting-3D-Positions-in-Game-Scenes-to-Screen-Positions"><a href="#Converting-3D-Positions-in-Game-Scenes-to-Screen-Positions" class="headerlink" title="Converting 3D Positions in Game Scenes to Screen Positions"></a>Converting 3D Positions in Game Scenes to Screen Positions</h3><p><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/3380/ConvertWorldPositionToScreenPosition.webp"></p>
<h3 id="Setting-the-Mouse-Cursor’s-Relative-Position-in-Viewport"><a href="#Setting-the-Mouse-Cursor’s-Relative-Position-in-Viewport" class="headerlink" title="Setting the Mouse Cursor’s Relative Position in Viewport"></a>Setting the Mouse Cursor’s Relative Position in Viewport</h3><p>First, install the LowEntry-ExtendedStandardLibrary plugin, which provides the <code>ULowEntryExtendedStandardLibrary::SetMousePosition</code> function to set the mouse cursor’s relative position in the viewport. The viewport size can be obtained using <code>UWidgetLayoutLibrary::GetViewportSize</code>.</p>
<h3 id="Mouse-Focus-Not-in-Window-After-Starting-Game-in-UE"><a href="#Mouse-Focus-Not-in-Window-After-Starting-Game-in-UE" class="headerlink" title="Mouse Focus Not in Window After Starting Game in UE"></a>Mouse Focus Not in Window After Starting Game in UE</h3><p>You can use <code>SetInputModeGameAndUI</code> to set the mouse focus within the window, with <code>InMourseLockMode</code> set to <code>LockAlways</code>. By using this operation when starting the game, the mouse focus will be within the game window, thus avoiding the need to click the game window before clicking UI elements.</p>
<h3 id="Determining-if-a-Particle-Effect-is-Looping"><a href="#Determining-if-a-Particle-Effect-is-Looping" class="headerlink" title="Determining if a Particle Effect is Looping"></a>Determining if a Particle Effect is Looping</h3><p>If an <code>UParticleSystem</code>‘s <code>Emitter</code> has its <code>Required</code> <code>Emitter Loops</code> set to 0, it is a looping effect:<br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/3380/unreal_loop_particle_system.webp"></p>
<p>UE provides a method to check if a particle effect is looping:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">UParticleSystem::IsLooping</span><span class="params">()</span><span class="type">const</span></span>&#123; <span class="comment">/*...*/</span> &#125;</span><br></pre></td></tr></table></figure>
<p>As long as there is one looping Emitter in the effect, the effect is considered looping. However, this method is not exposed to Blueprints; you can write a function library to wrap it for Blueprints.</p>
<h3 id="Cross-Module-Class-Symbol-Export-Considerations"><a href="#Cross-Module-Class-Symbol-Export-Considerations" class="headerlink" title="Cross-Module Class Symbol Export Considerations"></a>Cross-Module Class Symbol Export Considerations</h3><p>When inheriting/accessing classes within the UE engine, always check if the class has export symbols. Classes without export symbols cannot be linked to definitions. For example, the <code>FParticleSpriteEmitterInstance</code> class under the UE <code>Engine</code> module does not have export symbols.</p>
<h3 id="Creating-Asynchronous-Nodes-in-Blueprints"><a href="#Creating-Asynchronous-Nodes-in-Blueprints" class="headerlink" title="Creating Asynchronous Nodes in Blueprints"></a>Creating Asynchronous Nodes in Blueprints</h3><p>In a project, there might be needs for asynchronous operations, such as downloading files, where a download command waits for completion before callback, while minimizing excessive event bindings and unbindings. In Blueprint nodes, some asynchronous operations like <code>PlayMontage</code>/<code>DownloadImage</code> have multiple output nodes:<br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/3380/bp-node-playmontage-and-downloadImage.webp"><br>Can we write our asynchronous operation node? Absolutely.<br>You can check the implementation of the <a target="_blank" rel="noopener" href="https://api.unrealengine.com/INT/BlueprintAPI/Class/AsyncTaskDownloadImage/DownloadImage/index.html">DownloadImage</a> node in <code>Engine\Source\Runtime\UMG\Public\Blueprint\AsyncTaskDownloadImage.h</code> (<a target="_blank" rel="noopener" href="https://api.unrealengine.com/INT/API/Runtime/UMG/Blueprint/UAsyncTaskDownloadImage/index.html">C++API</a>).<br>Here’s how to create a similar node:</p>
<ol>
<li>The key is to inherit <code>UBlueprintAsyncActionBase</code>, which is necessary.</li>
<li>Write a static function that returns a pointer to the class and mark it with <code>UFUNCTION</code> <code>BlueprintInternalUseOnly=&quot;true&quot;</code>.</li>
<li>Declare and define several dispatcher members, which will be the asynchronous nodes—these are the exec nodes on the right side of Blueprint nodes.</li>
</ol>
<p>Let’s first look at the declaration of <code>DownloadImage</code>:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">UTexture2DDynamic</span>;</span><br><span class="line"><span class="built_in">DECLARE_DYNAMIC_MULTICAST_DELEGATE_OneParam</span>(FDownloadImageDelegate, UTexture2DDynamic*, Texture);</span><br><span class="line"></span><br><span class="line"><span class="built_in">UCLASS</span>()</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UMG_API</span> UAsyncTaskDownloadImage : <span class="keyword">public</span> UBlueprintAsyncActionBase</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">GENERATED_UCLASS_BODY</span>()</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">UFUNCTION</span>(BlueprintCallable, meta=( BlueprintInternalUseOnly=<span class="string">&quot;true&quot;</span> ))</span><br><span class="line">	<span class="function"><span class="type">static</span> UAsyncTaskDownloadImage* <span class="title">DownloadImage</span><span class="params">(FString URL)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintAssignable)</span><br><span class="line">	FDownloadImageDelegate OnSuccess;</span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintAssignable)</span><br><span class="line">	FDownloadImageDelegate OnFail;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">Start</span><span class="params">(FString URL)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="comment">/** Handles image requests coming from the web */</span></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">HandleImageRequest</span><span class="params">(FHttpRequestPtr HttpRequest, FHttpResponsePtr HttpResponse, <span class="type">bool</span> bSucceeded)</span></span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>Comparing it with the <code>DownloadImage</code> node above, we see:<br>0. First, a dynamic multicast delegate <code>FDownloadImageDelegate</code> is declared, requiring one parameter.</p>
<ol>
<li>The <code>UAsyncTaskDownloadImage</code> class declares two event dispatchers, <code>OnSuccess</code> and <code>OnFail</code>, which correspond to the exec nodes and parameter <code>Texture</code> in the Blueprint node.</li>
<li>The static function <code>DownloadImage</code> receives a <code>FString</code> parameter and returns a <code>UAsyncTaskDownloadImage*</code>, making the dispatcher execution nodes visible in the Blueprint.</li>
</ol>
<p>That is, the dynamically declared member and its parameters will appear on the right side of the Blueprint node.</p>
<p>I implemented an asynchronous operation behavior, and here’s how it looks in Blueprint:<br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/3380/create-async-task-and-action.webp"><br>The behavior involves first creating an <code>AsyncActionObject</code> to later trigger asynchronous operations, and then executing <code>CreateAsyncTask</code>, which binds events to the previously created <code>AsyncActionObject</code>.<br>You can then call operations like <code>OnActionStart</code> on that ActionObj to invoke the relevant nodes on the right of <code>CreateAsyncTask</code>.<br>Note: My implementation restricts that one object corresponds to one Task; if the current <code>AsyncActionObject</code> is already bound to another task, task creation will fail.<br>Here’s the code:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// AsyncTask.h</span></span><br><span class="line"><span class="comment">// Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.</span></span><br><span class="line"><span class="comment">// Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AsyncActionObject.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// unreal header</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Array.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Kismet/KismetSystemLibrary.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;CoreMinimal.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;UObject/ObjectMacros.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Kismet/BlueprintAsyncActionBase.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AsyncTask.generated.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifndef</span> PRINT_LOG</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PRINT_LOG(lOG_TEXT) UKismetSystemLibrary::PrintString(this,lOG_TEXT,true,true);</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifndef</span> PRINT_ASYNC_ACTION_TOOLS_DEBUG_INFO</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PRINT_ASYNC_ACTION_TOOLS_DEBUG_INFO 0</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="built_in">DECLARE_DYNAMIC_MULTICAST_DELEGATE_OneParam</span>(FAsyncTaskDelegate,UAsyncActionObject*,ActionObj);</span><br><span class="line"></span><br><span class="line"><span class="built_in">UCLASS</span>(BlueprintType)</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UAsyncTask</span> : <span class="keyword">public</span> UBlueprintAsyncActionBase</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">GENERATED_UCLASS_BODY</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">UFUNCTION</span>(BlueprintCallable, meta=( BlueprintInternalUseOnly=<span class="string">&quot;true&quot;</span> ))</span><br><span class="line">	<span class="function"><span class="type">static</span> UAsyncTask* <span class="title">CreateAsyncTask</span><span class="params">(UAsyncActionObject* ActionObj)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintAssignable)</span><br><span class="line">	FAsyncTaskDelegate OnStart;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintAssignable)</span><br><span class="line">	FAsyncTaskDelegate OnAbort;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintAssignable)</span><br><span class="line">	FAsyncTaskDelegate OnUpdate;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">UPROPERTY</span>(BlueprintAssignable)</span><br><span class="line">	FAsyncTaskDelegate OnFinishd;</span><br><span class="line"></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">StartTask</span><span class="params">(UAsyncActionObject* ActionObj)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">OnActionStart</span><span class="params">(UAsyncActionObject* ActionObj)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">OnActionAbort</span><span class="params">(UAsyncActionObject* ActionObj)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">OnActionUpdate</span><span class="params">(UAsyncActionObject* ActionObj)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">OnActionFinishd</span><span class="params">(UAsyncActionObject* ActionObj)</span></span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>Now for the implementation:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// AsyncTask.cpp</span></span><br><span class="line"><span class="comment">// Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.</span></span><br><span class="line"><span class="comment">// Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AsyncTask.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Modules/ModuleManager.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//----------------------------------------------------------------------//</span></span><br><span class="line"><span class="comment">// UAsyncTask</span></span><br><span class="line"><span class="comment">//----------------------------------------------------------------------//</span></span><br><span class="line"></span><br><span class="line">UAsyncTask::<span class="built_in">UAsyncTask</span>(<span class="type">const</span> FObjectInitializer&amp; ObjectInitializer)</span><br><span class="line">	: <span class="built_in">Super</span>(ObjectInitializer)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">if</span> ( <span class="built_in">HasAnyFlags</span>(RF_ClassDefaultObject) == <span class="literal">false</span> )</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">AddToRoot</span>();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">UAsyncTask* <span class="title">UAsyncTask::CreateAsyncTask</span><span class="params">(UAsyncActionObject* ActionObj)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	UAsyncTask* AsyncActionTask = <span class="built_in">NewObject</span>&lt;UAsyncTask&gt;();</span><br><span class="line">	AsyncActionTask-&gt;<span class="built_in">StartTask</span>(ActionObj);</span><br><span class="line">	<span class="keyword">return</span> AsyncActionTask;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAsyncTask::StartTask</span><span class="params">(UAsyncActionObject* ActionObj)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(ActionObj &amp;&amp; !ActionObj-&gt;<span class="built_in">Action_IsRunning</span>())</span><br><span class="line">	&#123;</span><br><span class="line"><span class="meta">#<span class="keyword">if</span> PRINT_ASYNC_ACTION_TOOLS_DEBUG_INFO</span></span><br><span class="line">	<span class="built_in">PRINT_LOG</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;UAsyncTask::StartTask Bind Event&quot;</span>));</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">		(ActionObj-&gt;OnStart).<span class="built_in">BindUObject</span>(<span class="keyword">this</span>,&amp;UAsyncTask::OnActionStart);</span><br><span class="line">		(ActionObj-&gt;OnAbort).<span class="built_in">BindUObject</span>(<span class="keyword">this</span>,&amp;UAsyncTask::OnActionAbort);</span><br><span class="line">		(ActionObj-&gt;OnUpdate).<span class="built_in">BindUObject</span>(<span class="keyword">this</span>,&amp;UAsyncTask::OnActionUpdate);</span><br><span class="line">		(ActionObj-&gt;OnFinishd).<span class="built_in">BindUObject</span>(<span class="keyword">this</span>,&amp;UAsyncTask::OnActionFinishd);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAsyncTask::OnActionStart</span><span class="params">(UAsyncActionObject* ActionObj)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="meta">#<span class="keyword">if</span> PRINT_ASYNC_ACTION_TOOLS_DEBUG_INFO</span></span><br><span class="line">	<span class="built_in">PRINT_LOG</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;UAsyncTask::OnStart&quot;</span>));</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">	OnStart.<span class="built_in">Broadcast</span>(ActionObj);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAsyncTask::OnActionAbort</span><span class="params">(UAsyncActionObject* ActionObj)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="meta">#<span class="keyword">if</span> PRINT_ASYNC_ACTION_TOOLS_DEBUG_INFO</span></span><br><span class="line">	<span class="built_in">PRINT_LOG</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;UAsyncTask::OnActionAbort&quot;</span>));</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">	OnAbort.<span class="built_in">Broadcast</span>(ActionObj);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAsyncTask::OnActionUpdate</span><span class="params">(UAsyncActionObject* ActionObj)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="meta">#<span class="keyword">if</span> PRINT_ASYNC_ACTION_TOOLS_DEBUG_INFO</span></span><br><span class="line">	<span class="built_in">PRINT_LOG</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;UAsyncTask::OnActionUpdate&quot;</span>));</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">	OnUpdate.<span class="built_in">Broadcast</span>(ActionObj);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAsyncTask::OnActionFinishd</span><span class="params">(UAsyncActionObject* ActionObj)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="meta">#<span class="keyword">if</span> PRINT_ASYNC_ACTION_TOOLS_DEBUG_INFO</span></span><br><span class="line">	<span class="built_in">PRINT_LOG</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;UAsyncTask::OnActionFinishd&quot;</span>));</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">	OnFinishd.<span class="built_in">Broadcast</span>(ActionObj);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Declaration for the AsyncActionObject class:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// AsyncActionObject.h</span></span><br><span class="line"><span class="comment">// Fill out your copyright notice in the Description page of Project Settings.</span></span><br><span class="line"><span class="comment">// Fill out your copyright notice in the Description page of Project Settings.</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// unreal header</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Array.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Kismet/KismetSystemLibrary.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;CoreMinimal.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;UObject/NoExportTypes.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AsyncActionObject.generated.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifndef</span> PRINT_LOG</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PRINT_LOG(lOG_TEXT) UKismetSystemLibrary::PrintString(this,lOG_TEXT,true,true);</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifndef</span> PRINT_ASYNC_ACTION_OBJ_DEBUG_INFO</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PRINT_ASYNC_ACTION_OBJ_DEBUG_INFO 0</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UAsyncActionObject</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">DECLARE_DELEGATE_OneParam</span>(FAsyncActionDelegate,UAsyncActionObject*);</span><br><span class="line"></span><br><span class="line"><span class="built_in">UCLASS</span>(BlueprintType,Blueprintable)</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UAsyncActionObject</span> : <span class="keyword">public</span> UObject</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">GENERATED_BODY</span>()</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">UAsyncActionObject</span>(<span class="type">const</span> FObjectInitializer&amp; objectInitializer);</span><br><span class="line">	FAsyncActionDelegate OnStart;</span><br><span class="line">	FAsyncActionDelegate OnAbort;</span><br><span class="line">	FAsyncActionDelegate OnUpdate;</span><br><span class="line">	FAsyncActionDelegate OnFinishd;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">UFUNCTION</span>(BlueprintCallable)</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">bool</span> <span class="title">OnActionStart</span><span class="params">(FString&amp; rReason)</span></span>;</span><br><span class="line">	<span class="built_in">UFUNCTION</span>(BlueprintCallable)</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">OnActionAbort</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="built_in">UFUNCTION</span>(BlueprintCallable)</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">OnActionUpdate</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="built_in">UFUNCTION</span>(BlueprintCallable)</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">OnActionFinishd</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="comment">// Action status (BP Executable function)</span></span><br><span class="line">	<span class="built_in">UFUNCTION</span>(BlueprintCallable)</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">bool</span> <span class="title">Action_IsRunning</span><span class="params">()</span><span class="type">const</span></span>;</span><br><span class="line">	<span class="built_in">UFUNCTION</span>(BlueprintCallable)</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">bool</span> <span class="title">Action_ExecutableStart</span><span class="params">()</span><span class="type">const</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">	<span class="comment">// End Action</span></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">EndAction</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">UnBindAll</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">InitDelegateList</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">bool</span> <span class="title">Action_IsStarted</span><span class="params">()</span><span class="type">const</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">bool</span> <span class="title">Action_EventIsBinded</span><span class="params">()</span><span class="type">const</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">	<span class="type">bool</span> mActionStarted=<span class="literal">false</span>;</span><br><span class="line">	TArray&lt;FAsyncActionDelegate*&gt; DelegateList;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>And its implementation:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// AsyncActionObject.cpp</span></span><br><span class="line"><span class="comment">// Fill out your copyright notice in the Description page of Project Settings.</span></span><br><span class="line"><span class="comment">// Copyright 1998-2017 Epic Games, Inc. All Rights Reserved.</span></span><br><span class="line"><span class="comment">// Fill out your copyright notice in the Description page of Project Settings.</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;AsyncActionObject.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">UAsyncActionObject::<span class="built_in">UAsyncActionObject</span>(<span class="type">const</span> FObjectInitializer&amp; objectInitializer)</span><br><span class="line">&#123;</span><br><span class="line"><span class="meta">#<span class="keyword">if</span> PRINT_ASYNC_ACTION_OBJ_DEBUG_INFO</span></span><br><span class="line">		<span class="built_in">PRINT_LOG</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;UAsyncActionObject::UAsyncActionObject&quot;</span>));</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">	<span class="built_in">InitDelegateList</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">UAsyncActionObject::OnActionStart</span><span class="params">(FString&amp; rReason)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	rReason.<span class="built_in">Reset</span>();</span><br><span class="line">	<span class="type">bool</span> local_bResault=<span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(<span class="built_in">Action_ExecutableStart</span>())</span><br><span class="line">	&#123;</span><br><span class="line"><span class="meta">#<span class="keyword">if</span> PRINT_ASYNC_ACTION_OBJ_DEBUG_INFO</span></span><br><span class="line">		<span class="built_in">PRINT_LOG</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;UAsyncActionObject::OnActionStart&quot;</span>));</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">		mActionStarted=<span class="literal">true</span>;</span><br><span class="line">		OnStart.<span class="built_in">ExecuteIfBound</span>(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">		local_bResault=<span class="literal">true</span>;</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> PRINT_ASYNC_ACTION_OBJ_DEBUG_INFO</span></span><br><span class="line">		<span class="built_in">PRINT_LOG</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;call UAsyncActionObject::OnActionStart Faild.&quot;</span>));</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">		local_bResault=<span class="literal">false</span>;</span><br><span class="line">		<span class="keyword">if</span>(<span class="built_in">Action_IsStarted</span>())</span><br><span class="line">		&#123;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> PRINT_ASYNC_ACTION_OBJ_DEBUG_INFO</span></span><br><span class="line">		<span class="built_in">PRINT_LOG</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;StartFaild: Action is Started.&quot;</span>));</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">			rReason.<span class="built_in">Append</span>(<span class="built_in">FString</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;Action is Started.\n&quot;</span>)));</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(!<span class="built_in">Action_EventIsBinded</span>())</span><br><span class="line">		&#123;</span><br><span class="line"><span class="meta">#<span class="keyword">if</span> PRINT_ASYNC_ACTION_OBJ_DEBUG_INFO</span></span><br><span class="line">		<span class="built_in">PRINT_LOG</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;StartFaild: Action is not bind anything event.&quot;</span>));</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">			rReason.<span class="built_in">Append</span>(<span class="built_in">FString</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;Action is not bind to anything Task&quot;</span>)));</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> local_bResault;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAsyncActionObject::OnActionAbort</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(<span class="built_in">Action_IsRunning</span>())</span><br><span class="line">	&#123;</span><br><span class="line"><span class="meta">#<span class="keyword">if</span> PRINT_ASYNC_ACTION_OBJ_DEBUG_INFO</span></span><br><span class="line">	<span class="built_in">PRINT_LOG</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;UAsyncActionObject::OnActionAbort&quot;</span>));</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">		OnAbort.<span class="built_in">ExecuteIfBound</span>(<span class="keyword">this</span>);</span><br><span class="line">		<span class="built_in">EndAction</span>();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAsyncActionObject::OnActionUpdate</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(<span class="built_in">Action_IsRunning</span>())</span><br><span class="line">	&#123;</span><br><span class="line"><span class="meta">#<span class="keyword">if</span> PRINT_ASYNC_ACTION_OBJ_DEBUG_INFO</span></span><br><span class="line">	<span class="built_in">PRINT_LOG</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;UAsyncActionObject::OnActionUpdate&quot;</span>));</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">		OnUpdate.<span class="built_in">ExecuteIfBound</span>(<span class="keyword">this</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAsyncActionObject::OnActionFinishd</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(<span class="built_in">Action_IsRunning</span>())</span><br><span class="line">	&#123;</span><br><span class="line"><span class="meta">#<span class="keyword">if</span> PRINT_ASYNC_ACTION_OBJ_DEBUG_INFO</span></span><br><span class="line">	<span class="built_in">PRINT_LOG</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;UAsyncActionObject::OnActionFinishd&quot;</span>));</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">		OnFinishd.<span class="built_in">ExecuteIfBound</span>(<span class="keyword">this</span>);</span><br><span class="line">		<span class="built_in">EndAction</span>();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAsyncActionObject::EndAction</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(<span class="built_in">Action_IsRunning</span>())</span><br><span class="line">	&#123;</span><br><span class="line"><span class="meta">#<span class="keyword">if</span> PRINT_ASYNC_ACTION_OBJ_DEBUG_INFO</span></span><br><span class="line">	<span class="built_in">PRINT_LOG</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;UAsyncActionObject::EndAction&quot;</span>));</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">		<span class="built_in">UnBindAll</span>();</span><br><span class="line">		mActionStarted=<span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAsyncActionObject::UnBindAll</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="meta">#<span class="keyword">if</span> PRINT_ASYNC_ACTION_OBJ_DEBUG_INFO</span></span><br><span class="line">	<span class="built_in">PRINT_LOG</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;UAsyncActionObject::UnBindAll&quot;</span>));</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">auto</span>&amp; DeleIndex:DelegateList)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(DeleIndex-&gt;<span class="built_in">IsBound</span>())</span><br><span class="line">		&#123;</span><br><span class="line">			DeleIndex-&gt;<span class="built_in">Unbind</span>();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UAsyncActionObject::InitDelegateList</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(!<span class="built_in">Action_IsStarted</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		DelegateList.<span class="built_in">AddUnique</span>(&amp;OnStart);</span><br><span class="line">		DelegateList.<span class="built_in">AddUnique</span>(&amp;OnAbort);</span><br><span class="line">		DelegateList.<span class="built_in">AddUnique</span>(&amp;OnUpdate);</span><br><span class="line">		DelegateList.<span class="built_in">AddUnique</span>(&amp;OnFinishd);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">UAsyncActionObject::Action_EventIsBinded</span><span class="params">()</span><span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">bool</span> EventIsBinded=<span class="literal">true</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">auto</span>&amp; DeleIndex:DelegateList)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(!DeleIndex-&gt;<span class="built_in">IsBound</span>())</span><br><span class="line">			EventIsBinded=<span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> EventIsBinded;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">UAsyncActionObject::Action_IsStarted</span><span class="params">()</span><span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> mActionStarted;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">UAsyncActionObject::Action_IsRunning</span><span class="params">()</span><span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">Action_IsStarted</span>() &amp;&amp; <span class="built_in">Action_EventIsBinded</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">UAsyncActionObject::Action_ExecutableStart</span><span class="params">()</span><span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> !<span class="built_in">Action_IsStarted</span>() &amp;&amp; <span class="built_in">Action_EventIsBinded</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Essentially, it wraps two layers of dispatchers…<br>For example, it can be used to listen for an animation being terminated or completed in a behavior tree, then execute other behaviors, thus solving coupling between different modules.</p>
<h3 id="UE-Warning-Error-for-Including-Windows-Header-Files"><a href="#UE-Warning-Error-for-Including-Windows-Header-Files" class="headerlink" title="UE Warning/Error for Including Windows Header Files"></a>UE Warning/Error for Including Windows Header Files</h3><p>If you use <code>windows.h</code> in UE, you may encounter error 4668 in VS, which was previously a warning in earlier UE versions but became an error in UE4.18. UE itself encapsulates the header files of the Windows API, and you can include the relevant:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="comment">// In UE</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Windows/MinWindows.h&quot;</span></span></span><br></pre></td></tr></table></figure>
<p>Alternatively, you can use:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">pragma</span> <span class="keyword">warning</span>(disable:4668)</span></span><br></pre></td></tr></table></figure>
<p>to also resolve the issue.</p>
<p>Additionally, if you use Windows API in your code, like <code>windows.h</code>, you may encounter similar errors like:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1&gt;C:\Program Files\Epic Games\UE_4.15\Engine\Source\Runtime\Core\Public\Async/TaskGraphInterfaces.h(892): error C2039: <span class="string">&#x27;__faststorefence&#x27;</span>: is not a member of <span class="string">&#x27;FWindowsPlatformMisc&#x27;</span></span><br><span class="line">1&gt;c:\program files\epic games\ue_4.15\engine\<span class="built_in">source</span>\runtime\core\public\Windows/WindowsPlatformMisc.h(33): note: see declaration of <span class="string">&#x27;FWindowsPlatformMisc&#x27;</span></span><br><span class="line">1&gt;C:\Program Files\Epic Games\UE_4.15\Engine\Source\Runtime\Core\Public\Async/TaskGraphInterfaces.h(868): note: <span class="keyword">while</span> compiling class template member <span class="keyword">function</span> <span class="string">&#x27;void TGraphTask&lt;FFunctionGraphTask&gt;::ExecuteTask(TArray&lt;FBaseGraphTask *,FDefaultAllocator&gt; &amp;,ENamedThreads::Type)&#x27;</span></span><br><span class="line">1&gt;C:\Program Files\Epic Games\UE_4.15\Engine\Source\Runtime\Core\Public\Async/TaskGraphInterfaces.h(1379): note: see reference to class template instantiation <span class="string">&#x27;TGraphTask&lt;FFunctionGraphTask&gt;&#x27;</span> being compiled</span><br></pre></td></tr></table></figure>
<p>The solution to this problem is to avoid including these Windows API header files in UE header files; move them to the corresponding <code>.cpp</code> files instead.</p>
<h3 id="Getting-the-Relative-Ratio-of-the-Cursor-in-the-Window-in-UE"><a href="#Getting-the-Relative-Ratio-of-the-Cursor-in-the-Window-in-UE" class="headerlink" title="Getting the Relative Ratio of the Cursor in the Window in UE"></a>Getting the Relative Ratio of the Cursor in the Window in UE</h3><p>First, obtain the current window size using <code>UGameViewportClient</code> to get the <code>SWindow</code>, and then you can use <code>SWindow::GetSizeInScreen</code> to obtain the size:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">GetWindowSize</span><span class="params">(<span class="type">bool</span>&amp; Success, int32&amp; Width, int32&amp; Height)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  Success = <span class="literal">false</span>;</span><br><span class="line">  Width = <span class="number">0</span>;</span><br><span class="line">  Height = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(GEngine == <span class="literal">nullptr</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  UGameViewportClient* ViewportClient = GEngine-&gt;GameViewport;</span><br><span class="line">  <span class="keyword">if</span>(ViewportClient == <span class="literal">nullptr</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  TSharedPtr&lt;SWindow&gt; Window = ViewportClient-&gt;<span class="built_in">GetWindow</span>();</span><br><span class="line">  <span class="keyword">if</span>(!Window.<span class="built_in">IsValid</span>())</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  FVector2D Size = Window-&gt;<span class="built_in">GetSizeInScreen</span>();</span><br><span class="line"></span><br><span class="line">  Success = <span class="literal">true</span>;</span><br><span class="line">  Width = Size.X;</span><br><span class="line">  Height = Size.Y;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Then to get the cursor’s position within the current window, you can use <code>APlayerController::GetMousePosition</code> (it is also obtained via the Viewport):</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">APlayerController::GetMousePosition</span><span class="params">(<span class="type">float</span>&amp; LocationX, <span class="type">float</span>&amp; LocationY)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">bool</span> bGotMousePosition = <span class="literal">false</span>;</span><br><span class="line">  ULocalPlayer* LocalPlayer = <span class="built_in">Cast</span>&lt;ULocalPlayer&gt;(Player);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (LocalPlayer &amp;&amp; LocalPlayer-&gt;ViewportClient)</span><br><span class="line">  &#123;</span><br><span class="line">    FVector2D MousePosition;</span><br><span class="line"></span><br><span class="line">    bGotMousePosition = LocalPlayer-&gt;ViewportClient-&gt;<span class="built_in">GetMousePosition</span>(MousePosition);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (bGotMousePosition)</span><br><span class="line">    &#123;</span><br><span class="line">      LocationX = MousePosition.X;</span><br><span class="line">      LocationY = MousePosition.Y;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> bGotMousePosition;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Then dividing the two will give you the relative position of the mouse in the current window.</p>
<h3 id="Gamma-Value-of-SceneCapture2D"><a href="#Gamma-Value-of-SceneCapture2D" class="headerlink" title="Gamma Value of SceneCapture2D"></a>Gamma Value of SceneCapture2D</h3><p>When capturing images using <code>USceneCapture2D</code> to <code>RenderTarget</code> and displaying it on the <code>Spectator Screen</code>, the colors might appear incorrect:<br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/3380/UE_SceneCapture2D_To_RenderTarget_Texture_Darker.webp"></p>
<p>The solution is to:</p>
<ol>
<li>Set the SceneCapture2D’s <code>CaptureSouce</code> to <code>Final Color (LDR) in RGB</code>.</li>
<li>Set the RenderTarget resource’s gamma value to <code>2.2</code> to make it look close to the original image.</li>
</ol>
<h3 id="A-Cool-Trick-with-Event-Parameters-in-Blueprints"><a href="#A-Cool-Trick-with-Event-Parameters-in-Blueprints" class="headerlink" title="A Cool Trick with Event Parameters in Blueprints"></a>A Cool Trick with Event Parameters in Blueprints</h3><p>In some plugins, similar operations can be seen:<br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/3380/bp-use-otherevent-args.webp"></p>
<p>In reality, the parameters of Unreal Blueprint event nodes are members of the class, allowing them to be accessed directly in other places.</p>
<p>Similar issues can be found with delay operations:<br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/3380/bp-twice-call-delay-event.webp"></p>
<h3 id="Collision-Detection-Issues-with-UProjectileMovementComponent-in-UE"><a href="#Collision-Detection-Issues-with-UProjectileMovementComponent-in-UE" class="headerlink" title="Collision Detection Issues with UProjectileMovementComponent in UE"></a>Collision Detection Issues with UProjectileMovementComponent in UE</h3><p>When using the <a target="_blank" rel="noopener" href="https://api.unrealengine.com/INT/API/Runtime/Engine/GameFramework/UProjectileMovementComponent/index.html">UProjectileMovementComponent</a> for features like arrows, collisions may fail to trigger due to high speeds. This issue is recorded for future investigation.</p>
<h2 id="Config-and-Editor"><a href="#Config-and-Editor" class="headerlink" title="Config and Editor"></a>Config and Editor</h2><h3 id="Modifying-the-Esc-Key-to-Exit-Editor-Mode-in-UE"><a href="#Modifying-the-Esc-Key-to-Exit-Editor-Mode-in-UE" class="headerlink" title="Modifying the Esc Key to Exit Editor Mode in UE"></a>Modifying the Esc Key to Exit Editor Mode in UE</h3><p>Open <code>Editor Preferences</code>-<code>Keyboard Shortcuts</code> and modify the key for <code>Play World (PIE/SIE)</code>.<br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/3380/UE-change-Stop-keyshortcuts-in-PIE-mode.webp"></p>
<h3 id="Displaying-Plugin-Content-in-Editor"><a href="#Displaying-Plugin-Content-in-Editor" class="headerlink" title="Displaying Plugin Content in Editor"></a>Displaying Plugin Content in Editor</h3><p><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/3380/UE-Show-Plugins-Content-In-Editor-ContentBroser.webp"></p>
<h3 id="Modifying-Parallel-Count-During-UE-Compilation"><a href="#Modifying-Parallel-Count-During-UE-Compilation" class="headerlink" title="Modifying Parallel Count During UE Compilation"></a>Modifying Parallel Count During UE Compilation</h3><p>On Windows, you can modify the following files:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Engine/Saved/UnrealBuildTool/BuildConfiguration.xml</span><br><span class="line">User Folder/AppData/Roaming/Unreal Engine/UnrealBuildTool/BuildConfiguration.xml</span><br><span class="line">My Documents/Unreal Engine/UnrealBuildTool/BuildConfiguration.xml</span><br></pre></td></tr></table></figure>
<p>On Mac and Linux, modify the following paths:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/Users/&lt;USER&gt;/.config//Unreal Engine/UnrealBuildTool/BuildConfiguration.xml</span><br><span class="line">/Users/&lt;USER&gt;/Unreal Engine/UnrealBuildTool/BuildConfiguration.xml</span><br><span class="line">&lt;PROJECT_DIRECTORY&gt;/Saved/UnrealBuildTool/BuildConfiguration.xml</span><br></pre></td></tr></table></figure>

<p>The structure is as follows:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Configuration</span> <span class="attr">xmlns</span>=<span class="string">&quot;https://www.unrealengine.com/BuildConfiguration&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">BuildConfiguration</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">MaxProcessorCount</span>&gt;</span>1<span class="tag">&lt;/<span class="name">MaxProcessorCount</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">BuildConfiguration</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><code>MaxProcessorCount</code> is the maximum number of processors for local execution.<br>For more configuration parameters, see: <a target="_blank" rel="noopener" href="https://docs.unrealengine.com/en-us/Programming/UnrealBuildSystem/Configuration">UBT configuration</a></p>
<h3 id="Storing-Data-in-OBB-Files-When-Packaging-for-Android-in-UE"><a href="#Storing-Data-in-OBB-Files-When-Packaging-for-Android-in-UE" class="headerlink" title="Storing Data in OBB Files When Packaging for Android in UE"></a>Storing Data in OBB Files When Packaging for Android in UE</h3><p><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/3380/ue-package-android-data-placed-into-obb-file.webp"></p>
<h3 id="Lag-Issues-in-Editor-Mode-When-Focus-is-Not-in-Window-in-UE"><a href="#Lag-Issues-in-Editor-Mode-When-Focus-is-Not-in-Window-in-UE" class="headerlink" title="Lag Issues in Editor Mode When Focus is Not in Window in UE"></a>Lag Issues in Editor Mode When Focus is Not in Window in UE</h3><p>When playing a game in the editor on Windows, if the focus is not in the editor/VR application, CPU utilization decreases, causing lag (this does not occur when packaged). This is because UE performs a focus-checking operation in the editor environment:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Runtime/ApplicationCore/Private/Windows/WindowsPlatformApplicationMisc.cpp</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">FWindowsPlatformApplicationMisc::PumpMessages</span><span class="params">(<span class="type">bool</span> bFromMainLoop)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (!bFromMainLoop)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="function">TGuardValue&lt;<span class="type">bool</span>&gt; <span class="title">PumpMessageGuard</span><span class="params">( GPumpingMessagesOutsideOfMainLoop, <span class="literal">true</span> )</span></span>;</span><br><span class="line">		<span class="comment">// Process pending windows messages, which is necessary to the rendering thread in some rare cases where D3D</span></span><br><span class="line">		<span class="comment">// sends window messages (from IDXGISwapChain::Present) to the main thread owned viewport window.</span></span><br><span class="line">		<span class="built_in">WinPumpSentMessages</span>();</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	GPumpingMessagesOutsideOfMainLoop = <span class="literal">false</span>;</span><br><span class="line">	<span class="built_in">WinPumpMessages</span>();</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Determine if application has focus</span></span><br><span class="line">	<span class="type">bool</span> HasFocus = FApp::<span class="built_in">UseVRFocus</span>() ? FApp::<span class="built_in">HasVRFocus</span>() : FWindowsPlatformApplicationMisc::<span class="built_in">IsThisApplicationForeground</span>();</span><br><span class="line"></span><br><span class="line">	<span class="comment">// If editor thread doesn&#x27;t have the focus, don&#x27;t suck up too much CPU time.</span></span><br><span class="line">	<span class="keyword">if</span>( GIsEditor )</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="type">static</span> <span class="type">bool</span> HadFocus=<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span>( HadFocus &amp;&amp; !HasFocus )</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">// Drop our priority to speed up whatever is in the foreground.</span></span><br><span class="line">			<span class="built_in">SetThreadPriority</span>( <span class="built_in">GetCurrentThread</span>(), THREAD_PRIORITY_BELOW_NORMAL );</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span>( HasFocus &amp;&amp; !HadFocus )</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">// Boost our priority back to normal.</span></span><br><span class="line">			<span class="built_in">SetThreadPriority</span>( <span class="built_in">GetCurrentThread</span>(), THREAD_PRIORITY_NORMAL );</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>( !HasFocus )</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">// Sleep for a bit to not eat up all CPU time.</span></span><br><span class="line">			FPlatformProcess::<span class="built_in">Sleep</span>(<span class="number">0.005f</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		HadFocus = HasFocus;</span><br><span class="line">	&#125;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Simply commenting out the line <code>FPlatformProcess::Sleep(0.005f);</code> will resolve the issue.</p>
<h3 id="Resolving-Chinese-Character-Encoding-Issues-in-UE-Compiler-Logs-on-Windows-10"><a href="#Resolving-Chinese-Character-Encoding-Issues-in-UE-Compiler-Logs-on-Windows-10" class="headerlink" title="Resolving Chinese Character Encoding Issues in UE Compiler Logs on Windows 10"></a>Resolving Chinese Character Encoding Issues in UE Compiler Logs on Windows 10</h3><p><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/3380/fix-unreal-compiler-error-chinese-character-messy-code.webp"></p>
<p>Note: There may be encoding issues in certain software (for instance, GBK encoding might show garbled characters).</p>
<h2 id="Package"><a href="#Package" class="headerlink" title="Package"></a>Package</h2><h3 id="ObservedKeyNames-Num-gt-0"><a href="#ObservedKeyNames-Num-gt-0" class="headerlink" title="ObservedKeyNames.Num()&gt;0"></a>ObservedKeyNames.Num()&gt;0</h3><p>For detailed solutions, see: <a target="_blank" rel="noopener" href="https://imzlp.com/posts/359/">UE Package Error: ObservedKeyNames.Num()&gt;0</a></p>
<h3 id="UE-Package-Error-RenderDocPlugin"><a href="#UE-Package-Error-RenderDocPlugin" class="headerlink" title="UE Package Error:RenderDocPlugin"></a>UE Package Error:RenderDocPlugin</h3><blockquote>
<p>RenderDocPlugin: Error: unable to initialize the plugin because no RenderDoc library has been located.</p>
</blockquote>
<p><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/3380/ue-package-renderdoc-plugin-error.webp"><br>Solution: Disable the RenderDocPlugin before packaging.### UE4 Packaging 32bit Requires 16-byte Alignment Error<br>When selecting the 32bit platform to package in the engine, the following error occurs:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">error C2719: <span class="string">&#x27;SpawnTransform&#x27;</span>: formal parameter with requested alignment of 16 won<span class="string">&#x27;t be aligned</span></span><br></pre></td></tr></table></figure>
<p>This is because <code>FTransform</code> is passed by value in the code:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">AProps* <span class="title">SpawnProps</span><span class="params">(FTransform SpawnTransform)</span></span>;</span><br></pre></td></tr></table></figure>
<p>Since FTransform requires 16-byte alignment: <a target="_blank" rel="noopener" href="https://github.com/EpicGames/UnrealEngine/blob/b70f31f6645d764bcb55829228918a6e3b571e0b/Engine/Source/Runtime/Core/Public/Math/TransformVectorized.h#L36">Math/TransformVectorized.h#L36</a></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">MS_ALIGN</span>(<span class="number">16</span>) <span class="keyword">struct</span> <span class="title class_">FTransform</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The <code>MS_ALIGN</code> macro is defined in <a target="_blank" rel="noopener" href="https://github.com/EpicGames/UnrealEngine/blob/b70f31f6645d764bcb55829228918a6e3b571e0b/Engine/Source/Runtime/Core/Public/Windows/WIndowsPlatform.h#L131">Core/Public/Windows/WindowsPlatform.h#L131</a>:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Alignment.</span></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> defined(__clang__)</span></span><br><span class="line">	<span class="meta">#<span class="keyword">define</span> GCC_PACK(n) __attribute__((packed,aligned(n)))</span></span><br><span class="line">	<span class="meta">#<span class="keyword">define</span> GCC_ALIGN(n) __attribute__((aligned(n)))</span></span><br><span class="line">	<span class="meta">#<span class="keyword">if</span> defined(_MSC_VER)</span></span><br><span class="line">		<span class="meta">#<span class="keyword">define</span> MS_ALIGN(n) __declspec(align(n)) <span class="comment">// With -fms-extensions, Clang will accept either alignment attribute</span></span></span><br><span class="line">	<span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line">	<span class="meta">#<span class="keyword">define</span> MS_ALIGN(n) __declspec(align(n))</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure>

<p>So <code>FTransform</code> requires 16-byte alignment.</p>
<blockquote>
<p>FTransform is implemented using vector intrinsics, and instances of it need to have 16-byte alignment. I think the stack is guaranteed to be aligned to 16-bytes on Win64 so the compiler can pass it on the stack correctly, but there’s no such guarantee on Win32 (which is what we use for shipping builds).</p>
</blockquote>
<p>Changing to pass by pointer or reference solves the issue (both passing by reference and pointer are <code>sizeof(void*)</code> in size):</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">AProps* <span class="title">SpawnProps</span><span class="params">(<span class="type">const</span> FTransform&amp; SpawnTransform)</span></span>;</span><br></pre></td></tr></table></figure>
<p>Related issues:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://answers.unrealengine.com/questions/50892/shipping-formal-parameter-with-declspecalign16-won.html">Shipping: formal parameter with declspec(align(‘16’)) won’t be aligned</a></li>
<li><a target="_blank" rel="noopener" href="https://answers.unrealengine.com/questions/362434/fvector4-error-not-usable-with-x32-game-package.html">FVector4 error not usable with x32 game package</a></li>
</ul>
<h3 id="UE-Packaging-Fails-Due-to-File-in-Use"><a href="#UE-Packaging-Fails-Due-to-File-in-Use" class="headerlink" title="UE Packaging Fails Due to File in Use"></a>UE Packaging Fails Due to File in Use</h3><ul>
<li>Engine version: 4.18.3</li>
<li>Packaging platform: Windows</li>
<li>Running mode: VR</li>
<li>Build Configuration: Shipping</li>
</ul>
<p>Error message log during packaging:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UATHelper: Packaging (Windows (64-bit)): Program.Main: ERROR: AutomationTool terminated with exception: System.IO.IOException: The process cannot access the file** ‘C:\YourProjectPath\Saved\StagedBuilds\WindowsNoEditor\Engine\Extras\Redist\en-us\UE4PrereqSetup_x64.exe’ **because it is being used by another process**.</span><br></pre></td></tr></table></figure>
<p>The error message during UE packaging indicates <strong>is being used by another process</strong> because the EpicGameLauncher is also running in the process; it can be closed before packaging.</p>
<h2 id="Online"><a href="#Online" class="headerlink" title="Online"></a>Online</h2><hr>
<h3 id="UE-Actor-Replication-Config"><a href="#UE-Actor-Replication-Config" class="headerlink" title="UE Actor Replication Config"></a>UE Actor Replication Config</h3><h3 id="Replication"><a href="#Replication" class="headerlink" title="Replication"></a>Replication</h3><p>OnlyRelevantToServer (default false)<br>If true, this actor is only relevant to its owner; if this flag is changed during play, all non-owner channels would need to be explicitly closed.</p>
<h3 id="Always-Relevant-default-false"><a href="#Always-Relevant-default-false" class="headerlink" title="Always Relevant (default false)"></a>Always Relevant (default false)</h3><p>Always relevant for network (overrides bOnlyRelevantToOwner)</p>
<h3 id="ReplicateMovement-default-true"><a href="#ReplicateMovement-default-true" class="headerlink" title="ReplicateMovement (default true)"></a>ReplicateMovement (default true)</h3><p>If true, replicate movement/location related properties.<br>Actor must also be set to replicate.</p>
<ol>
<li>see SetReplicates()</li>
<li>see <a target="_blank" rel="noopener" href="https://doc.unrealengine.com/latest/INT/Gameplay/Networking/Replication/">https://doc.unrealengine.com/latest/INT/Gameplay/Networking/Replication/</a></li>
</ol>
<h3 id="NetLoadOnClient-default-true"><a href="#NetLoadOnClient-default-true" class="headerlink" title="NetLoadOnClient (default true)"></a>NetLoadOnClient (default true)</h3><p>This actor will be loaded on network clients during map load.</p>
<h3 id="NetUseOwnerRelevancy-default-false"><a href="#NetUseOwnerRelevancy-default-false" class="headerlink" title="NetUseOwnerRelevancy (default false)"></a>NetUseOwnerRelevancy (default false)</h3><p>If the actor has a valid Owner, call Owner’s IsNetRelevantFor and GetNetPriority</p>
<h3 id="Replicates-default-true"><a href="#Replicates-default-true" class="headerlink" title="Replicates (default true)"></a>Replicates (default true)</h3><p>If true, this actor will replicate to remote machines<br>See SetReplicates()</p>
<h3 id="NetDormancy-default-DORM-Awake"><a href="#NetDormancy-default-DORM-Awake" class="headerlink" title="NetDormancy (default DORM_Awake)"></a>NetDormancy (default DORM_Awake)</h3><p>Dormancy setting for actor to take itself off the replication list without being destroyed on clients.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// This actor can go dormant, but is not currently dormant; Game code will tell it when it goes dormant.</span></span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">ENetDormancy</span></span><br><span class="line">&#123;</span><br><span class="line">    DORM_Never,</span><br><span class="line">    DORM_Awake,</span><br><span class="line">    DORM_DormantAll,</span><br><span class="line">    DORM_DormantPartial,</span><br><span class="line">    DORM_Initial,</span><br><span class="line">    DORM_MAX,</span><br><span class="line">&#125;</span><br><span class="line">DORM_Never: This actor can never go network dormant.</span><br><span class="line">DORM_Awake: This actor can go dormant, but is <span class="keyword">not</span> currently dormant. Game code will tell it when it goes dormant.</span><br><span class="line">DORM_DormantAll: This actor wants to go fully dormant <span class="keyword">for</span> all connections.</span><br><span class="line">DORM_DormantPartial: This actor may want to go dormant <span class="keyword">for</span> some connections; <span class="built_in">GetNetDormancy</span>() will be called to find out which.</span><br><span class="line">DORM_Initial: This actor is initially dormant <span class="keyword">for</span> all connections <span class="keyword">if</span> it was placed in the map.</span><br><span class="line">DORM_MAX</span><br></pre></td></tr></table></figure>

<h3 id="NeuCullDistanceSquared-default-225000000-0"><a href="#NeuCullDistanceSquared-default-225000000-0" class="headerlink" title="NeuCullDistanceSquared (default 225000000.0)"></a>NeuCullDistanceSquared (default 225000000.0)</h3><p>Square of the max distance from the client’s viewpoint that this actor is relevant and will be replicated.</p>
<h3 id="NetUpdateFrequency-default-100-0"><a href="#NetUpdateFrequency-default-100-0" class="headerlink" title="NetUpdateFrequency (default 100.0)"></a>NetUpdateFrequency (default 100.0)</h3><p>How often (per second) this actor will be considered for replication, used to determine NetUpdateTime.</p>
<h3 id="MinNetUpdateFrequency-default-2-0"><a href="#MinNetUpdateFrequency-default-2-0" class="headerlink" title="MinNetUpdateFrequency (default 2.0)"></a>MinNetUpdateFrequency (default 2.0)</h3><p>Used to determine what rate to throttle down to when replicated properties are changing infrequently.</p>
<h3 id="NetPriority-default-3-0"><a href="#NetPriority-default-3-0" class="headerlink" title="NetPriority: (default 3.0)"></a>NetPriority: (default 3.0)</h3><p>Priority for this actor when checking for replication in a low bandwidth or saturated situation; higher priority means it is more likely to replicate.</p>
<h3 id="Replicated-Movement"><a href="#Replicated-Movement" class="headerlink" title="Replicated Movement"></a>Replicated Movement</h3><p>LocationQuantization Level: (default EVectorQuantization::RoundTwoDecimals)</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">EVectorQuantization</span></span><br><span class="line">&#123;</span><br><span class="line">    RoundWholeNumber,</span><br><span class="line">    RoundOneDecimal,</span><br><span class="line">    RoundTwoDecimals,</span><br><span class="line">&#125;</span><br><span class="line">RoundWholeNumber: Each vector component will be rounded to the nearest whole number.</span><br><span class="line">RoundOneDecimal: Each vector component will be rounded, preserving one decimal place.</span><br><span class="line">RoundTwoDecimals: Each vector component will be rounded, preserving two decimal places.</span><br></pre></td></tr></table></figure>

<p>VelocityQuantization Level: (default ERotatorQuantization::RoundWholeNumber)</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">ERotatorQuantization</span></span><br><span class="line">&#123;</span><br><span class="line">    ByteComponents,</span><br><span class="line">    ShortComponents,</span><br><span class="line">&#125;</span><br><span class="line">ByteComponents: The rotator will be compressed to <span class="number">8</span> bits per component.</span><br><span class="line">ShortComponents: The rotator will be compressed to <span class="number">16</span> bits per component.</span><br></pre></td></tr></table></figure>

<h3 id="RotationQuantization-Level-default-ByteComponents"><a href="#RotationQuantization-Level-default-ByteComponents" class="headerlink" title="RotationQuantization Level (default ByteComponents)"></a>RotationQuantization Level (default ByteComponents)</h3><p>Allow tuning the compression level for replicated rotation. You should only need to change this from the default if you see visual artifacts.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">ERotatorQuantization</span></span><br><span class="line">&#123;</span><br><span class="line">    ByteComponents,</span><br><span class="line">    ShortComponents,</span><br><span class="line">&#125;</span><br><span class="line">ByteComponents: The rotator will be compressed to <span class="number">8</span> bits per component.</span><br><span class="line">ShortComponents: The rotator will be compressed to <span class="number">16</span> bits per component.</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="Disable-Automatic-Connection-When-Testing-Multiplayer-in-UE-Editor"><a href="#Disable-Automatic-Connection-When-Testing-Multiplayer-in-UE-Editor" class="headerlink" title="Disable Automatic Connection When Testing Multiplayer in UE Editor"></a>Disable Automatic Connection When Testing Multiplayer in UE Editor</h3><p><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/3380/UE-Editor-Play-Options.webp"><br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/3380/UE-Editor-Mulitplayer-AutoConnectToServer.webp"></p>
<h3 id="Some-Issues-When-Using-UE-Online"><a href="#Some-Issues-When-Using-UE-Online" class="headerlink" title="Some Issues When Using UE Online"></a>Some Issues When Using UE Online</h3><p>UE provides <code>AController::IsLocalControlled</code> to determine whether the current controller is controlling a local entity:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">AController::IsLocalController</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">const</span> ENetMode NetMode = <span class="built_in">GetNetMode</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (NetMode == NM_Standalone)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// Not networked.</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (NetMode == NM_Client &amp;&amp; Role == ROLE_AutonomousProxy)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// Networked client in control.</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">GetRemoteRole</span>() != ROLE_AutonomousProxy &amp;&amp; Role == ROLE_Authority)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">// Local authority in control.</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Note: Be cautious not to use the <code>AutoPossessPlayer</code> option in Pawn. This will cause the joining player’s Controller to be automatically assigned as Player0, resulting in strange bugs.</p>
</blockquote>
<p>There are also <code>UKismetSystemLibrary::IsServer</code>/<code>UKismetSystemLibrary::IsDedicatedServer</code>, which fetch the current <code>World</code>‘s <code>GetNetMode</code> for judgment:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">UKismetSystemLibrary::IsServer</span><span class="params">(UObject* WorldContextObject)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  UWorld* World = GEngine-&gt;<span class="built_in">GetWorldFromContextObject</span>(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);</span><br><span class="line">  <span class="keyword">return</span> World ? (World-&gt;<span class="built_in">GetNetMode</span>() != NM_Client) : <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">UKismetSystemLibrary::IsDedicatedServer</span><span class="params">(UObject* WorldContextObject)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  UWorld* World = GEngine-&gt;<span class="built_in">GetWorldFromContextObject</span>(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);</span><br><span class="line">  <span class="keyword">if</span> (World)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">return</span> (World-&gt;<span class="built_in">GetNetMode</span>() == NM_DedicatedServer);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">IsRunningDedicatedServer</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">UKismetSystemLibrary::IsStandalone</span><span class="params">(UObject* WorldContextObject)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  UWorld* World = GEngine-&gt;<span class="built_in">GetWorldFromContextObject</span>(WorldContextObject, EGetWorldErrorMode::LogAndReturnNull);</span><br><span class="line">  <span class="keyword">return</span> World ? (World-&gt;<span class="built_in">GetNetMode</span>() == NM_Standalone) : <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Members of <code>enum ENetMode</code> and their meanings are as follows:</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>NM_Standalone</td>
<td>Standalone: a game without networking, with one or more local players.</td>
</tr>
<tr>
<td>NM_DedicatedServer</td>
<td>Dedicated server: server with no local players.</td>
</tr>
<tr>
<td>NM_ListenServer</td>
<td>Listen server: a server that also has a local player who is hosting the game, available to other players on the network.</td>
</tr>
<tr>
<td>NM_Client</td>
<td>Network client: client connected to a remote server.</td>
</tr>
<tr>
<td>NM_MAX</td>
<td></td>
</tr>
</tbody></table>
<h3 id="Using-UE’s-OnlineSubsystem-for-Networking"><a href="#Using-UE’s-OnlineSubsystem-for-Networking" class="headerlink" title="Using UE’s OnlineSubsystem for Networking"></a>Using UE’s OnlineSubsystem for Networking</h3><p>UE networking can be accomplished via <code>CreateSession</code>/<code>FindSession</code>/<code>JoinSession</code>, but some simple configurations need to be done first.<br>Edit <code>Config\DefaultEngine.ini</code>, and add the following content:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">+NetDriverDefinitions=(DefName=&quot;GameNetDriver&quot;,DriverClassName=&quot;/Script/OnlineSubsystemSteam.SteamNetDriver&quot;,DriverClassNameFallback=&quot;/Script/OnlineSubsystemUtils.IpNetDriver&quot;)</span><br><span class="line"></span><br><span class="line">[OnlineSubsystem]</span><br><span class="line">DefaultPlatformService=Null</span><br></pre></td></tr></table></figure>
<p>Note the difference in integration with Steam; you should set <code>DefaultPlatformService</code> to <code>Null</code>, otherwise you won’t be able to join the session.</p>
<h3 id="UE-Networking-Client-Cannot-Pathfind"><a href="#UE-Networking-Client-Cannot-Pathfind" class="headerlink" title="UE Networking Client Cannot Pathfind"></a>UE Networking Client Cannot Pathfind</h3><p>You need to set <code>Allow Client Side Navigation</code> to true in <code>Project Settings</code> - <code>NavigationSystem</code>:<br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/3380/ue4-client-not-generate-navigation.webp"></p>
<h3 id="UE-Sessions-Not-Found-in-LAN"><a href="#UE-Sessions-Not-Found-in-LAN" class="headerlink" title="UE Sessions Not Found in LAN"></a>UE Sessions Not Found in LAN</h3><p>After creating a session using <code>CreateSession</code>, if you cannot find the session list using <code>FindSession</code> on another machine in LAN, the cause is that the computer has VM or VirtualBox installed. Disabling the <code>VMware Network Adapter</code> or <code>VirtualBox Network Adapter</code> will resolve the issue.<br>The specific location in the control panel is <code>Control Panel/Network and Internet/Network and Sharing Center/Change Adapter Settings</code>:<br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/3380/fixd-UE-session-cant-search-in-LAN.webp"></p>
<h2 id="Other-Script"><a href="#Other-Script" class="headerlink" title="Other Script"></a>Other Script</h2><h3 id="Unexplained-Compilation-and-Linking-Errors-in-UE"><a href="#Unexplained-Compilation-and-Linking-Errors-in-UE" class="headerlink" title="Unexplained Compilation and Linking Errors in UE"></a>Unexplained Compilation and Linking Errors in UE</h3><p>It’s best to delete the following files after modifying the code:</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Binaries</span><br><span class="line">Debug</span><br><span class="line">Intermediate</span><br><span class="line">Saved (note that packaging cache can be left)</span><br><span class="line">*.VC.db</span><br></pre></td></tr></table></figure>
<p>The bat script is as follows:</p>
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">del</span> *.VC.db</span><br><span class="line"><span class="built_in">rd</span> /s /q Binaries</span><br><span class="line"><span class="built_in">rd</span> /s /q Debug</span><br><span class="line"><span class="built_in">rd</span> /s /q Intermediate</span><br><span class="line"><span class="built_in">rd</span> /s /q Saved</span><br></pre></td></tr></table></figure>
<p>Also, search all plugin directories for Binaries and Intermediate:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ find . -name <span class="string">&quot;Binaries&quot;</span>|xargs <span class="built_in">rm</span> -rf</span><br><span class="line">$ find . -name <span class="string">&quot;Intermediate&quot;</span>|xargs <span class="built_in">rm</span> -rf</span><br></pre></td></tr></table></figure>

<h2 id="Profiling-Commands"><a href="#Profiling-Commands" class="headerlink" title="Profiling Commands"></a>Profiling Commands</h2><p><strong>Display FPS</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">stat</span> FPS</span><br></pre></td></tr></table></figure>
<p><strong>Display Stat Units</strong> (total time per frame, logic thread/render thread and GPU consumption):</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">stat</span> Unit</span><br></pre></td></tr></table></figure>
<p><strong>Display Various Parameter Values in the Render Thread</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Stat SceneRendering</span><br></pre></td></tr></table></figure>

<p><strong>Display Consumption of Render Thread Commands</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">stat</span> RenderThreadCommands</span><br></pre></td></tr></table></figure>

<p><strong>Display Parameters on the Game Thread</strong> (AI/Physics/Animation/Blueprint/Memory Allocation, etc.)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">stat</span> game</span><br></pre></td></tr></table></figure>

<p><strong>Display Time and Efficiency Data Required for Culling</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Stat InitViews</span><br></pre></td></tr></table></figure>

<p><strong>Display the Time Required for Lighting and Shading Rendering</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Stat LightRendering</span><br></pre></td></tr></table></figure>

<p><strong>Capture GPU Information for the Current Frame</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ProfileGPU</span><br></pre></td></tr></table></figure>
<p>This will pop up the <code>GPU Data Visualizer</code> showing the data for the captured frame.</p>
<p><strong>Capture Profiling Information (CPU/GPU)</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">stat</span> StartFile</span><br><span class="line"><span class="built_in">stat</span> StopFile</span><br></pre></td></tr></table></figure>
<p>This will generate <code>*.ue4stats</code> files in the project’s <code>Saved/Profiling/UnrealStats</code> directory, which can be opened using UnrealFrontend.</p>
<p><strong>UE Network Analysis</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Start and stop recording</span></span><br><span class="line">netprofile</span><br><span class="line"><span class="comment"># If not already recording, start recording</span></span><br><span class="line">netprofile <span class="built_in">enable</span></span><br><span class="line"><span class="comment"># If currently recording, stop recording</span></span><br><span class="line">netprofile <span class="built_in">disable</span></span><br></pre></td></tr></table></figure>
<p>Captured data will be saved in <code>Saved/Profiling</code> with the extension <code>*.nprof</code>.<br>Documentation for the UE Network Profiler tool can be found at <a target="_blank" rel="noopener" href="https://docs.unrealengine.com/en-us/Gameplay/Tools/NetworkProfiler">Network Profiler</a>.</p>
<p>Links:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://docs.unrealengine.com/en-us/Engine/Performance">Performance and Profiling</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.unrealengine.com/en-us/Engine/Performance/GPU">GPU Profiling</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.unrealengine.com/en-us/Engine/Performance/StatCommands">Stat Commands</a></li>
<li><a target="_blank" rel="noopener" href="https://software.intel.com/en-us/articles/vr-developer-tutorial-testing-and-profiling-the-premium-vr-game">VR Developer Tutorial: Testing and Profiling the Premium VR Game</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.unrealengine.com/en-us/Gameplay/Tools/NetworkProfiler">Network Profiler</a></li>
</ul>

    </div>

    
    
        
        
          
            <blockquote class="blockquote-center">
              
                The article is finished. If you have any questions, please comment and communicate.
              
            <br/>
            
                <div class="qr-code" onclick="return false">
                    <script src="/js/qrcode.min.js"></script>
                    <div id="qrcode">
                      
                        <img src="https://imzlp.com/images/wechat-qrcode.webp">
                      
                    <p>Scan the QR code on WeChat and follow me.</p>
                    </div>
                </div>
            
            </blockquote>
          
        

        
          <div class="postCopyright" style="clear:both;">
             <span>Title:</span><a href="/posts/3380/" target="_blank">UE and VR Development Technical Notes</a><br/>
             <span>Author:</span><a href="/about" target="_blank" title="查看 LIPENGZHA 的资料">LIPENGZHA</a><br/>
             <span>Publish Date:</span>2018/06/06 08:16<br/>
             
              <span>Update Date:</span>2019/01/17 14:00<br/>
             
             <span>Word Count:</span><span class="page-count">27k Words</span><br/>
             
             <span>Link:</span><a href="/posts/3380/" target="_blank" title="UE and VR Development Technical Notes">https://en.imzlp.com/posts/3380/</a>
             <span class="copy-path" data-clipboard-text="Link: https://en.imzlp.com/posts/3380/ Author: LIPENGZHA" title="点击复制文章链接"><i class="fa fa-clipboard"></i></span>
             <script src="/js/jquery.min.js"></script>
             <script src="/js/clipboard.min.js"></script>
             <script> var clipboard = new Clipboard('.copy-path'); </script>
             <br/>
             
             <span>License:</span><i class="fab fa-creative-commons"></i> <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" title="Attribution-NonCommercial-ShareAlike 4.0 International">CC BY-NC-SA 4.0</a><br/>
             
             <span>Reprinting of the full article is prohibited.</span>
          </div>
        
    

        
  <div class="reward-container">
    <div>Your donation will encourage me to keep creating!</div>
    <button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
      Donate
    </button>
    <div id="qr" style="display: none;">
        
        <div style="display: inline-block;">
          <img src="/images/reward/wechatpay.webp" alt="LIPENGZHA WeChat Pay">
          <p>WeChat Pay</p>
        </div>

    </div>
  </div>



      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/UnrealEngine/" rel="tag"># UnrealEngine</a>
              <a href="/tags/VR/" rel="tag"># VR</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/posts/5050/" rel="prev" title="Use frp to penetrate the intranet">
      <i class="fa fa-chevron-left"></i> Use frp to penetrate the intranet
    </a></div>
      <div class="post-nav-item">
    <a href="/posts/19376/" rel="next" title="Pass Actor To Next Level Through Seamless Travel">
      Pass Actor To Next Level Through Seamless Travel <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
      <div class="tabs tabs-comment">
        <ul class="nav-tabs">
            <li class="tab"><a href="#comment-utteranc">utteranc</a></li>
            <li class="tab"><a href="#comment-valine">valine</a></li>
        </ul>
        <div class="tab-content">
            <div class="tab-pane utteranc" id="comment-utteranc">
              
  
  <div class="comments">
  <script src="https://utteranc.es/client.js" repo="hxhb/blog-comments" issue-term="pathname" theme="github-light" crossorigin="anonymous" async></script>
  </div>
  
  
            </div>
            <div class="tab-pane valine" id="comment-valine">
              <div class="comments" id="valine-comments"></div>
            </div>
        </div>
      </div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Engine-Documents"><span class="nav-number">1.</span> <span class="nav-text">Engine Documents</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#UE4-Online-Documents"><span class="nav-number">1.1.</span> <span class="nav-text">UE4 Online Documents</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#UE-GamePlay-Framework-Tutorial"><span class="nav-number">1.2.</span> <span class="nav-text">UE GamePlay Framework Tutorial</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#VR-Devices"><span class="nav-number">2.</span> <span class="nav-text">VR Devices</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Height-Issue-When-Adapting-Different-VR-Devices-in-UE"><span class="nav-number">2.1.</span> <span class="nav-text">Height Issue When Adapting Different VR Devices in UE</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#VR-Headset-Initialization-When-Starting-the-Game-in-UE"><span class="nav-number">2.2.</span> <span class="nav-text">VR Headset Initialization When Starting the Game in UE</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Reset-VR-Headset-Rotation-and-Position"><span class="nav-number">2.3.</span> <span class="nav-text">Reset VR Headset Rotation and Position</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Using-Oculus-Rift-in-UE"><span class="nav-number">2.4.</span> <span class="nav-text">Using Oculus Rift in UE</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HTC-Vive-Key-Mapping"><span class="nav-number">2.5.</span> <span class="nav-text">HTC Vive Key Mapping</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HTC-VIVE-Device-Setup"><span class="nav-number">2.6.</span> <span class="nav-text">HTC VIVE Device Setup</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SteamVR-2-0-Base-Stations"><span class="nav-number">2.7.</span> <span class="nav-text">SteamVR 2.0 Base Stations</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Using-Proxifier-to-Route-Oculus-through-SS-Proxy"><span class="nav-number">2.8.</span> <span class="nav-text">Using Proxifier to Route Oculus through SS Proxy</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#VR-Blurriness-Issue"><span class="nav-number">2.9.</span> <span class="nav-text">VR Blurriness Issue</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Solution-for-HTC-VIVE-Tracker-Fault-03"><span class="nav-number">2.10.</span> <span class="nav-text">Solution for HTC VIVE Tracker Fault (03)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Engine-Analysis"><span class="nav-number">3.</span> <span class="nav-text">Engine Analysis</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Starting-UE-Game"><span class="nav-number">3.1.</span> <span class="nav-text">Starting UE Game</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Actor-Initialization-in-UE"><span class="nav-number">3.2.</span> <span class="nav-text">Actor Initialization in UE</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#UE4-Engine-Start-Order"><span class="nav-number">3.3.</span> <span class="nav-text">UE4: Engine Start Order</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#UE-Engine-Tick-Call-Stack"><span class="nav-number">3.4.</span> <span class="nav-text">UE Engine Tick Call Stack</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Game-Flow-on-UE4"><span class="nav-number">3.5.</span> <span class="nav-text">Game Flow on UE4</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Actor-LifeCycle"><span class="nav-number">3.6.</span> <span class="nav-text">Actor LifeCycle</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#UE-Log-Macros-Defined"><span class="nav-number">3.7.</span> <span class="nav-text">UE Log Macros Defined</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Method-to-Detect-if-Engine-is-Installed-Version"><span class="nav-number">3.8.</span> <span class="nav-text">Method to Detect if Engine is Installed Version</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#UE-Get-all-registered-Engines"><span class="nav-number">3.9.</span> <span class="nav-text">UE:Get all registered Engines</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#UnrealVersionSelector-Registered-Engine-Path"><span class="nav-number">3.10.</span> <span class="nav-text">UnrealVersionSelector Registered Engine Path</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#EpicGameLauncher-Version-Engine-Registry-Path"><span class="nav-number">3.11.</span> <span class="nav-text">EpicGameLauncher Version Engine Registry Path</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#UnrealVersionSelector-Registry-File-Association"><span class="nav-number">3.12.</span> <span class="nav-text">UnrealVersionSelector Registry File Association</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#UE-Registered-Compiled-Engine-Installation-Path"><span class="nav-number">3.13.</span> <span class="nav-text">UE Registered Compiled Engine Installation Path</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Resolving-uproject-Right-Click-Generation-Failure"><span class="nav-number">3.14.</span> <span class="nav-text">Resolving .uproject Right-Click Generation Failure</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#GamePlay"><span class="nav-number">4.</span> <span class="nav-text">GamePlay</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#UE-Macro-Library-Issues"><span class="nav-number">4.1.</span> <span class="nav-text">UE Macro Library Issues</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#UE-Saved-Directory-When-Packing-in-Shipping-Mode"><span class="nav-number">4.2.</span> <span class="nav-text">UE Saved Directory When Packing in Shipping Mode</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CharacterMovement-Enabling-RVO-Obstacle-Avoidance"><span class="nav-number">4.3.</span> <span class="nav-text">CharacterMovement Enabling RVO Obstacle Avoidance</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#VR-Bow-Model-Standards"><span class="nav-number">4.4.</span> <span class="nav-text">VR Bow Model Standards</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Implementation-of-Outfit-Change-in-UE"><span class="nav-number">4.5.</span> <span class="nav-text">Implementation of Outfit Change in UE</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Compiling-Blueprint-to-C-Code-in-UE"><span class="nav-number">4.6.</span> <span class="nav-text">Compiling Blueprint to C++ Code in UE</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#UE-Blueprint-Function-Library-Cannot-Be-Called-in-UObject"><span class="nav-number">4.7.</span> <span class="nav-text">UE Blueprint Function Library Cannot Be Called in UObject</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Placing-Components-into-Bone-Sockets-in-UE"><span class="nav-number">4.8.</span> <span class="nav-text">Placing Components into Bone Sockets in UE</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Converting-3D-Positions-in-Game-Scenes-to-Screen-Positions"><span class="nav-number">4.9.</span> <span class="nav-text">Converting 3D Positions in Game Scenes to Screen Positions</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Setting-the-Mouse-Cursor%E2%80%99s-Relative-Position-in-Viewport"><span class="nav-number">4.10.</span> <span class="nav-text">Setting the Mouse Cursor’s Relative Position in Viewport</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Mouse-Focus-Not-in-Window-After-Starting-Game-in-UE"><span class="nav-number">4.11.</span> <span class="nav-text">Mouse Focus Not in Window After Starting Game in UE</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Determining-if-a-Particle-Effect-is-Looping"><span class="nav-number">4.12.</span> <span class="nav-text">Determining if a Particle Effect is Looping</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Cross-Module-Class-Symbol-Export-Considerations"><span class="nav-number">4.13.</span> <span class="nav-text">Cross-Module Class Symbol Export Considerations</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Creating-Asynchronous-Nodes-in-Blueprints"><span class="nav-number">4.14.</span> <span class="nav-text">Creating Asynchronous Nodes in Blueprints</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#UE-Warning-Error-for-Including-Windows-Header-Files"><span class="nav-number">4.15.</span> <span class="nav-text">UE Warning&#x2F;Error for Including Windows Header Files</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Getting-the-Relative-Ratio-of-the-Cursor-in-the-Window-in-UE"><span class="nav-number">4.16.</span> <span class="nav-text">Getting the Relative Ratio of the Cursor in the Window in UE</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Gamma-Value-of-SceneCapture2D"><span class="nav-number">4.17.</span> <span class="nav-text">Gamma Value of SceneCapture2D</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#A-Cool-Trick-with-Event-Parameters-in-Blueprints"><span class="nav-number">4.18.</span> <span class="nav-text">A Cool Trick with Event Parameters in Blueprints</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Collision-Detection-Issues-with-UProjectileMovementComponent-in-UE"><span class="nav-number">4.19.</span> <span class="nav-text">Collision Detection Issues with UProjectileMovementComponent in UE</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Config-and-Editor"><span class="nav-number">5.</span> <span class="nav-text">Config and Editor</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Modifying-the-Esc-Key-to-Exit-Editor-Mode-in-UE"><span class="nav-number">5.1.</span> <span class="nav-text">Modifying the Esc Key to Exit Editor Mode in UE</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Displaying-Plugin-Content-in-Editor"><span class="nav-number">5.2.</span> <span class="nav-text">Displaying Plugin Content in Editor</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Modifying-Parallel-Count-During-UE-Compilation"><span class="nav-number">5.3.</span> <span class="nav-text">Modifying Parallel Count During UE Compilation</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Storing-Data-in-OBB-Files-When-Packaging-for-Android-in-UE"><span class="nav-number">5.4.</span> <span class="nav-text">Storing Data in OBB Files When Packaging for Android in UE</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Lag-Issues-in-Editor-Mode-When-Focus-is-Not-in-Window-in-UE"><span class="nav-number">5.5.</span> <span class="nav-text">Lag Issues in Editor Mode When Focus is Not in Window in UE</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Resolving-Chinese-Character-Encoding-Issues-in-UE-Compiler-Logs-on-Windows-10"><span class="nav-number">5.6.</span> <span class="nav-text">Resolving Chinese Character Encoding Issues in UE Compiler Logs on Windows 10</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Package"><span class="nav-number">6.</span> <span class="nav-text">Package</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ObservedKeyNames-Num-gt-0"><span class="nav-number">6.1.</span> <span class="nav-text">ObservedKeyNames.Num()&gt;0</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#UE-Package-Error-RenderDocPlugin"><span class="nav-number">6.2.</span> <span class="nav-text">UE Package Error:RenderDocPlugin</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#UE-Packaging-Fails-Due-to-File-in-Use"><span class="nav-number">6.3.</span> <span class="nav-text">UE Packaging Fails Due to File in Use</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Online"><span class="nav-number">7.</span> <span class="nav-text">Online</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#UE-Actor-Replication-Config"><span class="nav-number">7.1.</span> <span class="nav-text">UE Actor Replication Config</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Replication"><span class="nav-number">7.2.</span> <span class="nav-text">Replication</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Always-Relevant-default-false"><span class="nav-number">7.3.</span> <span class="nav-text">Always Relevant (default false)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ReplicateMovement-default-true"><span class="nav-number">7.4.</span> <span class="nav-text">ReplicateMovement (default true)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#NetLoadOnClient-default-true"><span class="nav-number">7.5.</span> <span class="nav-text">NetLoadOnClient (default true)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#NetUseOwnerRelevancy-default-false"><span class="nav-number">7.6.</span> <span class="nav-text">NetUseOwnerRelevancy (default false)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Replicates-default-true"><span class="nav-number">7.7.</span> <span class="nav-text">Replicates (default true)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#NetDormancy-default-DORM-Awake"><span class="nav-number">7.8.</span> <span class="nav-text">NetDormancy (default DORM_Awake)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#NeuCullDistanceSquared-default-225000000-0"><span class="nav-number">7.9.</span> <span class="nav-text">NeuCullDistanceSquared (default 225000000.0)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#NetUpdateFrequency-default-100-0"><span class="nav-number">7.10.</span> <span class="nav-text">NetUpdateFrequency (default 100.0)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MinNetUpdateFrequency-default-2-0"><span class="nav-number">7.11.</span> <span class="nav-text">MinNetUpdateFrequency (default 2.0)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#NetPriority-default-3-0"><span class="nav-number">7.12.</span> <span class="nav-text">NetPriority: (default 3.0)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Replicated-Movement"><span class="nav-number">7.13.</span> <span class="nav-text">Replicated Movement</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#RotationQuantization-Level-default-ByteComponents"><span class="nav-number">7.14.</span> <span class="nav-text">RotationQuantization Level (default ByteComponents)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Disable-Automatic-Connection-When-Testing-Multiplayer-in-UE-Editor"><span class="nav-number">7.15.</span> <span class="nav-text">Disable Automatic Connection When Testing Multiplayer in UE Editor</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Some-Issues-When-Using-UE-Online"><span class="nav-number">7.16.</span> <span class="nav-text">Some Issues When Using UE Online</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Using-UE%E2%80%99s-OnlineSubsystem-for-Networking"><span class="nav-number">7.17.</span> <span class="nav-text">Using UE’s OnlineSubsystem for Networking</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#UE-Networking-Client-Cannot-Pathfind"><span class="nav-number">7.18.</span> <span class="nav-text">UE Networking Client Cannot Pathfind</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#UE-Sessions-Not-Found-in-LAN"><span class="nav-number">7.19.</span> <span class="nav-text">UE Sessions Not Found in LAN</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Other-Script"><span class="nav-number">8.</span> <span class="nav-text">Other Script</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Unexplained-Compilation-and-Linking-Errors-in-UE"><span class="nav-number">8.1.</span> <span class="nav-text">Unexplained Compilation and Linking Errors in UE</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Profiling-Commands"><span class="nav-number">9.</span> <span class="nav-text">Profiling Commands</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person" oncontextmenu="return false" οndragstart="return false">
    <img class="site-author-image" itemprop="image" alt="LIPENGZHA"
      src="https://img.imzlp.com/imgs/zlp/picgo/2023/202304152112902.webp">
  <p class="site-author-name" itemprop="name">LIPENGZHA</p>
  <div class="site-description" itemprop="description">"I think, therefore I am"</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
             
          <span class="site-state-item-count">190</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">95</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">190</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/hxhb" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;hxhb" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://linkedin.com/in/lipengzha" title="Linkedin → https:&#x2F;&#x2F;linkedin.com&#x2F;in&#x2F;lipengzha" rel="noopener" target="_blank"><i class="fab fa-linkedin fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.zhihu.com/people/imzlp" title="知乎 → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;imzlp" rel="noopener" target="_blank"><i class="fa fa-custom zhihu fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="/images/wechat-qrcode-offical.webp" title="微信公众号 → &#x2F;images&#x2F;wechat-qrcode-offical.webp"><i class="fab fa-weixin fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:imzlp@foxmail.com" title="E-Mail → mailto:imzlp@foxmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="/atom.xml" title="RSS → &#x2F;atom.xml"><i class="fa fa-rss fa-fw"></i></a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://consolehelp.imzlp.com/" title="https:&#x2F;&#x2F;consolehelp.imzlp.com&#x2F;" rel="noopener" target="_blank">UE Console Help</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://imzlp.com/opensource/" title="https:&#x2F;&#x2F;imzlp.com&#x2F;opensource&#x2F;" rel="noopener" target="_blank">Open Source Projects</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://imzlp.com/posts/11515/" title="https:&#x2F;&#x2F;imzlp.com&#x2F;posts&#x2F;11515&#x2F;" rel="noopener" target="_blank">UE C++ API Dash Documents</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://ue5wiki.com/" title="https:&#x2F;&#x2F;ue5wiki.com&#x2F;" rel="noopener" target="_blank">Unreal Engine Wiki</a>
        </li>
    </ul>
  </div>

      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2014 – 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">LIPENGZHA</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="Symbols count total">1.5m</span>
</div>
  <div class="powered-by-other">
    
	    <center>Github Pages | Actions | NeXT | Cloudflare | Hexo Deploy</center>
      
  </div>

<script>
function checkWebp(callback) {
    var img = new Image();
    img.onload = function () { callback((img.width > 0) && (img.height > 0)); };
    img.onerror = function () { callback(false); };
    img.src = 'data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA';
}
function showImage(useWebp) {
    var imgs = [].slice.call(document.querySelectorAll('img'));
    imgs.forEach(function (e) {
        if (!useWebp) {
            var src = e.getAttribute('data-src')
            src = src.replace(/\.webp$/, '.png');
            e.setAttribute('data-src', src);
        }
    });
}
checkWebp(showImage);
</script>

        








      </div>
    </footer>
  </div>

  
  <script src="//lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/animejs/3.2.1/anime.min.js"></script>
  <script src="//lf9-cdn-tos.bytecdntp.com/cdn/expire-1-M/jquery/3.5.1/jquery.min.js"></script>
  <script src="//lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/fancybox/3.5.7/jquery.fancybox.min.js"></script>
  <script src="//lf9-cdn-tos.bytecdntp.com/cdn/expire-1-M/lozad.js/1.16.0/lozad.min.js"></script>
  <script src="//lf9-cdn-tos.bytecdntp.com/cdn/expire-1-M/pangu/4.0.7/pangu.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>



<script src="/js/code-unfold.js"></script>

  
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>




  
<script src="/js/local-search.js"></script>









<script>
document.querySelectorAll('.pdfobject-container').forEach(element => {
  let url = element.dataset.target;
  let pdfOpenParams = {
    navpanes : 0,
    toolbar  : 0,
    statusbar: 0,
    pagemode : 'thumbs',
    view     : 'FitH'
  };
  let pdfOpenFragment = '#' + Object.entries(pdfOpenParams).map(([key, value]) => `${key}=${encodeURIComponent(value)}`).join('&');
  let fullURL = `/lib/pdf/web/viewer.html?file=${encodeURIComponent(url)}${pdfOpenFragment}`;

  if (NexT.utils.supportsPDFs()) {
    element.innerHTML = `<embed class="pdfobject" src="${url + pdfOpenFragment}" type="application/pdf" style="height: ${element.dataset.height};">`;
  } else {
    element.innerHTML = `<iframe src="${fullURL}" style="height: ${element.dataset.height};" frameborder="0"></iframe>`;
  }
});
</script>


<script>
if (document.querySelectorAll('pre.mermaid').length) {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js', () => {
    mermaid.initialize({
      theme    : 'forest',
      logLevel : 3,
      flowchart: { curve     : 'linear' },
      gantt    : { axisFormat: '%m/%d/%Y' },
      sequence : { actorMargin: 50 }
    });
  }, window.mermaid);
}
</script>


  

  

  
  <script src="//img.imzlp.com/imgs/zlp/picgo/2021/quicklink.umd.js"></script>
  <script>
      window.addEventListener('load', () => {
      quicklink({
        timeout : 3000,
        priority: true,
        ignores : [uri => uri.includes('#'),uri => uri === 'https://en.imzlp.com/posts/3380/',]
      });
      });
  </script>


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//lf26-cdn-tos.bytecdntp.com/cdn/expire-1-M/valine/1.4.14/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    var requiredFields = 'nick';
    requiredFields = requiredFields.split(',');
    
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'oCE6RMVkVoi5MgUhvFsn1EvV-gzGzoHsz',
      appKey     : 'K9SOaNYJ8PV6xaoFggWG5xvv',
      placeholder: "Leave something behind~",
      avatar     : 'robohash',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : true,
      lang       : 'en' || 'zh-cn',
      path       : location.pathname,
      recordIP   : true,
      serverURLs : '',
      requiredFields: requiredFields
    });
  }, window.Valine);
});
</script>

</body>
</html>
