<!DOCTYPE html>
<html lang="en,default">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon-32x32-tilt-brush.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-tilt-brush.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-tilt-brush.png">
  <link rel="mask-icon" href="/images/favicon-32x32-tilt-brush.png" color="#222">
  <meta name="google-site-verification" content="ttIkhAIFZQM9Huj8roB0l95ePN2Tv2zv2wRFksi09WA">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Noto Serif SC:300,300italic,400,400italic,700,700italic|Pacifico:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Roboto Mono:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="//lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/font-awesome/5.15.2/css/all.min.css">
  <link rel="stylesheet" href="//lf9-cdn-tos.bytecdntp.com/cdn/expire-1-M/fancybox/3.5.7/jquery.fancybox.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"en.imzlp.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false,"width":280},"copycode":{"enable":true,"show_result":true,"style":"flat"},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"manual"},"fancybox":true,"mediumzoom":false,"lazyload":true,"pangu":true,"comments":{"style":"tabs","active":"valine","storage":true,"lazyload":false,"nav":null,"activeClass":"valine"},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"code_unfold":{"enable":true,"CODE_MAX_HEIGHT":600},"path":"search.xml"};
  </script>

  <meta name="description" content="HotPatcher project has been open source for over a year, undergoing numerous updates and optimizations. It has increasingly been chosen by developers as a hot update solution for their projects. Durin">
<meta property="og:type" content="article">
<meta property="og:title" content="UE Hot update: Questions &amp; Answers">
<meta property="og:url" content="https://en.imzlp.com/posts/16895/index.html">
<meta property="og:site_name" content="Z&#39;s Blog">
<meta property="og:description" content="HotPatcher project has been open source for over a year, undergoing numerous updates and optimizations. It has increasingly been chosen by developers as a hot update solution for their projects. Durin">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://img.imzlp.com/imgs/zlp/picgo/2023/20230206152457.webp">
<meta property="article:published_time" content="2021-03-12T10:45:44.000Z">
<meta property="article:modified_time" content="2021-03-12T10:45:44.000Z">
<meta property="article:author" content="LIPENGZHA">
<meta property="article:tag" content="UnrealEngine">
<meta property="article:tag" content="热更新">
<meta property="article:tag" content="HotPatcher">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://img.imzlp.com/imgs/zlp/picgo/2023/20230206152457.webp">

<link rel="canonical" href="https://en.imzlp.com/posts/16895/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>UE Hot update: Questions & Answers | Z's Blog</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-FDCJ41EFP5"></script>
    <script>
      if (CONFIG.hostname === location.hostname) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-FDCJ41EFP5');
      }
    </script>






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.staticfile.org/lxgw-wenkai-screen-webfont/1.7.0/style.min.css" /><!-- hexo injector head_end end --><link rel="alternate" href="/atom.xml" title="Z's Blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Z's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        
            
  <li class="menu-item menu-item-notes">

    <a href="/notes/" rel="section"><i class="fa fa-edit fa-fw"></i>Notes</a>

  </li>


      
        
            
  <li class="menu-item menu-item-essay">

    <a href="/essay/" rel="section"><i class="fas fa-feather-alt fa-fw"></i>Essay</a>

  </li>


      
        
            
  <li class="menu-item menu-item-resources">

    <a href="/resources/" rel="section"><i class="fa fa-inbox fa-fw"></i>Resources</a>

  </li>


      
        <li class="menu-item menu-item-friends">

    <a href="/friends/" rel="section"><i class="fas fa-link fa-fw"></i>Friends</a>

  </li>
        
            
  <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About Me</a>

  </li>


      
        <li class="menu-item menu-item-showcase">

    <a href="/showcase/" rel="section"><i class="fa fa-solid fa-trophy fa-fw"></i>ShowCase</a>

  </li>
        <li class="menu-item menu-item-changelog">

    <a href="/changelog/" rel="section"><i class="fa fa-history fa-fw"></i>Site Log</a>

  </li>
        <li class="menu-item menu-item-opensource">

    <a href="/opensource/" rel="section"><i class="fas fa-code-branch fa-fw"></i>Open Source</a>

  </li>
        <li class="menu-item menu-item-uewiki">

    <a href="https://ue5wiki.com/" rel="noopener" target="_blank"><i class="fab fa-wikipedia-w fa-fw"></i>Unreal Wiki</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>



<script type="text/javascript">
  let domain='en.imzlp.com';
  let domain_str = atob(domain);
  let pathname = location.pathname;
  if (domain_str!= location.host.toLowerCase()){
        console.log(`this host is not safe,jump to https://${domain_str}${pathname}`);
        location.href=`https://${domain_str}${pathname}`;
  }
</script>

</div>
    </header>

    
  <div class="reading-progress-bar"></div>
  <div class="l10n-header-widget">
    <script>
      // 获取当前页面的 URL
      const currentUrl = window.location.href;
      // 替换 URL 中的部分内容
      const jumpToL10nLink = currentUrl.replace('en.imzlp.com', 'imzlp.com');
      // 将 jumpToL10nLink 绑定到一个全局变量
      window.jumpToL10nLink = jumpToL10nLink;
    </script>

    <a href="#" class="post-l10n-link" title="切换至中文版本" style="float: left;border-bottom: none;" rel="noopener" target="_blank" onclick="window.open(window.jumpToL10nLink, '_blank'); return false;">
      <i class="fa fa-solid fa-language"></i>
    </a>
  </div>



    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en"
  >
    <link itemprop="mainEntityOfPage" href="https://en.imzlp.com/posts/16895/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://img.imzlp.com/imgs/zlp/picgo/2023/202304152112902.webp">
      <meta itemprop="name" content="LIPENGZHA">
      <meta itemprop="description" content=""I think, therefore I am"">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Z's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          UE Hot update: Questions & Answers<a href="https://github.com/imzlp/blog-md/blob/en/_posts/2021-03-13-16895.md" class="post-edit-link" title="Edit this post" style="float: right;border-bottom: 0px;" rel="noopener" target="_blank"><i class="fa fa-pen-nib"></i></a><a href="https://imzlp.com/posts/16895/" class="post-l10n-link" title="切换至中文版本" style="float: left;border-bottom: 0px;" rel="noopener" target="_blank"><i class="fa fa-solid fa-language"></i></a>
        </h1>

        
          <div class="post-subtitle" style="text-align: center;line-height: 1;">
            <sub text-align="center" style="font-size: 15px;align-content: center;font-style: italic;bottom: 0em;">UE热更新：Questions & Answers</sub>
          </div>
        

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-03-12 10:45 10:45:44:45" itemprop="dateCreated datePublished" datetime="2021-03-12T10:45:44+00:00">2021-03-12 10:45</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/UnrealEngine/" itemprop="url" rel="index"><span itemprop="name">UnrealEngine</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/UnrealEngine/%E7%83%AD%E6%9B%B4%E6%96%B0/" itemprop="url" rel="index"><span itemprop="name">热更新</span></a>
                </span>
            </span>

          
            <span id="/posts/16895/" class="post-meta-item leancloud_visitors" data-flag-title="UE Hot update: Questions & Answers" title="Views">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <br>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">Symbols count in article: </span>
              <span>16k</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">Reading time &asymp;</span>
              <span>39 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p><a target="_blank" rel="noopener" href="https://github.com/hxhb/HotPatcher">HotPatcher</a> project has been open source for over a year, undergoing numerous updates and optimizations. It has increasingly been chosen by developers as a hot update solution for their projects. During this time, many have inquired about common issues related to UE4 hot updates, which I noticed frequently repeated, so I decided to organize these common questions to help newcomers quickly troubleshoot the UE4 hot update solution.</p>
<p>This article will continually update the Q&amp;A content related to UE4 hot updates and <a target="_blank" rel="noopener" href="https://github.com/hxhb/HotPatcher">HotPatcher</a>. If you have any questions, feel free to comment directly on this article. I will periodically consolidate responses. You can also join my UE4 hot update group to discuss encountered issues (QQ group 958363331).</p>
<span id="more"></span>

<h2 id="Questions-Related-to-HotPatcher"><a href="#Questions-Related-to-HotPatcher" class="headerlink" title="Questions Related to HotPatcher"></a>Questions Related to HotPatcher</h2><ol>
<li>Can it be used in commercial projects?</li>
</ol>
<p><strong>The open-source license of this software: allows free use of functionality in commercial projects, but does not permit any third party to charge fees in any form based on this plugin, including but not limited to charging for recorded courses, redistributing the plugin and code, etc.</strong></p>
<ol start="2">
<li><p>Can C++ be hot updated?<br>No, it can only be used to update uasset and Non-Asset (lua/db/json, etc.).</p>
</li>
<li><p>Does it support hot updating on mobile platforms?<br>Yes, <a target="_blank" rel="noopener" href="https://github.com/hxhb/HotPatcher">HotPatcher</a> has no platform restrictions and can package and manage any platform supported by UE.</p>
</li>
</ol>
<p>Note: When using HotPatcher for packaging, avoid a directory containing both uasset and non-asset files, as this will result in un-cooked uasset packaging.</p>
<h2 id="Series-of-Articles-on-Hot-Updates"><a href="#Series-of-Articles-on-Hot-Updates" class="headerlink" title="Series of Articles on Hot Updates"></a>Series of Articles on Hot Updates</h2><p>The series of articles I wrote on UE4 hot updates can serve as a reference for project practices:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://imzlp.com/posts/17371">UE Hot Update: Requirement Analysis and Solution Design</a></li>
<li><a target="_blank" rel="noopener" href="https://imzlp.com/posts/17590/">UE Resource Hot Update Packaging Tool HotPatcher</a></li>
<li><a target="_blank" rel="noopener" href="https://imzlp.com/posts/10938/">UE Hot Update: Automation Process Based on HotPatcher</a></li>
<li><a target="_blank" rel="noopener" href="https://imzlp.com/posts/11043/">2020 Unreal Open Day</a></li>
<li><a target="_blank" rel="noopener" href="https://imzlp.com/posts/13765/">UE Hot Update: Splitting the Base Package</a></li>
<li><a target="_blank" rel="noopener" href="https://imzlp.com/posts/3675">UE Hot Update: Asset Management and Audit Tool</a></li>
<li><a target="_blank" rel="noopener" href="https://imzlp.com/posts/5867/">UE Hot Update: Create Shader Patch</a></li>
<li><a target="_blank" rel="noopener" href="https://imzlp.com/posts/16895/">UE Hot Update: Questions &amp; Answers</a></li>
<li><a target="_blank" rel="noopener" href="https://imzlp.com/posts/25136/">UE Hot Update: Binary Patch Scheme for Resources</a></li>
<li><a target="_blank" rel="noopener" href="https://imzlp.com/posts/15810/">UE Hot Update: Shader Update Strategy</a></li>
</ul>
<h2 id="Automatic-Mounting-Directory-for-Pak"><a href="#Automatic-Mounting-Directory-for-Pak" class="headerlink" title="Automatic Mounting Directory for Pak"></a>Automatic Mounting Directory for Pak</h2><p>Pak files in the following three paths will be automatically mounted when the engine starts:</p>
<ul>
<li>Engine/Content/Paks</li>
<li>GAME_DIR/Content/Paks</li>
<li>GAME_DIR/Saved/Paks</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">Runtime\PakFile\Private\IPlatformFilePak.<span class="function">cpp</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">FPakPlatformFile::GetPakFolders</span><span class="params">(<span class="type">const</span> TCHAR* CmdLine, TArray&lt;FString&gt;&amp; OutPakFolders)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="meta">#<span class="keyword">if</span> !UE_BUILD_SHIPPING</span></span><br><span class="line">  <span class="comment">// Command line folders</span></span><br><span class="line">  FString PakDirs;</span><br><span class="line">  <span class="keyword">if</span> (FParse::<span class="built_in">Value</span>(CmdLine, <span class="built_in">TEXT</span>(<span class="string">&quot;-pakdir=&quot;</span>), PakDirs))</span><br><span class="line">  &#123;</span><br><span class="line">    TArray&lt;FString&gt; CmdLineFolders;</span><br><span class="line">    PakDirs.<span class="built_in">ParseIntoArray</span>(CmdLineFolders, <span class="built_in">TEXT</span>(<span class="string">&quot;*&quot;</span>), <span class="literal">true</span>);</span><br><span class="line">    OutPakFolders.<span class="built_in">Append</span>(CmdLineFolders);</span><br><span class="line">  &#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// @todo plugin urgent: Needs to handle plugin Pak directories, too</span></span><br><span class="line">  <span class="comment">// Hardcoded locations</span></span><br><span class="line">  OutPakFolders.<span class="built_in">Add</span>(FString::<span class="built_in">Printf</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;%sPaks/&quot;</span>), *FPaths::<span class="built_in">ProjectContentDir</span>()));</span><br><span class="line">  OutPakFolders.<span class="built_in">Add</span>(FString::<span class="built_in">Printf</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;%sPaks/&quot;</span>), *FPaths::<span class="built_in">ProjectSavedDir</span>()));</span><br><span class="line">  OutPakFolders.<span class="built_in">Add</span>(FString::<span class="built_in">Printf</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;%sPaks/&quot;</span>), *FPaths::<span class="built_in">EngineContentDir</span>()));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The default priority of the pak files in these three paths varies (unless named in the form _1_P.pak):</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Runtime\PakFile\Private\IPlatformFilePak.<span class="function">cpp</span></span><br><span class="line"><span class="function">int32 <span class="title">FPakPlatformFile::GetPakOrderFromPakFilePath</span><span class="params">(<span class="type">const</span> FString&amp; PakFilePath)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (PakFilePath.<span class="built_in">StartsWith</span>(FString::<span class="built_in">Printf</span>(<span class="built_in">TEXT</span>(<span class="string">&quot;%sPaks/%s-&quot;</span>), *FPaths::<span class="built_in">ProjectContentDir</span>(), FApp::<span class="built_in">GetProjectName</span>())))</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (PakFilePath.<span class="built_in">StartsWith</span>(FPaths::<span class="built_in">ProjectContentDir</span>()))</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">3</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (PakFilePath.<span class="built_in">StartsWith</span>(FPaths::<span class="built_in">EngineContentDir</span>()))</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (PakFilePath.<span class="built_in">StartsWith</span>(FPaths::<span class="built_in">ProjectSavedDir</span>()))</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Purpose-of-Mount-Point"><a href="#Purpose-of-Mount-Point" class="headerlink" title="Purpose of Mount Point"></a>Purpose of Mount Point</h2><p>When mounting a Pak, there is a parameter that can specify the MountPoint:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* Mounts a pak file at the specified path.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* @param InPakFilename Pak filename.</span></span><br><span class="line"><span class="comment">* @param InPath Path to mount the pak at.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">Mount</span><span class="params">(<span class="type">const</span> TCHAR* InPakFilename, uint32 PakOrder, <span class="type">const</span> TCHAR* InPath = <span class="literal">NULL</span>, <span class="type">bool</span> bLoadIndex = <span class="literal">true</span>)</span></span>;</span><br></pre></td></tr></table></figure>
<p>So, what does it do?<br>Starting from the Mount function:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (InPath != <span class="literal">NULL</span>)</span><br><span class="line">&#123;</span><br><span class="line">  Pak-&gt;<span class="built_in">SetMountPoint</span>(InPath);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>If <code>InPath</code> is passed during the call to Mount, it sets <code>InPath</code> for the Pak’s FPakFile instance using <code>SetMountPoint</code>. Actually, in FPakFile, the MountPath has a default value (read from the Pak file). The constructor of FPakFile calls <code>Initialize(Reader, bLoadIndex);</code>, and in <code>Initialize</code>, it calls <code>LoadIndex</code>, where the logic for reading the Pak’s Mount Point from the Pak is implemented:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Runtime/PakFile/Private/IPlatformFilePak.cpp</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">FPakFile::LoadIndex</span><span class="params">(FArchive* Reader)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (CachedTotalSize &lt; (Info.IndexOffset + Info.IndexSize))</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">UE_LOG</span>(LogPakFile, Fatal, <span class="built_in">TEXT</span>(<span class="string">&quot;Corrupted index offset in pak file.&quot;</span>));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> (Info.Version &gt;= FPakInfo::PakFile_Version_FrozenIndex &amp;&amp; Info.bIndexIsFrozen)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">SCOPED_BOOT_TIMING</span>(<span class="string">&quot;PakFile_LoadFrozen&quot;</span>);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// read frozen data</span></span><br><span class="line">      Reader-&gt;<span class="built_in">Seek</span>(Info.IndexOffset);</span><br><span class="line">      int32 FrozenSize = Info.IndexSize;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// read in the index, etc data in one lump</span></span><br><span class="line">      <span class="type">void</span>* DataMemory = FMemory::<span class="built_in">Malloc</span>(FrozenSize);</span><br><span class="line">      Reader-&gt;<span class="built_in">Serialize</span>(DataMemory, FrozenSize);</span><br><span class="line">      Data = <span class="built_in">TUniquePtr</span>&lt;FPakFileData&gt;((FPakFileData*)DataMemory);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// cache the number of entries</span></span><br><span class="line">      NumEntries = Data-&gt;Files.<span class="built_in">Num</span>();</span><br><span class="line">      <span class="comment">// @todo loadtime: it is nice to serialize the mountpoint right into the Data so that IndexSize is right here</span></span><br><span class="line">      <span class="comment">// but it takes this to copy it out, because it&#x27;s too painful for the string manipulation when dealing with</span></span><br><span class="line">      <span class="comment">// MemoryImageString everywhere MountPoint is used</span></span><br><span class="line">      MountPoint = Data-&gt;MountPoint;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>In simple terms, if the Mount Point is not passed during mounting, it will be read from the Pak file. If passed, it will set it to the provided value (the MountPoint in the Pak represents the common path for all files in the Pak).</p>
<p>So, what is the purpose of setting the MountPoint for the Pak?<br>The real purpose is to check whether the file to be loaded exists in the current Pak! Since the default meaning of the Pak’s Mount Point is the common path of all files within it, all we need to do is check if the file to be read starts with this path, allowing us to eliminate paths that are incorrect (if the base path is wrong, it means the file does not exist in the Pak as well).</p>
<p>The specific logic can be seen in the implementation of this function:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Runtime/PakFile/Public/IPlatformFilePak.h</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* Finds a file in the specified pak files.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* @param Paks Pak files to find the file in.</span></span><br><span class="line"><span class="comment">* @param Filename File to find in pak files.</span></span><br><span class="line"><span class="comment">* @param OutPakFile Optional pointer to a pak file where the filename was found.</span></span><br><span class="line"><span class="comment">* @return Pointer to pak entry if the file was found, NULL otherwise.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">bool</span> <span class="title">FindFileInPakFiles</span><span class="params">(TArray&lt;FPakListEntry&gt;&amp; Paks, <span class="type">const</span> TCHAR* Filename, FPakFile** OutPakFile, FPakEntry* OutEntry = <span class="literal">nullptr</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">FString <span class="title">StandardFilename</span><span class="params">(Filename)</span></span>;</span><br><span class="line">    FPaths::<span class="built_in">MakeStandardFilename</span>(StandardFilename);</span><br><span class="line"></span><br><span class="line">    int32 DeletedReadOrder = <span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (int32 PakIndex = <span class="number">0</span>; PakIndex &lt; Paks.<span class="built_in">Num</span>(); PakIndex++)</span><br><span class="line">    &#123;</span><br><span class="line">        int32 PakReadOrder = Paks[PakIndex].ReadOrder;</span><br><span class="line">        <span class="keyword">if</span> (DeletedReadOrder != <span class="number">-1</span> &amp;&amp; DeletedReadOrder &gt; PakReadOrder)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//found a delete record in a higher priority patch level, but now we&#x27;re at a lower priority set - don&#x27;t search further back or we&#x27;ll find the original, old file.</span></span><br><span class="line">            <span class="built_in">UE_LOG</span>(LogPakFile, Verbose, <span class="built_in">TEXT</span>(<span class="string">&quot;Delete Record: Accepted a delete record for %s&quot;</span>), Filename);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        FPakFile::EFindResult FindResult = Paks[PakIndex].PakFile-&gt;<span class="built_in">Find</span>(*StandardFilename, OutEntry);</span><br><span class="line">        <span class="keyword">if</span> (FindResult == FPakFile::EFindResult::Found)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (OutPakFile != <span class="literal">NULL</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                *OutPakFile = Paks[PakIndex].PakFile;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">UE_CLOG</span>(DeletedReadOrder != <span class="number">-1</span>, LogPakFile, Verbose, <span class="built_in">TEXT</span>(<span class="string">&quot;Delete Record: Ignored delete record for %s - found it in %s instead (asset was moved between chunks)&quot;</span>), Filename, *Paks[PakIndex].PakFile-&gt;<span class="built_in">GetFilename</span>());</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (FindResult == FPakFile::EFindResult::FoundDeleted)</span><br><span class="line">        &#123;</span><br><span class="line">            DeletedReadOrder = PakReadOrder;</span><br><span class="line">            <span class="built_in">UE_LOG</span>(LogPakFile, Verbose, <span class="built_in">TEXT</span>(<span class="string">&quot;Delete Record: Found a delete record for %s in %s&quot;</span>), Filename, *Paks[PakIndex].PakFile-&gt;<span class="built_in">GetFilename</span>());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">UE_CLOG</span>(DeletedReadOrder != <span class="number">-1</span>, LogPakFile, Warning, <span class="built_in">TEXT</span>(<span class="string">&quot;Delete Record: No lower priority pak files looking for %s. (maybe not downloaded?)&quot;</span>), Filename);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>When we read a file from a Pak, it calls the <code>Find</code> function across all mounted Paks, and the <code>FPakFile::Find</code> function implements the logic I just described:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Runtime/PakFile/Private/IPlatformFilePak.cpp</span></span><br><span class="line"><span class="function">FPakFile::EFindResult <span class="title">FPakFile::Find</span><span class="params">(<span class="type">const</span> FString&amp; Filename, FPakEntry* OutEntry)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">QUICK_SCOPE_CYCLE_COUNTER</span>(PakFileFind);</span><br><span class="line">  <span class="keyword">if</span> (Filename.<span class="built_in">StartsWith</span>(MountPoint))</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="function">FString <span class="title">Path</span><span class="params">(FPaths::GetPath(Filename))</span></span>;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Therefore, the role of the MountPoint is to first determine if the file’s path matches the foundational path of all files in the Pak during file lookup. If it doesn’t exist, the process will not proceed further.</p>
<h2 id="Pak-Fails-to-Mount"><a href="#Pak-Fails-to-Mount" class="headerlink" title="Pak Fails to Mount"></a>Pak Fails to Mount</h2><p>In the main package, if signature is enabled, the resulting Pak will fail to mount.<br>The same signature error occurs due to the absence of the corresponding .sig file for the pak.<br>The log looks like this:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">LogPakFile: Warning: Couldn&#x27;t find pak signature file &#x27;../../../Pak/Content/Paks/1.0.3_WindowsNoEditor_P.pak&#x27;</span><br><span class="line">LogPakFile: Warning: Unable to create pak &quot;../../../Pak/Content/Paks/1.0.3_WindowsNoEditor_P.pak&quot; handle</span><br><span class="line">LogPakFile: Warning: Failed to mount pak &quot;../../../Pak/Content/Paks/1.0.3_WindowsNoEditor_P.pak&quot;, pak is invalid</span><br></pre></td></tr></table></figure>
<p>This occurs because <code>bEnablePakSigning</code> in <code>Project Setting</code> - <code>Crypto</code> was set to true when creating the primary package, which will enforce validation on all <code>pak</code> files within the created package to ensure that <strong>only pak files packaged by oneself can be loaded</strong>.<br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/16895/project-setting-crypto.webp"></p>
<p>The related code handling is in:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Runtime/PakFile/Private/SignedArchiveReader.cpp</span></span><br><span class="line">FChunkCacheWorker::<span class="built_in">FChunkCacheWorker</span>(FArchive* InReader, <span class="type">const</span> TCHAR* Filename)</span><br><span class="line">  : <span class="built_in">Thread</span>(<span class="literal">nullptr</span>)</span><br><span class="line">  , <span class="built_in">Reader</span>(InReader)</span><br><span class="line">  , <span class="built_in">QueuedRequestsEvent</span>(<span class="literal">nullptr</span>)</span><br><span class="line">  , <span class="built_in">ChunkRequestAvailable</span>(<span class="literal">nullptr</span>)</span><br><span class="line">&#123;</span><br><span class="line">  FString SigFileFilename = FPaths::<span class="built_in">ChangeExtension</span>(Filename, <span class="built_in">TEXT</span>(<span class="string">&quot;sig&quot;</span>));</span><br><span class="line">  FArchive* SigFileReader = IFileManager::<span class="built_in">Get</span>().<span class="built_in">CreateFileReader</span>(*SigFileFilename);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (SigFileReader == <span class="literal">nullptr</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">UE_LOG</span>(LogPakFile, Fatal, <span class="built_in">TEXT</span>(<span class="string">&quot;Couldn&#x27;t find pak signature file &#x27;%s&#x27;&quot;</span>), *SigFileFilename);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  Signatures.<span class="built_in">Serialize</span>(*SigFileReader);</span><br><span class="line">  <span class="keyword">delete</span> SigFileReader;</span><br><span class="line">  Signatures.<span class="built_in">DecryptSignatureAndValidate</span>(Filename);</span><br><span class="line"></span><br><span class="line">  <span class="type">const</span> <span class="type">bool</span> bEnableMultithreading = FPlatformProcess::<span class="built_in">SupportsMultithreading</span>();</span><br><span class="line">  <span class="keyword">if</span> (bEnableMultithreading)</span><br><span class="line">  &#123;</span><br><span class="line">    QueuedRequestsEvent = FPlatformProcess::<span class="built_in">GetSynchEventFromPool</span>();</span><br><span class="line">    ChunkRequestAvailable = FPlatformProcess::<span class="built_in">GetSynchEventFromPool</span>();</span><br><span class="line">    Thread = FRunnableThread::<span class="built_in">Create</span>(<span class="keyword">this</span>, <span class="built_in">TEXT</span>(<span class="string">&quot;FChunkCacheWorker&quot;</span>), <span class="number">0</span>, TPri_BelowNormal);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Therefore, if the pak created using HotPatcher does not specify the same encryption parameters as the project, the pak placed within the package will fail to load (due to validation failure).<br>The solution is to specify the same encryption information in HotPatcher as in the project. When directly using UE to create the primary package, a <code>Crypto.json</code> file will be generated by default in the following path:</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PROJECT_DIRECTORY\Saved\Cooked\WindowsNoEditor\PROJECT_NAME\Metadata\Crypto.json</span><br></pre></td></tr></table></figure>
<p>Its content is generated based on the options in <code>Project Setting</code> - <code>Crypto</code>.<br>The method to use is:<br>Add the parameter <code>-cryptokeys=&quot;Crypto.json&quot;</code> to the <code>UnrealPak</code> parameters in HotPatcher (in UE4.23+ also add the <code>-sign</code> parameter):<br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/16895/hotpatcher-unrealpak-options-sign.webp"></p>
<p>Regenerating the Pak will create a corresponding <code>.sig</code> file named after the Pak in the Pak directory, and copying both the <code>pak</code> and <code>sig</code> files to the mounting directory will work.</p>
<p>The UnrealPak parameters can be found in my previous article: <a target="_blank" rel="noopener" href="https://imzlp.com/posts/12143/#UnrealPak%E7%9A%84%E5%8F%82%E6%95%B0">UE4 Toolchain Configuration and Development Tips # Parameters of UnrealPak</a></p>
<h2 id="Pak-master-signature-table-check-failed-for-pak"><a href="#Pak-master-signature-table-check-failed-for-pak" class="headerlink" title="Pak master signature table check failed for pak"></a>Pak master signature table check failed for pak</h2><ol>
<li>The pak generated by HotPatcher crashes when mounted, with the message <em>Pak master signature table check failed for pak</em>.</li>
</ol>
<p><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/16895/hotpatcher-qa-pak-master-signing-not-match.webp"></p>
<p>This is due to the signing encryption set in the project settings when creating the primary package, and identical encryption parameters must be added in the UnrealPak parameters of HotPatcher.</p>
<p>In <code>IPlatformFilePak.cpp</code> within <code>RegisterPakFile</code>, checks are also performed:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Runtime/PakFile/Private/</span></span><br><span class="line"><span class="function">uint16* <span class="title">RegisterPakFile</span><span class="params">(FName File, int64 PakFileSize)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  uint16* PakIndexPtr = CachedPaks.<span class="built_in">Find</span>(File);</span><br><span class="line">  <span class="keyword">if</span> (!PakIndexPtr)</span><br><span class="line">  &#123;</span><br><span class="line">    FString PakFilename = File.<span class="built_in">ToString</span>();</span><br><span class="line">    <span class="built_in">check</span>(CachedPakData.<span class="built_in">Num</span>() &lt; MAX_uint16);</span><br><span class="line">    IAsyncReadFileHandle* Handle = LowerLevel-&gt;<span class="built_in">OpenAsyncRead</span>(*PakFilename);</span><br><span class="line">    <span class="keyword">if</span> (!Handle)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    CachedPakData.<span class="built_in">Add</span>(<span class="built_in">FPakData</span>(Handle, File, PakFileSize));</span><br><span class="line">    PakIndexPtr = &amp;CachedPaks.<span class="built_in">Add</span>(File, CachedPakData.<span class="built_in">Num</span>() - <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">UE_LOG</span>(LogPakFile, Log, <span class="built_in">TEXT</span>(<span class="string">&quot;New pak file %s added to pak precacher.&quot;</span>), *PakFilename);</span><br><span class="line"></span><br><span class="line">    FPakData&amp; Pak = CachedPakData[*PakIndexPtr];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (SigningKey.<span class="built_in">IsValid</span>())</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="comment">// Load signature data</span></span><br><span class="line">      FString SignaturesFilename = FPaths::<span class="built_in">ChangeExtension</span>(*PakFilename, <span class="built_in">TEXT</span>(<span class="string">&quot;sig&quot;</span>));</span><br><span class="line">      IFileHandle* SignaturesFile = LowerLevel-&gt;<span class="built_in">OpenRead</span>(*SignaturesFilename);</span><br><span class="line">      <span class="built_in">ensure</span>(SignaturesFile);</span><br><span class="line">      FArchiveFileReaderGeneric* Reader = <span class="keyword">new</span> <span class="built_in">FArchiveFileReaderGeneric</span>(SignaturesFile, *SignaturesFilename, SignaturesFile-&gt;<span class="built_in">Size</span>());</span><br><span class="line">      Pak.Signatures.<span class="built_in">Serialize</span>(*Reader);</span><br><span class="line">      <span class="keyword">delete</span> Reader;</span><br><span class="line">      Pak.Signatures.<span class="built_in">DecryptSignatureAndValidate</span>(SigningKey, PakFilename);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Check that we have the correct match between signature and pre-cache granularity</span></span><br><span class="line">      int64 NumPakChunks = <span class="built_in">Align</span>(PakFileSize, FPakInfo::MaxChunkDataSize) / FPakInfo::MaxChunkDataSize;</span><br><span class="line">      <span class="built_in">ensure</span>(NumPakChunks == Pak.Signatures.ChunkHashes.<span class="built_in">Num</span>());</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> PakIndexPtr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="iOS-Hot-Update-metallib-Issue"><a href="#iOS-Hot-Update-metallib-Issue" class="headerlink" title="iOS Hot Update metallib Issue"></a>iOS Hot Update metallib Issue</h2><p>In 4.25, there is an issue where shader bytecode is not reloaded. The engine internally handles the loading of metallib in a separate process and cannot reuse the shader bytecode process. Consequently, for iOS packages, it is advisable to use remote packaging, which will generate <code>ushaderbytecode</code>. In 4.25 the LoadLibrary doesn’t show issues, but loading metallib does.</p>
<p>You can refer to my previous article on UE hot update regarding shaders: <a target="_blank" rel="noopener" href="https://imzlp.com/posts/5867/">UE Hot Update: Create Shader Patch</a></p>
<h2 id="UE4-25-ShaderPatch-Crash"><a href="#UE4-25-ShaderPatch-Crash" class="headerlink" title="UE4.25+ ShaderPatch Crash"></a>UE4.25+ ShaderPatch Crash</h2><p>This issue arises due to a bug in the engine 4.25+, and you can find a modification plan in this article: <a target="_blank" rel="noopener" href="https://imzlp.com/posts/5867/#4-25-ShaderPatch-Crash">UE Hot Update: Create Shader Patch#4.25+ ShaderPatch Crash</a>.</p>
<h2 id="Hot-Updating-Resources-Not-Present-in-a-Plugin"><a href="#Hot-Updating-Resources-Not-Present-in-a-Plugin" class="headerlink" title="Hot Updating Resources Not Present in a Plugin"></a>Hot Updating Resources Not Present in a Plugin</h2><p>After packaging, the engine will read the current project’s plugin names from the upluginmanifest. When loading resources from plugins, it checks for the existence of the plugin to achieve a coarse filtering effect.</p>
<p>Thus, if trying to package a plugin that doesn’t exist in the base package into the pak, you must synchronize the project’s <code>upluginmanifest</code> file during resource packaging, mounted at:</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">../../../PROJECT_NAME/Plugins/PROJECT_NAME.upluginmanifest</span><br></pre></td></tr></table></figure>
<p>For more information on <code>upluginmanifest</code>, you can refer to my previous notes: <a target="_blank" rel="noopener" href="https://imzlp.com/notes/ue/#upluginmanifest">UE4#upluginmanifest</a>.</p>
<h2 id="Hot-Update-Resources-Not-Taking-Effect"><a href="#Hot-Update-Resources-Not-Taking-Effect" class="headerlink" title="Hot Update Resources Not Taking Effect"></a>Hot Update Resources Not Taking Effect</h2><p>If the hot updated Blueprints logic remains unchanged, check whether the resources have been cooked. You can manually execute cooking on selected resources via the features provided in HotPatcher in the Content Browser. Alternatively, ensure the <code>bCookAsset</code> option is checked when packaging the patch.<br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/17590/20201031181100.webp"></p>
<h2 id="Hot-Update-Material-Loss"><a href="#Hot-Update-Material-Loss" class="headerlink" title="Hot Update Material Loss"></a>Hot Update Material Loss</h2><p>If new resources/materials have been hot updated and they have no effect, check whether shader bytecode has been packaged. Failing to package shader bytecode for newly added materials will result in the engine using the default material due to shader retrieval failures.<br><img data-src="https://img.imzlp.com/imgs/zlp/blog/notes/ue/index/UE4/pak-shadercode-error-in-ue425.webp"></p>
<p>The log error would be:<br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/5867/shader-bytecode-error.webp"></p>
<p>If you used <code>bSharedShaderLibrary</code> during packaging, you must manually reload the shader bytecode after mounting pak files that contain new shader bytecode, allowing the engine to retrieve the latest Shader when loading materials:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;ShaderCodeLibrary.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">FShaderCodeLibrary::<span class="built_in">OpenLibrary</span>(<span class="string">&quot;NewShaderLib&quot;</span>, FPaths::<span class="built_in">ProjectContentDir</span>());</span><br></pre></td></tr></table></figure>
<p>You should call this according to the actual path and naming of the ShaderLib after mounting.</p>
<p>If <code>bSharedShaderLibrary</code> was not enabled, no further action is required, as the engine will default to using the inline shader code within the resource.</p>
<h2 id="Is-Hot-Updating-AssetRegistry-Necessary"><a href="#Is-Hot-Updating-AssetRegistry-Necessary" class="headerlink" title="Is Hot Updating AssetRegistry Necessary?"></a>Is Hot Updating AssetRegistry Necessary?</h2><p>It depends on your needs. If the code at runtime references resource relationships or checks for resource existence using the AssetRegistry module, then it needs to be hot updated. However, the AssetRegistry is not essential for the engine, and if you’re sure it won’t be used at runtime, you can remove it, which will save some memory.</p>
<p>For more specific information, you can refer to my previous notes: <a target="_blank" rel="noopener" href="https://imzlp.com/notes/ue/#%E6%8E%A7%E5%88%B6AssetRegistry%E7%9A%84%E5%BA%8F%E5%88%97%E5%8C%96">UE4#Control AssetRegistry Serialization</a>.</p>
<h2 id="Android-Prompts-Not-Found-uproject"><a href="#Android-Prompts-Not-Found-uproject" class="headerlink" title="Android Prompts Not Found uproject"></a>Android Prompts Not Found uproject</h2><p>There’s a bug in UE that can be reproduced in version 4.25.1 with the following steps:</p>
<ol>
<li>Install the apk and launch the game for the first time.</li>
<li>Open UE’s sandbox data directory <code>UE4Game/PROJECTNAME</code> and create a <code>Content/Paks</code> directory in this location.</li>
<li>Restart the game.</li>
</ol>
<p><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/16895/20210121220607.webp"></p>
<p>The log also mentions <code>Project file not found: ../../../FGame/FGame.uproject</code>.</p>
<p>Pak files that automatically mount on Android can be placed in the <code>Saved/Paks</code> directory. I will analyze this issue in detail when I have time.</p>
<h2 id="Control-Resources-Not-Packed-in-Base-Package"><a href="#Control-Resources-Not-Packed-in-Base-Package" class="headerlink" title="Control Resources Not Packed in Base Package"></a>Control Resources Not Packed in Base Package</h2><p>Practices on splitting base packages can be found in my two articles:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://imzlp.com/posts/3675/">UE Hot Update: Asset Management and Audit Tool</a></li>
<li><a target="_blank" rel="noopener" href="https://imzlp.com/posts/13765/">UE Hot Update: Splitting the Base Package</a></li>
</ul>
<h2 id="Analyze-Resources-in-the-Package-of-a-Specific-Platform"><a href="#Analyze-Resources-in-the-Package-of-a-Specific-Platform" class="headerlink" title="Analyze Resources in the Package of a Specific Platform"></a>Analyze Resources in the Package of a Specific Platform</h2><p>You can use the Asset Audit tool provided by UE. Be sure to back up the DevelopmentAssetRegistry.bin file in the Cooked/PLATFORM/PROJECT_NAME/Metadata directory each time packaging.</p>
<p>Alternatively, you can use <a target="_blank" rel="noopener" href="https://github.com/jashking/UnrealPakViewer">UnrealPakViewer</a> to directly load Pak files.</p>
<p>You can refer to the asset audit section in this article: <a target="_blank" rel="noopener" href="https://imzlp.com/posts/3675/#%E8%B5%84%E4%BA%A7%E5%AE%A1%E8%AE%A1">UE Hot Update: Asset Management and Audit Tool#Asset Audit</a>.</p>
<h2 id="UMG-Child-Widgets-Hot-Update-Not-Effective"><a href="#UMG-Child-Widgets-Hot-Update-Not-Effective" class="headerlink" title="UMG Child Widgets Hot Update Not Effective"></a>UMG Child Widgets Hot Update Not Effective</h2><p>If UMG is referenced in an instanced form, changes to child UMG must recursively include all UMG resources referenced in the form of child controls. I previously recorded this issue in my notes: <a target="_blank" rel="noopener" href="https://imzlp.com/notes/ue/#UMG%E7%9A%84%E5%AD%90%E6%8E%A7%E4%BB%B6%E5%BC%95%E7%94%A8%E7%83%AD%E6%9B%B4%E9%97%AE%E9%A2%98">UE4#UMG Child Widget Reference Hot Update Issue</a>.</p>
<p><img data-src="https://img.imzlp.com/imgs/zlp/picgo/2024/04/18/114744.png"></p>
<p>Solution: HotPatcher includes an option to recursively analyze the UMG parent widget (bRecursiveWidgetTree), which can be enabled.</p>
<p><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/16895/20210315103155.webp"></p>
<p>A detailed analysis of this issue was presented in my 2020 UOD speech, and you can watch the video and view the PPT here:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://imzlp.com/posts/11043/">2020 Unreal Open Day</a></li>
</ul>
<blockquote>
<p>Note: Instanced UMG only affects the serialization of controls and does not relate to logical changes within child widgets.</p>
</blockquote>
<p>In the following scenario, only packaging a child widget UMG will be effective:</p>
<ol>
<li>UMG_Child has a Button associated with a Button event that outputs TEST01.</li>
<li>UMG_Main embeds UMG_Child.</li>
<li>A version is built.</li>
<li>Modify the output of the Button event in UMG_Child to TEST02.</li>
<li>Only package <code>UMG_Child</code>.</li>
<li>Create UMG_Main and click the Button in its UMG_Child to correctly output TEST02.</li>
</ol>
<h2 id="Can-Pak-be-Used-Across-Engine-Versions"><a href="#Can-Pak-be-Used-Across-Engine-Versions" class="headerlink" title="Can Pak be Used Across Engine Versions?"></a>Can Pak be Used Across Engine Versions?</h2><p>No, the engine versions for packaging and usage must be consistent.</p>
<h2 id="Pak-Packaged-from-Project-A-for-Use-in-Project-B"><a href="#Pak-Packaged-from-Project-A-for-Use-in-Project-B" class="headerlink" title="Pak Packaged from Project A for Use in Project B"></a>Pak Packaged from Project A for Use in Project B</h2><p>HotPatcher has implemented a functionality to replace the pak command, which can be specified with the following parameters:<br><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/17590/HotPatcher/hotpatcher-pak-options-replace-pak-command-texts.webp"></p>
<p>Note: Both From and To must include a <code>../../../</code> prefix; otherwise, the absolute path of the file will be replaced.</p>
<h2 id="Plugin-HotPatcher-Failed"><a href="#Plugin-HotPatcher-Failed" class="headerlink" title="Plugin HotPatcher Failed"></a>Plugin HotPatcher Failed</h2><p>After packaging, the following prompt appears:</p>
<p><img data-src="https://img.imzlp.com/imgs/zlp/blog/posts/16895/20210419171558.webp"></p>
<p>This may be caused by packaging a purely Blueprint project. Create a C++ class in the project, transforming it into a C++ project and repackage it.</p>
<h2 id="Packaging-Original-uasset-Resources"><a href="#Packaging-Original-uasset-Resources" class="headerlink" title="Packaging Original uasset Resources"></a>Packaging Original uasset Resources</h2><p>Currently, there is no direct feature in the plugin to select original uasset resources for packaging, but you can implement it using a clever workaround.<br>You can set <code>ReplacePakCommandTexts</code> to replace the Cooked directory with the project’s <code>Content directory</code>:<br><img data-src="https://img.imzlp.com/imgs/zlp/picgo/2021/20210428141549.webp"></p>
<p>Although the <code>*pakcommand.txt</code> will still contain records of <code>uexp</code> files, they won’t be available in the project’s <code>Content</code>, meaning they won’t be packed into the pak, skipping nonexistent files and producing the following log output:</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LogPakFile: Warning: Missing file &quot;D:/Client/Content/Assets/Scene/Map/LookDev/DemoAssets/Mesh/FFXV/000.uexp&quot; will not be added to PAK file.</span><br></pre></td></tr></table></figure>
<p>This is a clever approach, but it works.</p>
<h2 id="Export-Cross-Machine-Universal-Configuration-File"><a href="#Export-Cross-Machine-Universal-Configuration-File" class="headerlink" title="Export Cross-Machine Universal Configuration File"></a>Export Cross-Machine Universal Configuration File</h2><p>Q: Some configurations exported from HotPatcher depend on absolute file paths, such as BaseVersion, Non-Asset files, SavePath, etc. These absolute paths may not be consistent across different machines. Can configurations be based on relative paths?</p>
<p>A: Yes. All configurable items in HotPatcher can replace absolute paths with marked symbols, and the following symbols can be used to replace absolute paths.</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[ENGINEDIR]</span><br><span class="line">[ENGINE_CONTENT_DIR]</span><br><span class="line">[PROJECTDIR]</span><br><span class="line">[PROJECT_CONTENT_DIR]</span><br><span class="line">[PROJECT_SAVED_DIR]</span><br><span class="line">[PROJECT_CONFIG_DIR]</span><br></pre></td></tr></table></figure>
<p>During packaging, these will automatically be replaced with the absolute path of the current machine, making the configuration file fully universal.</p>
<h2 id="Analysis-of-Dependency-Time-Consumption"><a href="#Analysis-of-Dependency-Time-Consumption" class="headerlink" title="Analysis of Dependency Time Consumption"></a>Analysis of Dependency Time Consumption</h2><p>When a project has a considerable amount of resources, the dependency analysis provided by the plugin can consume substantial time. Its primary purpose is to analyze dependent resources to prevent dependency on resources that haven’t been packaged.</p>
<p>If dependencies on engine or plugin resources exist, not conducting dependency analysis will result in mismanagement (or manually specifying), and if you wish to exclude unreferenced resources, it cannot be accomplished without analysis. If not needed, you can disable it by setting <code>bAnalysisFilterDependencies</code>. </p>
<p>This will limit the analysis to only the resources specified in the configuration and those individually designated, comparing them with the base version. This can significantly reduce the time consumed in dependency analysis (if your resources are numerously substantial and sure all resource dependencies reside in /Game, you can skip enabling dependency analysis).</p>
<h2 id="Memory-Mapped-File-Has-the-Wrong-Alignment"><a href="#Memory-Mapped-File-Has-the-Wrong-Alignment" class="headerlink" title="Memory Mapped File Has the Wrong Alignment"></a>Memory Mapped File Has the Wrong Alignment</h2><blockquote>
<p>Note: The latest plugin has already been adapted to be supported, and no manual specifications are required.</p>
</blockquote>
<p>The following crash occurs in the iOS package:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">IsAligned(MappedRegion-&gt;GetMappedPtr(), FPlatformProperties::GetMemoryMappingAlignment()), TEXT(&quot;Memory mapped file has the wrong alignment!&quot;)</span><br></pre></td></tr></table></figure>
<p>This is caused because the <code>alignformemorymapping</code> value was not set when packaging for iOS, which defaults to 0. However, for iOS, it should be set to <code>16384</code>:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Engine/Source/Runtime/Core/Public/IOS/IOSPlatformProperties.<span class="function">h</span></span><br><span class="line"><span class="function"><span class="type">static</span> FORCEINLINE int64 <span class="title">GetMemoryMappingAlignment</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">16384</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Specify this parameter during pak packaging: <code>-alignformemorymapping=16384</code>.</p>
<p>During default UE packaging, this parameter has also been added:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Source\Programs\AutomationTool\Scripts\CopyBuildToStagingDirectory.Automation.<span class="function">cs</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">CreatePaks</span>(<span class="params">ProjectParams Params, DeploymentContext SC, List&lt;CreatePakParams&gt; PakParamsList, EncryptionAndSigning.CryptoSettings CryptoSettings, FileReference CryptoKeysCacheFilename</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="built_in">string</span> BulkOption = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    ConfigHierarchy PlatformEngineConfig = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">if</span> (Params.EngineConfigs.TryGetValue(SC.StageTargetPlatform.PlatformType, <span class="keyword">out</span> PlatformEngineConfig))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">bool</span> bMasterEnable = <span class="literal">false</span>;</span><br><span class="line">      PlatformEngineConfig.GetBool(<span class="string">&quot;MemoryMappedFiles&quot;</span>, <span class="string">&quot;MasterEnable&quot;</span>, <span class="keyword">out</span> bMasterEnable);</span><br><span class="line">        <span class="keyword">if</span> (bMasterEnable)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">int</span> Value = <span class="number">0</span>;</span><br><span class="line">        PlatformEngineConfig.GetInt32(<span class="string">&quot;MemoryMappedFiles&quot;</span>, <span class="string">&quot;Alignment&quot;</span>, <span class="keyword">out</span> Value);</span><br><span class="line">            <span class="keyword">if</span> (Value &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                BulkOption = String.Format(<span class="string">&quot; -AlignForMemoryMapping=&#123;0&#125;&quot;</span>, Value);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>It reads from the <code>MemoryMappedFiles</code> Section of <code>Config/PLATFORM/*Engine.ini</code>, where the <code>Alignment</code> value is specified, such as for iOS:</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Config/IOS/IOSEngine.ini</span><br><span class="line"><span class="section">[MemoryMappedFiles]</span></span><br><span class="line"><span class="attr">MasterEnable</span>=<span class="literal">true</span></span><br><span class="line"><span class="attr">Alignment</span>=<span class="number">16384</span></span><br></pre></td></tr></table></figure>
<p>This value corresponds to the one defined in the code and is the only platform for iOS that specifies this item: <a target="_blank" rel="noopener" href="https://github.com/EpicGames/UnrealEngine/search?q=MemoryMappedFiles&unscoped_q=MemoryMappedFiles">MemoryMappedFiles</a>.</p>
<h2 id="Missing-Some-Plugin-Resources-in-Release"><a href="#Missing-Some-Plugin-Resources-in-Release" class="headerlink" title="Missing Some Plugin Resources in Release"></a>Missing Some Plugin Resources in Release</h2><p>Please ensure that the plugin path name matches exactly with the plugin name. For example:</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Plugins\HDiffPatchUE4\HDiffPatch.uplugin</span><br></pre></td></tr></table></figure>
<p>This situation is not allowed; the path must match the plugin name exactly.</p>
<h2 id="Resource-Packaging-and-Real-Machine-Load-Process-in-the-Editor"><a href="#Resource-Packaging-and-Real-Machine-Load-Process-in-the-Editor" class="headerlink" title="Resource Packaging and Real Machine Load Process in the Editor"></a>Resource Packaging and Real Machine Load Process in the Editor</h2><p>As in-game resources increase in number, the package size grows, but mobile package sizes have limits and cannot indefinitely include all resources in the base package. The Android limit is 2G (you can enable <code>Allow Large Obb files</code> to support 4G), and the iOS limit for submission to the App Store is usually 4G, which typically maintains uniform resource allocation across iOS/Android basic packages, with the remaining resources updated to devices through hot updates or dynamic downloads.</p>
<p>So, effectively in the <strong>development phase</strong>, resources packed in the basic package are merely a part of the project. Often, satisfying the verification needs of planners, artists, and testers can prove difficult.</p>
<ol>
<li>New maps and resources need to be viewed on actual devices</li>
<li>Issues with resources in the package; submission waits for lengthy full package build periods</li>
<li>Base package resource volumes exceed limits, which may prevent additional resource additions</li>
</ol>
<p>Based on this necessity, a <strong>basic package</strong> + <strong>patch</strong> form can be utilized during the development phase.</p>
<h3 id="Resource-Packaging"><a href="#Resource-Packaging" class="headerlink" title="Resource Packaging"></a>Resource Packaging</h3><p>In our current project, within the editor, you can right-click directly on the resource or directory and select <strong>Cook And Pak Actions</strong>, choose the corresponding platform, and also select <strong>AnalysisDependencies</strong> (Analyze Dependencies).</p>
<p>Different platforms require different choices (select based on your project’s needs):</p>
<ul>
<li>Android: Android_ASTC</li>
<li>iOS: iOS</li>
<li>PCVersion: WindowsNoEditor</li>
</ul>
<p><img data-src="https://img.imzlp.com/imgs/zlp/picgo/2022/20221018124619.webp"></p>
<p>After execution, a prompt will appear at the bottom right:</p>
<p><img data-src="https://img.imzlp.com/imgs/zlp/picgo/2022/20221018125021.webp"></p>
<p>You need to wait until the execution is complete. This process will not freeze the editor; other editing operations can continue.</p>
<p><img data-src="https://img.imzlp.com/imgs/zlp/picgo/2022/20221018130012.webp"></p>
<blockquote>
<p>The duration of execution depends on the number of referenced resources and whether the selected resources have been packaged previously (Data Driven Content).</p>
</blockquote>
<p>After execution, a corresponding <strong>.pak</strong> file will be created in the project’s <code>Saved/HotPatcher/Paks/&#123;EXECUTE_TIME&#125;/Android_ASTC</code> directory. This <strong>pak</strong> file is the patch for the packaged resources, with the file name including the platform name. The <strong>pak</strong> files for different platforms <strong>cannot be mixed</strong>.</p>
<p><img data-src="https://img.imzlp.com/imgs/zlp/picgo/2022/20221018130123.webp"></p>
<h3 id="Placement-in-Real-Machines"><a href="#Placement-in-Real-Machines" class="headerlink" title="Placement in Real Machines"></a>Placement in Real Machines</h3><h4 id="PCVersion"><a href="#PCVersion" class="headerlink" title="PCVersion"></a>PCVersion</h4><p>For PCVersion, place the pak file in the following directory:</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">WindowsNoEditor\PROJECT_NAME\Content\Paks</span><br></pre></td></tr></table></figure>
<p>If the Paks directory doesn’t exist, you may manually create it.</p>
<h4 id="Android"><a href="#Android" class="headerlink" title="Android"></a>Android</h4><p>On Android, the <strong>pak</strong> file needs to be placed in the following directory:</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UE4Game/PROJECT_NAME/PROJECT_NAME/Saved/Paks</span><br></pre></td></tr></table></figure>
<p>If the data directory has been modified to the sandbox path, it will be:</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Android/data/com.xxxx.yyyy/files/UE4Game/PROJECT_NAME/PROJECT_NAME/Saved/Paks</span><br></pre></td></tr></table></figure>
<p>If the Paks directory doesn’t exist, you may manually create one.</p>
<h4 id="iOS"><a href="#iOS" class="headerlink" title="iOS"></a>iOS</h4><p>The iOS process is more intricate; you need to use tools like <strong>iCareFone</strong> or <strong>iMazing</strong> to transfer the files. Place it in <strong>Documents</strong> - <strong>PROJECT_NAME</strong> - <strong>Saved</strong> - <strong>Paks</strong>. If the Paks directory doesn’t exist, you may manually create it.</p>
<p><img data-src="https://img.imzlp.com/imgs/zlp/picgo/2022/20221018125828.webp"></p>
<h3 id="Check-Mounting-Status"><a href="#Check-Mounting-Status" class="headerlink" title="Check Mounting Status"></a>Check Mounting Status</h3><p>After placing the <strong>pak</strong> file in the above directory, you can start the game.</p>
<p>To confirm whether the <strong>pak</strong> file is effective, you can check the Log:</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">LogPakFile: Display: Found Pak file ../../../PROJECT_NAME/Saved/Paks/2022.10.18-13.02.53_IOS_001_P.pak attempting to mount.</span><br><span class="line">LogPakFile: Display: Mounting pak file ../../../PROJECT_NAME/Saved/Paks/2022.10.18-13.02.53_IOS_001_P.pak.</span><br></pre></td></tr></table></figure>
<p>If you see such Log, it means the resource package has been successfully read by the engine and can be used directly, <strong>just like it was included in the base package</strong>.### Notes</p>
<blockquote>
<p>The priority of manually packing the <strong>Pak</strong> is higher than that of the resources in the base package, which means if a resource exists in both the <strong>patch package</strong> and the <strong>base package</strong>, it will <strong>replace</strong> the one in the base package, similar to hot update logic.</p>
</blockquote>
<ol>
<li>Different platform <strong>pak</strong> files cannot be mixed!</li>
<li>After testing, you need to delete the pak files from the device; otherwise, newly created packages may have resource display errors.</li>
</ol>
<h2 id="Troubleshooting-UE5"><a href="#Troubleshooting-UE5" class="headerlink" title="Troubleshooting UE5+"></a>Troubleshooting UE5+</h2><blockquote>
<p>Note: Starting from v82.0, it is compatible with UE5.2 and 5.3.</p>
</blockquote>
<p>If you find that the packaged Pak has issues in UE5:</p>
<ol>
<li>Pak cannot mount: Check if the project has IoStore enabled. After disabling it in project settings, repackage the base package.</li>
</ol>
<script src="https://gist.github.com/imzlp/5d117e9c5e1fcc46fd778fb908402593.js"></script>

    </div>

    
    
        
        
          
            <blockquote class="blockquote-center">
              
                本篇文章的内容会持续更新。
              
            <br/>
            
                <div class="qr-code" onclick="return false">
                    <script src="/js/qrcode.min.js"></script>
                    <div id="qrcode">
                      
                        <img src="https://imzlp.com/images/wechat-qrcode.webp">
                      
                    <p>Scan the QR code on WeChat and follow me.</p>
                    </div>
                </div>
            
            </blockquote>
          
        

        
          <div class="postCopyright" style="clear:both;">
             <span>Title:</span><a href="/posts/16895/" target="_blank">UE Hot update: Questions & Answers</a><br/>
             <span>Author:</span><a href="/about" target="_blank" title="查看 LIPENGZHA 的资料">LIPENGZHA</a><br/>
             <span>Publish Date:</span>2021/03/12 10:45<br/>
             
             <span>Word Count:</span><span class="page-count">16k Words</span><br/>
             
             <span>Link:</span><a href="/posts/16895/" target="_blank" title="UE Hot update: Questions & Answers">https://en.imzlp.com/posts/16895/</a>
             <span class="copy-path" data-clipboard-text="Link: https://en.imzlp.com/posts/16895/ Author: LIPENGZHA" title="点击复制文章链接"><i class="fa fa-clipboard"></i></span>
             <script src="/js/jquery.min.js"></script>
             <script src="/js/clipboard.min.js"></script>
             <script> var clipboard = new Clipboard('.copy-path'); </script>
             <br/>
             
             <span>License:</span><i class="fab fa-creative-commons"></i> <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" title="Attribution-NonCommercial-ShareAlike 4.0 International">CC BY-NC-SA 4.0</a><br/>
             
             <span>Reprinting of the full article is prohibited.</span>
          </div>
        
    

        
  <div class="reward-container">
    <div>Your donation will encourage me to keep creating!</div>
    <button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
      Donate
    </button>
    <div id="qr" style="display: none;">
        
        <div style="display: inline-block;">
          <img src="/images/reward/wechatpay.webp" alt="LIPENGZHA WeChat Pay">
          <p>WeChat Pay</p>
        </div>

    </div>
  </div>



      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/UnrealEngine/" rel="tag"># UnrealEngine</a>
              <a href="/tags/%E7%83%AD%E6%9B%B4%E6%96%B0/" rel="tag"># 热更新</a>
              <a href="/tags/HotPatcher/" rel="tag"># HotPatcher</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/posts/19135/" rel="prev" title="UE Performance Analysis: Memory Optimization">
      <i class="fa fa-chevron-left"></i> UE Performance Analysis: Memory Optimization
    </a></div>
      <div class="post-nav-item">
    <a href="/posts/5867/" rel="next" title="UE Hot Update: Create Shader Patch">
      UE Hot Update: Create Shader Patch <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
      <div class="tabs tabs-comment">
        <ul class="nav-tabs">
            <li class="tab"><a href="#comment-utteranc">utteranc</a></li>
            <li class="tab"><a href="#comment-valine">valine</a></li>
        </ul>
        <div class="tab-content">
            <div class="tab-pane utteranc" id="comment-utteranc">
              
  
  <div class="comments">
  <script src="https://utteranc.es/client.js" repo="hxhb/blog-comments" issue-term="pathname" theme="github-light" crossorigin="anonymous" async></script>
  </div>
  
  
            </div>
            <div class="tab-pane valine" id="comment-valine">
              <div class="comments" id="valine-comments"></div>
            </div>
        </div>
      </div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Questions-Related-to-HotPatcher"><span class="nav-number">1.</span> <span class="nav-text">Questions Related to HotPatcher</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Series-of-Articles-on-Hot-Updates"><span class="nav-number">2.</span> <span class="nav-text">Series of Articles on Hot Updates</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Automatic-Mounting-Directory-for-Pak"><span class="nav-number">3.</span> <span class="nav-text">Automatic Mounting Directory for Pak</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Purpose-of-Mount-Point"><span class="nav-number">4.</span> <span class="nav-text">Purpose of Mount Point</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Pak-Fails-to-Mount"><span class="nav-number">5.</span> <span class="nav-text">Pak Fails to Mount</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Pak-master-signature-table-check-failed-for-pak"><span class="nav-number">6.</span> <span class="nav-text">Pak master signature table check failed for pak</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#iOS-Hot-Update-metallib-Issue"><span class="nav-number">7.</span> <span class="nav-text">iOS Hot Update metallib Issue</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#UE4-25-ShaderPatch-Crash"><span class="nav-number">8.</span> <span class="nav-text">UE4.25+ ShaderPatch Crash</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Hot-Updating-Resources-Not-Present-in-a-Plugin"><span class="nav-number">9.</span> <span class="nav-text">Hot Updating Resources Not Present in a Plugin</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Hot-Update-Resources-Not-Taking-Effect"><span class="nav-number">10.</span> <span class="nav-text">Hot Update Resources Not Taking Effect</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Hot-Update-Material-Loss"><span class="nav-number">11.</span> <span class="nav-text">Hot Update Material Loss</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Is-Hot-Updating-AssetRegistry-Necessary"><span class="nav-number">12.</span> <span class="nav-text">Is Hot Updating AssetRegistry Necessary?</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Android-Prompts-Not-Found-uproject"><span class="nav-number">13.</span> <span class="nav-text">Android Prompts Not Found uproject</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Control-Resources-Not-Packed-in-Base-Package"><span class="nav-number">14.</span> <span class="nav-text">Control Resources Not Packed in Base Package</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Analyze-Resources-in-the-Package-of-a-Specific-Platform"><span class="nav-number">15.</span> <span class="nav-text">Analyze Resources in the Package of a Specific Platform</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#UMG-Child-Widgets-Hot-Update-Not-Effective"><span class="nav-number">16.</span> <span class="nav-text">UMG Child Widgets Hot Update Not Effective</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Can-Pak-be-Used-Across-Engine-Versions"><span class="nav-number">17.</span> <span class="nav-text">Can Pak be Used Across Engine Versions?</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Pak-Packaged-from-Project-A-for-Use-in-Project-B"><span class="nav-number">18.</span> <span class="nav-text">Pak Packaged from Project A for Use in Project B</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Plugin-HotPatcher-Failed"><span class="nav-number">19.</span> <span class="nav-text">Plugin HotPatcher Failed</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Packaging-Original-uasset-Resources"><span class="nav-number">20.</span> <span class="nav-text">Packaging Original uasset Resources</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Export-Cross-Machine-Universal-Configuration-File"><span class="nav-number">21.</span> <span class="nav-text">Export Cross-Machine Universal Configuration File</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Analysis-of-Dependency-Time-Consumption"><span class="nav-number">22.</span> <span class="nav-text">Analysis of Dependency Time Consumption</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Memory-Mapped-File-Has-the-Wrong-Alignment"><span class="nav-number">23.</span> <span class="nav-text">Memory Mapped File Has the Wrong Alignment</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Missing-Some-Plugin-Resources-in-Release"><span class="nav-number">24.</span> <span class="nav-text">Missing Some Plugin Resources in Release</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Resource-Packaging-and-Real-Machine-Load-Process-in-the-Editor"><span class="nav-number">25.</span> <span class="nav-text">Resource Packaging and Real Machine Load Process in the Editor</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Resource-Packaging"><span class="nav-number">25.1.</span> <span class="nav-text">Resource Packaging</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Placement-in-Real-Machines"><span class="nav-number">25.2.</span> <span class="nav-text">Placement in Real Machines</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#PCVersion"><span class="nav-number">25.2.1.</span> <span class="nav-text">PCVersion</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Android"><span class="nav-number">25.2.2.</span> <span class="nav-text">Android</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#iOS"><span class="nav-number">25.2.3.</span> <span class="nav-text">iOS</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Check-Mounting-Status"><span class="nav-number">25.3.</span> <span class="nav-text">Check Mounting Status</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Troubleshooting-UE5"><span class="nav-number">26.</span> <span class="nav-text">Troubleshooting UE5+</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person" oncontextmenu="return false" οndragstart="return false">
    <img class="site-author-image" itemprop="image" alt="LIPENGZHA"
      src="https://img.imzlp.com/imgs/zlp/picgo/2023/202304152112902.webp">
  <p class="site-author-name" itemprop="name">LIPENGZHA</p>
  <div class="site-description" itemprop="description">"I think, therefore I am"</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
             
          <span class="site-state-item-count">190</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">95</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">190</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/hxhb" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;hxhb" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://linkedin.com/in/lipengzha" title="Linkedin → https:&#x2F;&#x2F;linkedin.com&#x2F;in&#x2F;lipengzha" rel="noopener" target="_blank"><i class="fab fa-linkedin fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.zhihu.com/people/imzlp" title="知乎 → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;imzlp" rel="noopener" target="_blank"><i class="fa fa-custom zhihu fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="/images/wechat-qrcode-offical.webp" title="微信公众号 → &#x2F;images&#x2F;wechat-qrcode-offical.webp"><i class="fab fa-weixin fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:imzlp@foxmail.com" title="E-Mail → mailto:imzlp@foxmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="/atom.xml" title="RSS → &#x2F;atom.xml"><i class="fa fa-rss fa-fw"></i></a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://consolehelp.imzlp.com/" title="https:&#x2F;&#x2F;consolehelp.imzlp.com&#x2F;" rel="noopener" target="_blank">UE Console Help</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://imzlp.com/opensource/" title="https:&#x2F;&#x2F;imzlp.com&#x2F;opensource&#x2F;" rel="noopener" target="_blank">Open Source Projects</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://imzlp.com/posts/11515/" title="https:&#x2F;&#x2F;imzlp.com&#x2F;posts&#x2F;11515&#x2F;" rel="noopener" target="_blank">UE C++ API Dash Documents</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://ue5wiki.com/" title="https:&#x2F;&#x2F;ue5wiki.com&#x2F;" rel="noopener" target="_blank">Unreal Engine Wiki</a>
        </li>
    </ul>
  </div>

      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2014 – 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">LIPENGZHA</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="Symbols count total">1.5m</span>
</div>
  <div class="powered-by-other">
    
	    <center>Github Pages | Actions | NeXT | Cloudflare | Hexo Deploy</center>
      
  </div>

<script>
function checkWebp(callback) {
    var img = new Image();
    img.onload = function () { callback((img.width > 0) && (img.height > 0)); };
    img.onerror = function () { callback(false); };
    img.src = 'data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA';
}
function showImage(useWebp) {
    var imgs = [].slice.call(document.querySelectorAll('img'));
    imgs.forEach(function (e) {
        if (!useWebp) {
            var src = e.getAttribute('data-src')
            src = src.replace(/\.webp$/, '.png');
            e.setAttribute('data-src', src);
        }
    });
}
checkWebp(showImage);
</script>

        








      </div>
    </footer>
  </div>

  
  <script src="//lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/animejs/3.2.1/anime.min.js"></script>
  <script src="//lf9-cdn-tos.bytecdntp.com/cdn/expire-1-M/jquery/3.5.1/jquery.min.js"></script>
  <script src="//lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/fancybox/3.5.7/jquery.fancybox.min.js"></script>
  <script src="//lf9-cdn-tos.bytecdntp.com/cdn/expire-1-M/lozad.js/1.16.0/lozad.min.js"></script>
  <script src="//lf9-cdn-tos.bytecdntp.com/cdn/expire-1-M/pangu/4.0.7/pangu.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>



<script src="/js/code-unfold.js"></script>

  
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>




  
<script src="/js/local-search.js"></script>









<script>
document.querySelectorAll('.pdfobject-container').forEach(element => {
  let url = element.dataset.target;
  let pdfOpenParams = {
    navpanes : 0,
    toolbar  : 0,
    statusbar: 0,
    pagemode : 'thumbs',
    view     : 'FitH'
  };
  let pdfOpenFragment = '#' + Object.entries(pdfOpenParams).map(([key, value]) => `${key}=${encodeURIComponent(value)}`).join('&');
  let fullURL = `/lib/pdf/web/viewer.html?file=${encodeURIComponent(url)}${pdfOpenFragment}`;

  if (NexT.utils.supportsPDFs()) {
    element.innerHTML = `<embed class="pdfobject" src="${url + pdfOpenFragment}" type="application/pdf" style="height: ${element.dataset.height};">`;
  } else {
    element.innerHTML = `<iframe src="${fullURL}" style="height: ${element.dataset.height};" frameborder="0"></iframe>`;
  }
});
</script>


<script>
if (document.querySelectorAll('pre.mermaid').length) {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js', () => {
    mermaid.initialize({
      theme    : 'forest',
      logLevel : 3,
      flowchart: { curve     : 'linear' },
      gantt    : { axisFormat: '%m/%d/%Y' },
      sequence : { actorMargin: 50 }
    });
  }, window.mermaid);
}
</script>


  

  

  
  <script src="//img.imzlp.com/imgs/zlp/picgo/2021/quicklink.umd.js"></script>
  <script>
      window.addEventListener('load', () => {
      quicklink({
        timeout : 3000,
        priority: true,
        ignores : [uri => uri.includes('#'),uri => uri === 'https://en.imzlp.com/posts/16895/',]
      });
      });
  </script>


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//lf26-cdn-tos.bytecdntp.com/cdn/expire-1-M/valine/1.4.14/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    var requiredFields = 'nick';
    requiredFields = requiredFields.split(',');
    
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'oCE6RMVkVoi5MgUhvFsn1EvV-gzGzoHsz',
      appKey     : 'K9SOaNYJ8PV6xaoFggWG5xvv',
      placeholder: "Leave something behind~",
      avatar     : 'robohash',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : true,
      lang       : 'en' || 'zh-cn',
      path       : location.pathname,
      recordIP   : true,
      serverURLs : '',
      requiredFields: requiredFields
    });
  }, window.Valine);
});
</script>

</body>
</html>
